<!DOCTYPE html>
<html class="remark-container"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><style type="text/css" title="remark">html.remark-container,body.remark-container{height:100%;width:100%;-webkit-print-color-adjust:exact}.remark-container{background:#d7d8d2;margin:0;overflow:hidden}.remark-container:focus{outline-style:solid;outline-width:1px}.remark-container:-webkit-full-screen{width:100%;height:100%}body:-webkit-full-screen{background:#000000}body:-moz-full-screen{background:#000000}body:fullscreen{background:#000000}.remark-slides-area{position:relative;height:100%;width:100%}.remark-slide-container{display:none;position:absolute;height:100%;width:100%;page-break-after:always}.remark-slide-scaler{background-color:transparent;overflow:hidden;position:absolute;-webkit-transform-origin:top left;-moz-transform-origin:top left;transform-origin:top-left;-moz-box-shadow:0 0 30px #888;-webkit-box-shadow:0 0 30px #888;box-shadow:0 0 30px #888}.remark-slide{height:100%;width:100%;display:table;table-layout:fixed}.remark-slide>.left{text-align:left}.remark-slide>.center{text-align:center}.remark-slide>.right{text-align:right}.remark-slide>.top{vertical-align:top}.remark-slide>.middle{vertical-align:middle}.remark-slide>.bottom{vertical-align:bottom}.remark-slide-content{background-color:#fff;background-position:center;background-repeat:no-repeat;display:table-cell;font-size:20px;padding:1em 4em 1em 4em}.remark-slide-content h1{font-size:55px}.remark-slide-content h2{font-size:45px}.remark-slide-content h3{font-size:35px}.remark-slide-content .left{display:block;text-align:left}.remark-slide-content .center{display:block;text-align:center}.remark-slide-content .right{display:block;text-align:right}.remark-slide-number{bottom:12px;opacity:.5;position:absolute;right:20px}.remark-slide-notes{border-top:3px solid black;position:absolute;display:none}.remark-code{font-size:18px}.remark-code-line{min-height:1em}.remark-code-line-highlighted{background-color:rgba(255,255,0,0.5)}.remark-code-span-highlighted{background-color:rgba(255,255,0,0.5);padding:1px 2px 2px 2px}.remark-visible{display:block;z-index:2}.remark-fading{display:block;z-index:1}.remark-fading .remark-slide-scaler{-moz-box-shadow:none;-webkit-box-shadow:none;box-shadow:none}.remark-backdrop{position:absolute;top:0;bottom:0;left:0;right:0;display:none;background:#000;z-index:2}.remark-pause{bottom:0;top:0;right:0;left:0;display:none;position:absolute;z-index:1000}.remark-pause .remark-pause-lozenge{margin-top:30%;text-align:center}.remark-pause .remark-pause-lozenge span{color:white;background:black;border:2px solid black;border-radius:20px;padding:20px 30px;font-family:Helvetica,arial,freesans,clean,sans-serif;font-size:42pt;font-weight:bold}.remark-container.remark-presenter-mode.remark-pause-mode .remark-pause{display:block}.remark-container.remark-presenter-mode.remark-pause-mode .remark-backdrop{display:block;opacity:.5}.remark-help{bottom:0;top:0;right:0;left:0;display:none;position:absolute;z-index:1000;-webkit-transform-origin:top left;-moz-transform-origin:top left;transform-origin:top-left}.remark-help .remark-help-content{color:white;font-family:Helvetica,arial,freesans,clean,sans-serif;font-size:12pt;position:absolute;top:5%;bottom:10%;height:10%;left:5%;width:90%}.remark-help .remark-help-content h1{font-size:36px}.remark-help .remark-help-content td{color:white;font-size:12pt;padding:10px}.remark-help .remark-help-content td:first-child{padding-left:0}.remark-help .remark-help-content .key{background:white;color:black;min-width:1em;display:inline-block;padding:3px 6px;text-align:center;border-radius:4px;font-size:14px}.remark-help .dismiss{top:85%}.remark-container.remark-help-mode .remark-help{display:block}.remark-container.remark-help-mode .remark-backdrop{display:block;opacity:.95}.remark-preview-area{bottom:2%;left:2%;display:none;opacity:.5;position:absolute;height:47.25%;width:48%}.remark-preview-area .remark-slide-container{display:block}.remark-notes-area{background:#fff;bottom:0;color:black;display:none;left:52%;overflow:hidden;position:absolute;right:0;top:0}.remark-notes-area .remark-top-area{height:50px;left:20px;position:absolute;right:10px;top:10px}.remark-notes-area .remark-bottom-area{position:absolute;top:75px;bottom:10px;left:20px;right:10px}.remark-notes-area .remark-bottom-area .remark-toggle{display:block;text-decoration:none;font-family:Helvetica,arial,freesans,clean,sans-serif;height:21px;font-size:.75em;text-transform:uppercase;color:#ccc}.remark-notes-area .remark-bottom-area .remark-notes-current-area{height:70%;position:relative}.remark-notes-area .remark-bottom-area .remark-notes-current-area .remark-notes{clear:both;border-top:1px solid #f5f5f5;position:absolute;top:22px;bottom:0;left:0;right:0;overflow-y:auto;margin-bottom:20px;padding-top:10px}.remark-notes-area .remark-bottom-area .remark-notes-preview-area{height:30%;position:relative}.remark-notes-area .remark-bottom-area .remark-notes-preview-area .remark-notes-preview{border-top:1px solid #f5f5f5;position:absolute;top:22px;bottom:0;left:0;right:0;overflow-y:auto}.remark-notes-area .remark-bottom-area .remark-notes>*:first-child,.remark-notes-area .remark-bottom-area .remark-notes-preview>*:first-child{margin-top:5px}.remark-notes-area .remark-bottom-area .remark-notes>*:last-child,.remark-notes-area .remark-bottom-area .remark-notes-preview>*:last-child{margin-bottom:0}.remark-toolbar{color:#979892;vertical-align:middle}.remark-toolbar .remark-toolbar-link{border:2px solid #d7d8d2;color:#979892;display:inline-block;padding:2px 2px;text-decoration:none;text-align:center;min-width:20px}.remark-toolbar .remark-toolbar-link:hover{border-color:#979892;color:#676862}.remark-toolbar .remark-toolbar-timer{border:2px solid black;border-radius:10px;background:black;color:white;display:inline-block;float:right;padding:5px 10px;font-family:sans-serif;font-weight:bold;font-size:175%;text-decoration:none;text-align:center}.remark-container.remark-presenter-mode .remark-slides-area{top:2%;left:2%;height:47.25%;width:48%}.remark-container.remark-presenter-mode .remark-preview-area{display:block}.remark-container.remark-presenter-mode .remark-notes-area{display:block}.remark-container.remark-blackout-mode:not(.remark-presenter-mode) .remark-backdrop{display:block;opacity:.99}.remark-container.remark-mirrored-mode:not(.remark-presenter-mode) .remark-slides-area{-webkit-transform:scaleX(-1);-moz-transform:scaleX(-1);-ms-transform:scaleX(-1);-o-transform:scaleX(-1)}@media print{.remark-container{overflow:visible;background-color:#fff}.remark-container.remark-presenter-mode .remark-slides-area{top:0;left:0;height:100%;width:681px}.remark-container.remark-presenter-mode .remark-preview-area,.remark-container.remark-presenter-mode .remark-notes-area{display:none}.remark-container.remark-presenter-mode .remark-slide-notes{display:block;margin-left:30px;width:621px}.remark-slide-container{display:block;position:relative}.remark-slide-scaler{-moz-box-shadow:none;-webkit-box-shadow:none;-webkit-transform-origin:initial;box-shadow:none}}@page{margin:0}.hljs-agate{/*! * Agate by Taufik Nurrohman <https://github.com/tovic> * ---------------------------------------------------- * * #ade5fc * #a2fca2 * #c6b4f0 * #d36363 * #fcc28c * #fc9b9b * #ffa * #fff * #333 * #62c8f3 * #888 * */}.hljs-agate .hljs{display:block;overflow-x:auto;padding:.5em;background:#333;color:white}.hljs-agate .hljs-name,.hljs-agate .hljs-strong{font-weight:bold}.hljs-agate .hljs-code,.hljs-agate .hljs-emphasis{font-style:italic}.hljs-agate .hljs-tag{color:#62c8f3}.hljs-agate .hljs-variable,.hljs-agate .hljs-template-variable,.hljs-agate .hljs-selector-id,.hljs-agate .hljs-selector-class{color:#ade5fc}.hljs-agate .hljs-string,.hljs-agate .hljs-bullet{color:#a2fca2}.hljs-agate .hljs-type,.hljs-agate .hljs-title,.hljs-agate .hljs-section,.hljs-agate .hljs-attribute,.hljs-agate .hljs-quote,.hljs-agate .hljs-built_in,.hljs-agate .hljs-builtin-name{color:#ffa}.hljs-agate .hljs-number,.hljs-agate .hljs-symbol,.hljs-agate .hljs-bullet{color:#d36363}.hljs-agate .hljs-keyword,.hljs-agate .hljs-selector-tag,.hljs-agate .hljs-literal{color:#fcc28c}.hljs-agate .hljs-comment,.hljs-agate .hljs-deletion,.hljs-agate .hljs-code{color:#888}.hljs-agate .hljs-regexp,.hljs-agate .hljs-link{color:#c6b4f0}.hljs-agate .hljs-meta{color:#fc9b9b}.hljs-agate .hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-agate .hljs-addition{background-color:#a2fca2;color:#333}.hljs-agate .hljs a{color:inherit}.hljs-agate .hljs a:focus,.hljs-agate .hljs a:hover{color:inherit;text-decoration:underline}.hljs-androidstudio .hljs{color:#a9b7c6;background:#282b2e;display:block;overflow-x:auto;padding:.5em}.hljs-androidstudio .hljs-number,.hljs-androidstudio .hljs-literal,.hljs-androidstudio .hljs-symbol,.hljs-androidstudio .hljs-bullet{color:#6897BB}.hljs-androidstudio .hljs-keyword,.hljs-androidstudio .hljs-selector-tag,.hljs-androidstudio .hljs-deletion{color:#cc7832}.hljs-androidstudio .hljs-variable,.hljs-androidstudio .hljs-template-variable,.hljs-androidstudio .hljs-link{color:#629755}.hljs-androidstudio .hljs-comment,.hljs-androidstudio .hljs-quote{color:#808080}.hljs-androidstudio .hljs-meta{color:#bbb529}.hljs-androidstudio .hljs-string,.hljs-androidstudio .hljs-attribute,.hljs-androidstudio .hljs-addition{color:#6A8759}.hljs-androidstudio .hljs-section,.hljs-androidstudio .hljs-title,.hljs-androidstudio .hljs-type{color:#ffc66d}.hljs-androidstudio .hljs-name,.hljs-androidstudio .hljs-selector-id,.hljs-androidstudio .hljs-selector-class{color:#e8bf6a}.hljs-androidstudio .hljs-emphasis{font-style:italic}.hljs-androidstudio .hljs-strong{font-weight:bold}.hljs-arduino-light .hljs{display:block;overflow-x:auto;padding:.5em;background:#FFFFFF}.hljs-arduino-light .hljs,.hljs-arduino-light .hljs-subst{color:#434f54}.hljs-arduino-light .hljs-keyword,.hljs-arduino-light .hljs-attribute,.hljs-arduino-light .hljs-selector-tag,.hljs-arduino-light .hljs-doctag,.hljs-arduino-light .hljs-name{color:#00979D}.hljs-arduino-light .hljs-built_in,.hljs-arduino-light .hljs-literal,.hljs-arduino-light .hljs-bullet,.hljs-arduino-light .hljs-code,.hljs-arduino-light .hljs-addition{color:#D35400}.hljs-arduino-light .hljs-regexp,.hljs-arduino-light .hljs-symbol,.hljs-arduino-light .hljs-variable,.hljs-arduino-light .hljs-template-variable,.hljs-arduino-light .hljs-link,.hljs-arduino-light .hljs-selector-attr,.hljs-arduino-light .hljs-selector-pseudo{color:#00979D}.hljs-arduino-light .hljs-type,.hljs-arduino-light .hljs-string,.hljs-arduino-light .hljs-selector-id,.hljs-arduino-light .hljs-selector-class,.hljs-arduino-light .hljs-quote,.hljs-arduino-light .hljs-template-tag,.hljs-arduino-light .hljs-deletion{color:#005C5F}.hljs-arduino-light .hljs-title,.hljs-arduino-light .hljs-section{color:#880000;font-weight:bold}.hljs-arduino-light .hljs-comment{color:rgba(149,165,166,0.8)}.hljs-arduino-light .hljs-meta-keyword{color:#728E00}.hljs-arduino-light .hljs-meta{color:#728E00;color:#434f54}.hljs-arduino-light .hljs-emphasis{font-style:italic}.hljs-arduino-light .hljs-strong{font-weight:bold}.hljs-arduino-light .hljs-function{color:#728E00}.hljs-arduino-light .hljs-number{color:#8A7B52}.hljs-arta .hljs{display:block;overflow-x:auto;padding:.5em;background:#222}.hljs-arta .hljs,.hljs-arta .hljs-subst{color:#aaa}.hljs-arta .hljs-section{color:#fff}.hljs-arta .hljs-comment,.hljs-arta .hljs-quote,.hljs-arta .hljs-meta{color:#444}.hljs-arta .hljs-string,.hljs-arta .hljs-symbol,.hljs-arta .hljs-bullet,.hljs-arta .hljs-regexp{color:#ffcc33}.hljs-arta .hljs-number,.hljs-arta .hljs-addition{color:#00cc66}.hljs-arta .hljs-built_in,.hljs-arta .hljs-builtin-name,.hljs-arta .hljs-literal,.hljs-arta .hljs-type,.hljs-arta .hljs-template-variable,.hljs-arta .hljs-attribute,.hljs-arta .hljs-link{color:#32aaee}.hljs-arta .hljs-keyword,.hljs-arta .hljs-selector-tag,.hljs-arta .hljs-name,.hljs-arta .hljs-selector-id,.hljs-arta .hljs-selector-class{color:#6644aa}.hljs-arta .hljs-title,.hljs-arta .hljs-variable,.hljs-arta .hljs-deletion,.hljs-arta .hljs-template-tag{color:#bb1166}.hljs-arta .hljs-section,.hljs-arta .hljs-doctag,.hljs-arta .hljs-strong{font-weight:bold}.hljs-arta .hljs-emphasis{font-style:italic}.hljs-ascetic .hljs{display:block;overflow-x:auto;padding:.5em;background:white;color:black}.hljs-ascetic .hljs-string,.hljs-ascetic .hljs-variable,.hljs-ascetic .hljs-template-variable,.hljs-ascetic .hljs-symbol,.hljs-ascetic .hljs-bullet,.hljs-ascetic .hljs-section,.hljs-ascetic .hljs-addition,.hljs-ascetic .hljs-attribute,.hljs-ascetic .hljs-link{color:#888}.hljs-ascetic .hljs-comment,.hljs-ascetic .hljs-quote,.hljs-ascetic .hljs-meta,.hljs-ascetic .hljs-deletion{color:#ccc}.hljs-ascetic .hljs-keyword,.hljs-ascetic .hljs-selector-tag,.hljs-ascetic .hljs-section,.hljs-ascetic .hljs-name,.hljs-ascetic .hljs-type,.hljs-ascetic .hljs-strong{font-weight:bold}.hljs-ascetic .hljs-emphasis{font-style:italic}.hljs-atelier-cave-dark .hljs-comment,.hljs-atelier-cave-dark .hljs-quote{color:#7e7887}.hljs-atelier-cave-dark .hljs-variable,.hljs-atelier-cave-dark .hljs-template-variable,.hljs-atelier-cave-dark .hljs-attribute,.hljs-atelier-cave-dark .hljs-regexp,.hljs-atelier-cave-dark .hljs-link,.hljs-atelier-cave-dark .hljs-tag,.hljs-atelier-cave-dark .hljs-name,.hljs-atelier-cave-dark .hljs-selector-id,.hljs-atelier-cave-dark .hljs-selector-class{color:#be4678}.hljs-atelier-cave-dark .hljs-number,.hljs-atelier-cave-dark .hljs-meta,.hljs-atelier-cave-dark .hljs-built_in,.hljs-atelier-cave-dark .hljs-builtin-name,.hljs-atelier-cave-dark .hljs-literal,.hljs-atelier-cave-dark .hljs-type,.hljs-atelier-cave-dark .hljs-params{color:#aa573c}.hljs-atelier-cave-dark .hljs-string,.hljs-atelier-cave-dark .hljs-symbol,.hljs-atelier-cave-dark .hljs-bullet{color:#2a9292}.hljs-atelier-cave-dark .hljs-title,.hljs-atelier-cave-dark .hljs-section{color:#576ddb}.hljs-atelier-cave-dark .hljs-keyword,.hljs-atelier-cave-dark .hljs-selector-tag{color:#955ae7}.hljs-atelier-cave-dark .hljs-deletion,.hljs-atelier-cave-dark .hljs-addition{color:#19171c;display:inline-block;width:100%}.hljs-atelier-cave-dark .hljs-deletion{background-color:#be4678}.hljs-atelier-cave-dark .hljs-addition{background-color:#2a9292}.hljs-atelier-cave-dark .hljs{display:block;overflow-x:auto;background:#19171c;color:#8b8792;padding:.5em}.hljs-atelier-cave-dark .hljs-emphasis{font-style:italic}.hljs-atelier-cave-dark .hljs-strong{font-weight:bold}.hljs-atelier-cave-light .hljs-comment,.hljs-atelier-cave-light .hljs-quote{color:#655f6d}.hljs-atelier-cave-light .hljs-variable,.hljs-atelier-cave-light .hljs-template-variable,.hljs-atelier-cave-light .hljs-attribute,.hljs-atelier-cave-light .hljs-tag,.hljs-atelier-cave-light .hljs-name,.hljs-atelier-cave-light .hljs-regexp,.hljs-atelier-cave-light .hljs-link,.hljs-atelier-cave-light .hljs-name,.hljs-atelier-cave-light .hljs-name,.hljs-atelier-cave-light .hljs-selector-id,.hljs-atelier-cave-light .hljs-selector-class{color:#be4678}.hljs-atelier-cave-light .hljs-number,.hljs-atelier-cave-light .hljs-meta,.hljs-atelier-cave-light .hljs-built_in,.hljs-atelier-cave-light .hljs-builtin-name,.hljs-atelier-cave-light .hljs-literal,.hljs-atelier-cave-light .hljs-type,.hljs-atelier-cave-light .hljs-params{color:#aa573c}.hljs-atelier-cave-light .hljs-string,.hljs-atelier-cave-light .hljs-symbol,.hljs-atelier-cave-light .hljs-bullet{color:#2a9292}.hljs-atelier-cave-light .hljs-title,.hljs-atelier-cave-light .hljs-section{color:#576ddb}.hljs-atelier-cave-light .hljs-keyword,.hljs-atelier-cave-light .hljs-selector-tag{color:#955ae7}.hljs-atelier-cave-light .hljs-deletion,.hljs-atelier-cave-light .hljs-addition{color:#19171c;display:inline-block;width:100%}.hljs-atelier-cave-light .hljs-deletion{background-color:#be4678}.hljs-atelier-cave-light .hljs-addition{background-color:#2a9292}.hljs-atelier-cave-light .hljs{display:block;overflow-x:auto;background:#efecf4;color:#585260;padding:.5em}.hljs-atelier-cave-light .hljs-emphasis{font-style:italic}.hljs-atelier-cave-light .hljs-strong{font-weight:bold}.hljs-atelier-dune-dark .hljs-comment,.hljs-atelier-dune-dark .hljs-quote{color:#999580}.hljs-atelier-dune-dark .hljs-variable,.hljs-atelier-dune-dark .hljs-template-variable,.hljs-atelier-dune-dark .hljs-attribute,.hljs-atelier-dune-dark .hljs-tag,.hljs-atelier-dune-dark .hljs-name,.hljs-atelier-dune-dark .hljs-regexp,.hljs-atelier-dune-dark .hljs-link,.hljs-atelier-dune-dark .hljs-name,.hljs-atelier-dune-dark .hljs-selector-id,.hljs-atelier-dune-dark .hljs-selector-class{color:#d73737}.hljs-atelier-dune-dark .hljs-number,.hljs-atelier-dune-dark .hljs-meta,.hljs-atelier-dune-dark .hljs-built_in,.hljs-atelier-dune-dark .hljs-builtin-name,.hljs-atelier-dune-dark .hljs-literal,.hljs-atelier-dune-dark .hljs-type,.hljs-atelier-dune-dark .hljs-params{color:#b65611}.hljs-atelier-dune-dark .hljs-string,.hljs-atelier-dune-dark .hljs-symbol,.hljs-atelier-dune-dark .hljs-bullet{color:#60ac39}.hljs-atelier-dune-dark .hljs-title,.hljs-atelier-dune-dark .hljs-section{color:#6684e1}.hljs-atelier-dune-dark .hljs-keyword,.hljs-atelier-dune-dark .hljs-selector-tag{color:#b854d4}.hljs-atelier-dune-dark .hljs{display:block;overflow-x:auto;background:#20201d;color:#a6a28c;padding:.5em}.hljs-atelier-dune-dark .hljs-emphasis{font-style:italic}.hljs-atelier-dune-dark .hljs-strong{font-weight:bold}.hljs-atelier-dune-light .hljs-comment,.hljs-atelier-dune-light .hljs-quote{color:#7d7a68}.hljs-atelier-dune-light .hljs-variable,.hljs-atelier-dune-light .hljs-template-variable,.hljs-atelier-dune-light .hljs-attribute,.hljs-atelier-dune-light .hljs-tag,.hljs-atelier-dune-light .hljs-name,.hljs-atelier-dune-light .hljs-regexp,.hljs-atelier-dune-light .hljs-link,.hljs-atelier-dune-light .hljs-name,.hljs-atelier-dune-light .hljs-selector-id,.hljs-atelier-dune-light .hljs-selector-class{color:#d73737}.hljs-atelier-dune-light .hljs-number,.hljs-atelier-dune-light .hljs-meta,.hljs-atelier-dune-light .hljs-built_in,.hljs-atelier-dune-light .hljs-builtin-name,.hljs-atelier-dune-light .hljs-literal,.hljs-atelier-dune-light .hljs-type,.hljs-atelier-dune-light .hljs-params{color:#b65611}.hljs-atelier-dune-light .hljs-string,.hljs-atelier-dune-light .hljs-symbol,.hljs-atelier-dune-light .hljs-bullet{color:#60ac39}.hljs-atelier-dune-light .hljs-title,.hljs-atelier-dune-light .hljs-section{color:#6684e1}.hljs-atelier-dune-light .hljs-keyword,.hljs-atelier-dune-light .hljs-selector-tag{color:#b854d4}.hljs-atelier-dune-light .hljs{display:block;overflow-x:auto;background:#fefbec;color:#6e6b5e;padding:.5em}.hljs-atelier-dune-light .hljs-emphasis{font-style:italic}.hljs-atelier-dune-light .hljs-strong{font-weight:bold}.hljs-atelier-estuary-dark .hljs-comment,.hljs-atelier-estuary-dark .hljs-quote{color:#878573}.hljs-atelier-estuary-dark .hljs-variable,.hljs-atelier-estuary-dark .hljs-template-variable,.hljs-atelier-estuary-dark .hljs-attribute,.hljs-atelier-estuary-dark .hljs-tag,.hljs-atelier-estuary-dark .hljs-name,.hljs-atelier-estuary-dark .hljs-regexp,.hljs-atelier-estuary-dark .hljs-link,.hljs-atelier-estuary-dark .hljs-name,.hljs-atelier-estuary-dark .hljs-selector-id,.hljs-atelier-estuary-dark .hljs-selector-class{color:#ba6236}.hljs-atelier-estuary-dark .hljs-number,.hljs-atelier-estuary-dark .hljs-meta,.hljs-atelier-estuary-dark .hljs-built_in,.hljs-atelier-estuary-dark .hljs-builtin-name,.hljs-atelier-estuary-dark .hljs-literal,.hljs-atelier-estuary-dark .hljs-type,.hljs-atelier-estuary-dark .hljs-params{color:#ae7313}.hljs-atelier-estuary-dark .hljs-string,.hljs-atelier-estuary-dark .hljs-symbol,.hljs-atelier-estuary-dark .hljs-bullet{color:#7d9726}.hljs-atelier-estuary-dark .hljs-title,.hljs-atelier-estuary-dark .hljs-section{color:#36a166}.hljs-atelier-estuary-dark .hljs-keyword,.hljs-atelier-estuary-dark .hljs-selector-tag{color:#5f9182}.hljs-atelier-estuary-dark .hljs-deletion,.hljs-atelier-estuary-dark .hljs-addition{color:#22221b;display:inline-block;width:100%}.hljs-atelier-estuary-dark .hljs-deletion{background-color:#ba6236}.hljs-atelier-estuary-dark .hljs-addition{background-color:#7d9726}.hljs-atelier-estuary-dark .hljs{display:block;overflow-x:auto;background:#22221b;color:#929181;padding:.5em}.hljs-atelier-estuary-dark .hljs-emphasis{font-style:italic}.hljs-atelier-estuary-dark .hljs-strong{font-weight:bold}.hljs-atelier-estuary-light .hljs-comment,.hljs-atelier-estuary-light .hljs-quote{color:#6c6b5a}.hljs-atelier-estuary-light .hljs-variable,.hljs-atelier-estuary-light .hljs-template-variable,.hljs-atelier-estuary-light .hljs-attribute,.hljs-atelier-estuary-light .hljs-tag,.hljs-atelier-estuary-light .hljs-name,.hljs-atelier-estuary-light .hljs-regexp,.hljs-atelier-estuary-light .hljs-link,.hljs-atelier-estuary-light .hljs-name,.hljs-atelier-estuary-light .hljs-selector-id,.hljs-atelier-estuary-light .hljs-selector-class{color:#ba6236}.hljs-atelier-estuary-light .hljs-number,.hljs-atelier-estuary-light .hljs-meta,.hljs-atelier-estuary-light .hljs-built_in,.hljs-atelier-estuary-light .hljs-builtin-name,.hljs-atelier-estuary-light .hljs-literal,.hljs-atelier-estuary-light .hljs-type,.hljs-atelier-estuary-light .hljs-params{color:#ae7313}.hljs-atelier-estuary-light .hljs-string,.hljs-atelier-estuary-light .hljs-symbol,.hljs-atelier-estuary-light .hljs-bullet{color:#7d9726}.hljs-atelier-estuary-light .hljs-title,.hljs-atelier-estuary-light .hljs-section{color:#36a166}.hljs-atelier-estuary-light .hljs-keyword,.hljs-atelier-estuary-light .hljs-selector-tag{color:#5f9182}.hljs-atelier-estuary-light .hljs-deletion,.hljs-atelier-estuary-light .hljs-addition{color:#22221b;display:inline-block;width:100%}.hljs-atelier-estuary-light .hljs-deletion{background-color:#ba6236}.hljs-atelier-estuary-light .hljs-addition{background-color:#7d9726}.hljs-atelier-estuary-light .hljs{display:block;overflow-x:auto;background:#f4f3ec;color:#5f5e4e;padding:.5em}.hljs-atelier-estuary-light .hljs-emphasis{font-style:italic}.hljs-atelier-estuary-light .hljs-strong{font-weight:bold}.hljs-atelier-forest-dark .hljs-comment,.hljs-atelier-forest-dark .hljs-quote{color:#9c9491}.hljs-atelier-forest-dark .hljs-variable,.hljs-atelier-forest-dark .hljs-template-variable,.hljs-atelier-forest-dark .hljs-attribute,.hljs-atelier-forest-dark .hljs-tag,.hljs-atelier-forest-dark .hljs-name,.hljs-atelier-forest-dark .hljs-regexp,.hljs-atelier-forest-dark .hljs-link,.hljs-atelier-forest-dark .hljs-name,.hljs-atelier-forest-dark .hljs-selector-id,.hljs-atelier-forest-dark .hljs-selector-class{color:#f22c40}.hljs-atelier-forest-dark .hljs-number,.hljs-atelier-forest-dark .hljs-meta,.hljs-atelier-forest-dark .hljs-built_in,.hljs-atelier-forest-dark .hljs-builtin-name,.hljs-atelier-forest-dark .hljs-literal,.hljs-atelier-forest-dark .hljs-type,.hljs-atelier-forest-dark .hljs-params{color:#df5320}.hljs-atelier-forest-dark .hljs-string,.hljs-atelier-forest-dark .hljs-symbol,.hljs-atelier-forest-dark .hljs-bullet{color:#7b9726}.hljs-atelier-forest-dark .hljs-title,.hljs-atelier-forest-dark .hljs-section{color:#407ee7}.hljs-atelier-forest-dark .hljs-keyword,.hljs-atelier-forest-dark .hljs-selector-tag{color:#6666ea}.hljs-atelier-forest-dark .hljs{display:block;overflow-x:auto;background:#1b1918;color:#a8a19f;padding:.5em}.hljs-atelier-forest-dark .hljs-emphasis{font-style:italic}.hljs-atelier-forest-dark .hljs-strong{font-weight:bold}.hljs-atelier-forest-light .hljs-comment,.hljs-atelier-forest-light .hljs-quote{color:#766e6b}.hljs-atelier-forest-light .hljs-variable,.hljs-atelier-forest-light .hljs-template-variable,.hljs-atelier-forest-light .hljs-attribute,.hljs-atelier-forest-light .hljs-tag,.hljs-atelier-forest-light .hljs-name,.hljs-atelier-forest-light .hljs-regexp,.hljs-atelier-forest-light .hljs-link,.hljs-atelier-forest-light .hljs-name,.hljs-atelier-forest-light .hljs-selector-id,.hljs-atelier-forest-light .hljs-selector-class{color:#f22c40}.hljs-atelier-forest-light .hljs-number,.hljs-atelier-forest-light .hljs-meta,.hljs-atelier-forest-light .hljs-built_in,.hljs-atelier-forest-light .hljs-builtin-name,.hljs-atelier-forest-light .hljs-literal,.hljs-atelier-forest-light .hljs-type,.hljs-atelier-forest-light .hljs-params{color:#df5320}.hljs-atelier-forest-light .hljs-string,.hljs-atelier-forest-light .hljs-symbol,.hljs-atelier-forest-light .hljs-bullet{color:#7b9726}.hljs-atelier-forest-light .hljs-title,.hljs-atelier-forest-light .hljs-section{color:#407ee7}.hljs-atelier-forest-light .hljs-keyword,.hljs-atelier-forest-light .hljs-selector-tag{color:#6666ea}.hljs-atelier-forest-light .hljs{display:block;overflow-x:auto;background:#f1efee;color:#68615e;padding:.5em}.hljs-atelier-forest-light .hljs-emphasis{font-style:italic}.hljs-atelier-forest-light .hljs-strong{font-weight:bold}.hljs-atelier-heath-dark .hljs-comment,.hljs-atelier-heath-dark .hljs-quote{color:#9e8f9e}.hljs-atelier-heath-dark .hljs-variable,.hljs-atelier-heath-dark .hljs-template-variable,.hljs-atelier-heath-dark .hljs-attribute,.hljs-atelier-heath-dark .hljs-tag,.hljs-atelier-heath-dark .hljs-name,.hljs-atelier-heath-dark .hljs-regexp,.hljs-atelier-heath-dark .hljs-link,.hljs-atelier-heath-dark .hljs-name,.hljs-atelier-heath-dark .hljs-selector-id,.hljs-atelier-heath-dark .hljs-selector-class{color:#ca402b}.hljs-atelier-heath-dark .hljs-number,.hljs-atelier-heath-dark .hljs-meta,.hljs-atelier-heath-dark .hljs-built_in,.hljs-atelier-heath-dark .hljs-builtin-name,.hljs-atelier-heath-dark .hljs-literal,.hljs-atelier-heath-dark .hljs-type,.hljs-atelier-heath-dark .hljs-params{color:#a65926}.hljs-atelier-heath-dark .hljs-string,.hljs-atelier-heath-dark .hljs-symbol,.hljs-atelier-heath-dark .hljs-bullet{color:#918b3b}.hljs-atelier-heath-dark .hljs-title,.hljs-atelier-heath-dark .hljs-section{color:#516aec}.hljs-atelier-heath-dark .hljs-keyword,.hljs-atelier-heath-dark .hljs-selector-tag{color:#7b59c0}.hljs-atelier-heath-dark .hljs{display:block;overflow-x:auto;background:#1b181b;color:#ab9bab;padding:.5em}.hljs-atelier-heath-dark .hljs-emphasis{font-style:italic}.hljs-atelier-heath-dark .hljs-strong{font-weight:bold}.hljs-atelier-heath-light .hljs-comment,.hljs-atelier-heath-light .hljs-quote{color:#776977}.hljs-atelier-heath-light .hljs-variable,.hljs-atelier-heath-light .hljs-template-variable,.hljs-atelier-heath-light .hljs-attribute,.hljs-atelier-heath-light .hljs-tag,.hljs-atelier-heath-light .hljs-name,.hljs-atelier-heath-light .hljs-regexp,.hljs-atelier-heath-light .hljs-link,.hljs-atelier-heath-light .hljs-name,.hljs-atelier-heath-light .hljs-selector-id,.hljs-atelier-heath-light .hljs-selector-class{color:#ca402b}.hljs-atelier-heath-light .hljs-number,.hljs-atelier-heath-light .hljs-meta,.hljs-atelier-heath-light .hljs-built_in,.hljs-atelier-heath-light .hljs-builtin-name,.hljs-atelier-heath-light .hljs-literal,.hljs-atelier-heath-light .hljs-type,.hljs-atelier-heath-light .hljs-params{color:#a65926}.hljs-atelier-heath-light .hljs-string,.hljs-atelier-heath-light .hljs-symbol,.hljs-atelier-heath-light .hljs-bullet{color:#918b3b}.hljs-atelier-heath-light .hljs-title,.hljs-atelier-heath-light .hljs-section{color:#516aec}.hljs-atelier-heath-light .hljs-keyword,.hljs-atelier-heath-light .hljs-selector-tag{color:#7b59c0}.hljs-atelier-heath-light .hljs{display:block;overflow-x:auto;background:#f7f3f7;color:#695d69;padding:.5em}.hljs-atelier-heath-light .hljs-emphasis{font-style:italic}.hljs-atelier-heath-light .hljs-strong{font-weight:bold}.hljs-atelier-lakeside-dark .hljs-comment,.hljs-atelier-lakeside-dark .hljs-quote{color:#7195a8}.hljs-atelier-lakeside-dark .hljs-variable,.hljs-atelier-lakeside-dark .hljs-template-variable,.hljs-atelier-lakeside-dark .hljs-attribute,.hljs-atelier-lakeside-dark .hljs-tag,.hljs-atelier-lakeside-dark .hljs-name,.hljs-atelier-lakeside-dark .hljs-regexp,.hljs-atelier-lakeside-dark .hljs-link,.hljs-atelier-lakeside-dark .hljs-name,.hljs-atelier-lakeside-dark .hljs-selector-id,.hljs-atelier-lakeside-dark .hljs-selector-class{color:#d22d72}.hljs-atelier-lakeside-dark .hljs-number,.hljs-atelier-lakeside-dark .hljs-meta,.hljs-atelier-lakeside-dark .hljs-built_in,.hljs-atelier-lakeside-dark .hljs-builtin-name,.hljs-atelier-lakeside-dark .hljs-literal,.hljs-atelier-lakeside-dark .hljs-type,.hljs-atelier-lakeside-dark .hljs-params{color:#935c25}.hljs-atelier-lakeside-dark .hljs-string,.hljs-atelier-lakeside-dark .hljs-symbol,.hljs-atelier-lakeside-dark .hljs-bullet{color:#568c3b}.hljs-atelier-lakeside-dark .hljs-title,.hljs-atelier-lakeside-dark .hljs-section{color:#257fad}.hljs-atelier-lakeside-dark .hljs-keyword,.hljs-atelier-lakeside-dark .hljs-selector-tag{color:#6b6bb8}.hljs-atelier-lakeside-dark .hljs{display:block;overflow-x:auto;background:#161b1d;color:#7ea2b4;padding:.5em}.hljs-atelier-lakeside-dark .hljs-emphasis{font-style:italic}.hljs-atelier-lakeside-dark .hljs-strong{font-weight:bold}.hljs-atelier-lakeside-light .hljs-comment,.hljs-atelier-lakeside-light .hljs-quote{color:#5a7b8c}.hljs-atelier-lakeside-light .hljs-variable,.hljs-atelier-lakeside-light .hljs-template-variable,.hljs-atelier-lakeside-light .hljs-attribute,.hljs-atelier-lakeside-light .hljs-tag,.hljs-atelier-lakeside-light .hljs-name,.hljs-atelier-lakeside-light .hljs-regexp,.hljs-atelier-lakeside-light .hljs-link,.hljs-atelier-lakeside-light .hljs-name,.hljs-atelier-lakeside-light .hljs-selector-id,.hljs-atelier-lakeside-light .hljs-selector-class{color:#d22d72}.hljs-atelier-lakeside-light .hljs-number,.hljs-atelier-lakeside-light .hljs-meta,.hljs-atelier-lakeside-light .hljs-built_in,.hljs-atelier-lakeside-light .hljs-builtin-name,.hljs-atelier-lakeside-light .hljs-literal,.hljs-atelier-lakeside-light .hljs-type,.hljs-atelier-lakeside-light .hljs-params{color:#935c25}.hljs-atelier-lakeside-light .hljs-string,.hljs-atelier-lakeside-light .hljs-symbol,.hljs-atelier-lakeside-light .hljs-bullet{color:#568c3b}.hljs-atelier-lakeside-light .hljs-title,.hljs-atelier-lakeside-light .hljs-section{color:#257fad}.hljs-atelier-lakeside-light .hljs-keyword,.hljs-atelier-lakeside-light .hljs-selector-tag{color:#6b6bb8}.hljs-atelier-lakeside-light .hljs{display:block;overflow-x:auto;background:#ebf8ff;color:#516d7b;padding:.5em}.hljs-atelier-lakeside-light .hljs-emphasis{font-style:italic}.hljs-atelier-lakeside-light .hljs-strong{font-weight:bold}.hljs-atelier-plateau-dark .hljs-comment,.hljs-atelier-plateau-dark .hljs-quote{color:#7e7777}.hljs-atelier-plateau-dark .hljs-variable,.hljs-atelier-plateau-dark .hljs-template-variable,.hljs-atelier-plateau-dark .hljs-attribute,.hljs-atelier-plateau-dark .hljs-tag,.hljs-atelier-plateau-dark .hljs-name,.hljs-atelier-plateau-dark .hljs-regexp,.hljs-atelier-plateau-dark .hljs-link,.hljs-atelier-plateau-dark .hljs-name,.hljs-atelier-plateau-dark .hljs-selector-id,.hljs-atelier-plateau-dark .hljs-selector-class{color:#ca4949}.hljs-atelier-plateau-dark .hljs-number,.hljs-atelier-plateau-dark .hljs-meta,.hljs-atelier-plateau-dark .hljs-built_in,.hljs-atelier-plateau-dark .hljs-builtin-name,.hljs-atelier-plateau-dark .hljs-literal,.hljs-atelier-plateau-dark .hljs-type,.hljs-atelier-plateau-dark .hljs-params{color:#b45a3c}.hljs-atelier-plateau-dark .hljs-string,.hljs-atelier-plateau-dark .hljs-symbol,.hljs-atelier-plateau-dark .hljs-bullet{color:#4b8b8b}.hljs-atelier-plateau-dark .hljs-title,.hljs-atelier-plateau-dark .hljs-section{color:#7272ca}.hljs-atelier-plateau-dark .hljs-keyword,.hljs-atelier-plateau-dark .hljs-selector-tag{color:#8464c4}.hljs-atelier-plateau-dark .hljs-deletion,.hljs-atelier-plateau-dark .hljs-addition{color:#1b1818;display:inline-block;width:100%}.hljs-atelier-plateau-dark .hljs-deletion{background-color:#ca4949}.hljs-atelier-plateau-dark .hljs-addition{background-color:#4b8b8b}.hljs-atelier-plateau-dark .hljs{display:block;overflow-x:auto;background:#1b1818;color:#8a8585;padding:.5em}.hljs-atelier-plateau-dark .hljs-emphasis{font-style:italic}.hljs-atelier-plateau-dark .hljs-strong{font-weight:bold}.hljs-atelier-plateau-light .hljs-comment,.hljs-atelier-plateau-light .hljs-quote{color:#655d5d}.hljs-atelier-plateau-light .hljs-variable,.hljs-atelier-plateau-light .hljs-template-variable,.hljs-atelier-plateau-light .hljs-attribute,.hljs-atelier-plateau-light .hljs-tag,.hljs-atelier-plateau-light .hljs-name,.hljs-atelier-plateau-light .hljs-regexp,.hljs-atelier-plateau-light .hljs-link,.hljs-atelier-plateau-light .hljs-name,.hljs-atelier-plateau-light .hljs-selector-id,.hljs-atelier-plateau-light .hljs-selector-class{color:#ca4949}.hljs-atelier-plateau-light .hljs-number,.hljs-atelier-plateau-light .hljs-meta,.hljs-atelier-plateau-light .hljs-built_in,.hljs-atelier-plateau-light .hljs-builtin-name,.hljs-atelier-plateau-light .hljs-literal,.hljs-atelier-plateau-light .hljs-type,.hljs-atelier-plateau-light .hljs-params{color:#b45a3c}.hljs-atelier-plateau-light .hljs-string,.hljs-atelier-plateau-light .hljs-symbol,.hljs-atelier-plateau-light .hljs-bullet{color:#4b8b8b}.hljs-atelier-plateau-light .hljs-title,.hljs-atelier-plateau-light .hljs-section{color:#7272ca}.hljs-atelier-plateau-light .hljs-keyword,.hljs-atelier-plateau-light .hljs-selector-tag{color:#8464c4}.hljs-atelier-plateau-light .hljs-deletion,.hljs-atelier-plateau-light .hljs-addition{color:#1b1818;display:inline-block;width:100%}.hljs-atelier-plateau-light .hljs-deletion{background-color:#ca4949}.hljs-atelier-plateau-light .hljs-addition{background-color:#4b8b8b}.hljs-atelier-plateau-light .hljs{display:block;overflow-x:auto;background:#f4ecec;color:#585050;padding:.5em}.hljs-atelier-plateau-light .hljs-emphasis{font-style:italic}.hljs-atelier-plateau-light .hljs-strong{font-weight:bold}.hljs-atelier-savanna-dark .hljs-comment,.hljs-atelier-savanna-dark .hljs-quote{color:#78877d}.hljs-atelier-savanna-dark .hljs-variable,.hljs-atelier-savanna-dark .hljs-template-variable,.hljs-atelier-savanna-dark .hljs-attribute,.hljs-atelier-savanna-dark .hljs-tag,.hljs-atelier-savanna-dark .hljs-name,.hljs-atelier-savanna-dark .hljs-regexp,.hljs-atelier-savanna-dark .hljs-link,.hljs-atelier-savanna-dark .hljs-name,.hljs-atelier-savanna-dark .hljs-selector-id,.hljs-atelier-savanna-dark .hljs-selector-class{color:#b16139}.hljs-atelier-savanna-dark .hljs-number,.hljs-atelier-savanna-dark .hljs-meta,.hljs-atelier-savanna-dark .hljs-built_in,.hljs-atelier-savanna-dark .hljs-builtin-name,.hljs-atelier-savanna-dark .hljs-literal,.hljs-atelier-savanna-dark .hljs-type,.hljs-atelier-savanna-dark .hljs-params{color:#9f713c}.hljs-atelier-savanna-dark .hljs-string,.hljs-atelier-savanna-dark .hljs-symbol,.hljs-atelier-savanna-dark .hljs-bullet{color:#489963}.hljs-atelier-savanna-dark .hljs-title,.hljs-atelier-savanna-dark .hljs-section{color:#478c90}.hljs-atelier-savanna-dark .hljs-keyword,.hljs-atelier-savanna-dark .hljs-selector-tag{color:#55859b}.hljs-atelier-savanna-dark .hljs-deletion,.hljs-atelier-savanna-dark .hljs-addition{color:#171c19;display:inline-block;width:100%}.hljs-atelier-savanna-dark .hljs-deletion{background-color:#b16139}.hljs-atelier-savanna-dark .hljs-addition{background-color:#489963}.hljs-atelier-savanna-dark .hljs{display:block;overflow-x:auto;background:#171c19;color:#87928a;padding:.5em}.hljs-atelier-savanna-dark .hljs-emphasis{font-style:italic}.hljs-atelier-savanna-dark .hljs-strong{font-weight:bold}.hljs-atelier-savanna-light .hljs-comment,.hljs-atelier-savanna-light .hljs-quote{color:#5f6d64}.hljs-atelier-savanna-light .hljs-variable,.hljs-atelier-savanna-light .hljs-template-variable,.hljs-atelier-savanna-light .hljs-attribute,.hljs-atelier-savanna-light .hljs-tag,.hljs-atelier-savanna-light .hljs-name,.hljs-atelier-savanna-light .hljs-regexp,.hljs-atelier-savanna-light .hljs-link,.hljs-atelier-savanna-light .hljs-name,.hljs-atelier-savanna-light .hljs-selector-id,.hljs-atelier-savanna-light .hljs-selector-class{color:#b16139}.hljs-atelier-savanna-light .hljs-number,.hljs-atelier-savanna-light .hljs-meta,.hljs-atelier-savanna-light .hljs-built_in,.hljs-atelier-savanna-light .hljs-builtin-name,.hljs-atelier-savanna-light .hljs-literal,.hljs-atelier-savanna-light .hljs-type,.hljs-atelier-savanna-light .hljs-params{color:#9f713c}.hljs-atelier-savanna-light .hljs-string,.hljs-atelier-savanna-light .hljs-symbol,.hljs-atelier-savanna-light .hljs-bullet{color:#489963}.hljs-atelier-savanna-light .hljs-title,.hljs-atelier-savanna-light .hljs-section{color:#478c90}.hljs-atelier-savanna-light .hljs-keyword,.hljs-atelier-savanna-light .hljs-selector-tag{color:#55859b}.hljs-atelier-savanna-light .hljs-deletion,.hljs-atelier-savanna-light .hljs-addition{color:#171c19;display:inline-block;width:100%}.hljs-atelier-savanna-light .hljs-deletion{background-color:#b16139}.hljs-atelier-savanna-light .hljs-addition{background-color:#489963}.hljs-atelier-savanna-light .hljs{display:block;overflow-x:auto;background:#ecf4ee;color:#526057;padding:.5em}.hljs-atelier-savanna-light .hljs-emphasis{font-style:italic}.hljs-atelier-savanna-light .hljs-strong{font-weight:bold}.hljs-atelier-seaside-dark .hljs-comment,.hljs-atelier-seaside-dark .hljs-quote{color:#809980}.hljs-atelier-seaside-dark .hljs-variable,.hljs-atelier-seaside-dark .hljs-template-variable,.hljs-atelier-seaside-dark .hljs-attribute,.hljs-atelier-seaside-dark .hljs-tag,.hljs-atelier-seaside-dark .hljs-name,.hljs-atelier-seaside-dark .hljs-regexp,.hljs-atelier-seaside-dark .hljs-link,.hljs-atelier-seaside-dark .hljs-name,.hljs-atelier-seaside-dark .hljs-selector-id,.hljs-atelier-seaside-dark .hljs-selector-class{color:#e6193c}.hljs-atelier-seaside-dark .hljs-number,.hljs-atelier-seaside-dark .hljs-meta,.hljs-atelier-seaside-dark .hljs-built_in,.hljs-atelier-seaside-dark .hljs-builtin-name,.hljs-atelier-seaside-dark .hljs-literal,.hljs-atelier-seaside-dark .hljs-type,.hljs-atelier-seaside-dark .hljs-params{color:#87711d}.hljs-atelier-seaside-dark .hljs-string,.hljs-atelier-seaside-dark .hljs-symbol,.hljs-atelier-seaside-dark .hljs-bullet{color:#29a329}.hljs-atelier-seaside-dark .hljs-title,.hljs-atelier-seaside-dark .hljs-section{color:#3d62f5}.hljs-atelier-seaside-dark .hljs-keyword,.hljs-atelier-seaside-dark .hljs-selector-tag{color:#ad2bee}.hljs-atelier-seaside-dark .hljs{display:block;overflow-x:auto;background:#131513;color:#8ca68c;padding:.5em}.hljs-atelier-seaside-dark .hljs-emphasis{font-style:italic}.hljs-atelier-seaside-dark .hljs-strong{font-weight:bold}.hljs-atelier-seaside-light .hljs-comment,.hljs-atelier-seaside-light .hljs-quote{color:#687d68}.hljs-atelier-seaside-light .hljs-variable,.hljs-atelier-seaside-light .hljs-template-variable,.hljs-atelier-seaside-light .hljs-attribute,.hljs-atelier-seaside-light .hljs-tag,.hljs-atelier-seaside-light .hljs-name,.hljs-atelier-seaside-light .hljs-regexp,.hljs-atelier-seaside-light .hljs-link,.hljs-atelier-seaside-light .hljs-name,.hljs-atelier-seaside-light .hljs-selector-id,.hljs-atelier-seaside-light .hljs-selector-class{color:#e6193c}.hljs-atelier-seaside-light .hljs-number,.hljs-atelier-seaside-light .hljs-meta,.hljs-atelier-seaside-light .hljs-built_in,.hljs-atelier-seaside-light .hljs-builtin-name,.hljs-atelier-seaside-light .hljs-literal,.hljs-atelier-seaside-light .hljs-type,.hljs-atelier-seaside-light .hljs-params{color:#87711d}.hljs-atelier-seaside-light .hljs-string,.hljs-atelier-seaside-light .hljs-symbol,.hljs-atelier-seaside-light .hljs-bullet{color:#29a329}.hljs-atelier-seaside-light .hljs-title,.hljs-atelier-seaside-light .hljs-section{color:#3d62f5}.hljs-atelier-seaside-light .hljs-keyword,.hljs-atelier-seaside-light .hljs-selector-tag{color:#ad2bee}.hljs-atelier-seaside-light .hljs{display:block;overflow-x:auto;background:#f4fbf4;color:#5e6e5e;padding:.5em}.hljs-atelier-seaside-light .hljs-emphasis{font-style:italic}.hljs-atelier-seaside-light .hljs-strong{font-weight:bold}.hljs-atelier-sulphurpool-dark .hljs-comment,.hljs-atelier-sulphurpool-dark .hljs-quote{color:#898ea4}.hljs-atelier-sulphurpool-dark .hljs-variable,.hljs-atelier-sulphurpool-dark .hljs-template-variable,.hljs-atelier-sulphurpool-dark .hljs-attribute,.hljs-atelier-sulphurpool-dark .hljs-tag,.hljs-atelier-sulphurpool-dark .hljs-name,.hljs-atelier-sulphurpool-dark .hljs-regexp,.hljs-atelier-sulphurpool-dark .hljs-link,.hljs-atelier-sulphurpool-dark .hljs-name,.hljs-atelier-sulphurpool-dark .hljs-selector-id,.hljs-atelier-sulphurpool-dark .hljs-selector-class{color:#c94922}.hljs-atelier-sulphurpool-dark .hljs-number,.hljs-atelier-sulphurpool-dark .hljs-meta,.hljs-atelier-sulphurpool-dark .hljs-built_in,.hljs-atelier-sulphurpool-dark .hljs-builtin-name,.hljs-atelier-sulphurpool-dark .hljs-literal,.hljs-atelier-sulphurpool-dark .hljs-type,.hljs-atelier-sulphurpool-dark .hljs-params{color:#c76b29}.hljs-atelier-sulphurpool-dark .hljs-string,.hljs-atelier-sulphurpool-dark .hljs-symbol,.hljs-atelier-sulphurpool-dark .hljs-bullet{color:#ac9739}.hljs-atelier-sulphurpool-dark .hljs-title,.hljs-atelier-sulphurpool-dark .hljs-section{color:#3d8fd1}.hljs-atelier-sulphurpool-dark .hljs-keyword,.hljs-atelier-sulphurpool-dark .hljs-selector-tag{color:#6679cc}.hljs-atelier-sulphurpool-dark .hljs{display:block;overflow-x:auto;background:#202746;color:#979db4;padding:.5em}.hljs-atelier-sulphurpool-dark .hljs-emphasis{font-style:italic}.hljs-atelier-sulphurpool-dark .hljs-strong{font-weight:bold}.hljs-atelier-sulphurpool-light .hljs-comment,.hljs-atelier-sulphurpool-light .hljs-quote{color:#6b7394}.hljs-atelier-sulphurpool-light .hljs-variable,.hljs-atelier-sulphurpool-light .hljs-template-variable,.hljs-atelier-sulphurpool-light .hljs-attribute,.hljs-atelier-sulphurpool-light .hljs-tag,.hljs-atelier-sulphurpool-light .hljs-name,.hljs-atelier-sulphurpool-light .hljs-regexp,.hljs-atelier-sulphurpool-light .hljs-link,.hljs-atelier-sulphurpool-light .hljs-name,.hljs-atelier-sulphurpool-light .hljs-selector-id,.hljs-atelier-sulphurpool-light .hljs-selector-class{color:#c94922}.hljs-atelier-sulphurpool-light .hljs-number,.hljs-atelier-sulphurpool-light .hljs-meta,.hljs-atelier-sulphurpool-light .hljs-built_in,.hljs-atelier-sulphurpool-light .hljs-builtin-name,.hljs-atelier-sulphurpool-light .hljs-literal,.hljs-atelier-sulphurpool-light .hljs-type,.hljs-atelier-sulphurpool-light .hljs-params{color:#c76b29}.hljs-atelier-sulphurpool-light .hljs-string,.hljs-atelier-sulphurpool-light .hljs-symbol,.hljs-atelier-sulphurpool-light .hljs-bullet{color:#ac9739}.hljs-atelier-sulphurpool-light .hljs-title,.hljs-atelier-sulphurpool-light .hljs-section{color:#3d8fd1}.hljs-atelier-sulphurpool-light .hljs-keyword,.hljs-atelier-sulphurpool-light .hljs-selector-tag{color:#6679cc}.hljs-atelier-sulphurpool-light .hljs{display:block;overflow-x:auto;background:#f5f7ff;color:#5e6687;padding:.5em}.hljs-atelier-sulphurpool-light .hljs-emphasis{font-style:italic}.hljs-atelier-sulphurpool-light .hljs-strong{font-weight:bold}.hljs-atom-one-dark .hljs{display:block;overflow-x:auto;padding:.5em;color:#abb2bf;background:#282c34}.hljs-atom-one-dark .hljs-comment,.hljs-atom-one-dark .hljs-quote{color:#5c6370;font-style:italic}.hljs-atom-one-dark .hljs-doctag,.hljs-atom-one-dark .hljs-keyword,.hljs-atom-one-dark .hljs-formula{color:#c678dd}.hljs-atom-one-dark .hljs-section,.hljs-atom-one-dark .hljs-name,.hljs-atom-one-dark .hljs-selector-tag,.hljs-atom-one-dark .hljs-deletion,.hljs-atom-one-dark .hljs-subst{color:#e06c75}.hljs-atom-one-dark .hljs-literal{color:#56b6c2}.hljs-atom-one-dark .hljs-string,.hljs-atom-one-dark .hljs-regexp,.hljs-atom-one-dark .hljs-addition,.hljs-atom-one-dark .hljs-attribute,.hljs-atom-one-dark .hljs-meta-string{color:#98c379}.hljs-atom-one-dark .hljs-built_in,.hljs-atom-one-dark .hljs-class .hljs-title{color:#e6c07b}.hljs-atom-one-dark .hljs-variable,.hljs-atom-one-dark .hljs-template-variable,.hljs-atom-one-dark .hljs-type,.hljs-atom-one-dark .hljs-selector-class,.hljs-atom-one-dark .hljs-selector-attr,.hljs-atom-one-dark .hljs-selector-pseudo,.hljs-atom-one-dark .hljs-number{color:#d19a66}.hljs-atom-one-dark .hljs-symbol,.hljs-atom-one-dark .hljs-bullet,.hljs-atom-one-dark .hljs-link,.hljs-atom-one-dark .hljs-meta,.hljs-atom-one-dark .hljs-selector-id,.hljs-atom-one-dark .hljs-title{color:#61aeee}.hljs-atom-one-dark .hljs-emphasis{font-style:italic}.hljs-atom-one-dark .hljs-strong{font-weight:bold}.hljs-atom-one-dark .hljs-link{text-decoration:underline}.hljs-atom-one-light .hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}.hljs-atom-one-light .hljs-comment,.hljs-atom-one-light .hljs-quote{color:#a0a1a7;font-style:italic}.hljs-atom-one-light .hljs-doctag,.hljs-atom-one-light .hljs-keyword,.hljs-atom-one-light .hljs-formula{color:#a626a4}.hljs-atom-one-light .hljs-section,.hljs-atom-one-light .hljs-name,.hljs-atom-one-light .hljs-selector-tag,.hljs-atom-one-light .hljs-deletion,.hljs-atom-one-light .hljs-subst{color:#e45649}.hljs-atom-one-light .hljs-literal{color:#0184bb}.hljs-atom-one-light .hljs-string,.hljs-atom-one-light .hljs-regexp,.hljs-atom-one-light .hljs-addition,.hljs-atom-one-light .hljs-attribute,.hljs-atom-one-light .hljs-meta-string{color:#50a14f}.hljs-atom-one-light .hljs-built_in,.hljs-atom-one-light .hljs-class .hljs-title{color:#c18401}.hljs-atom-one-light .hljs-variable,.hljs-atom-one-light .hljs-template-variable,.hljs-atom-one-light .hljs-type,.hljs-atom-one-light .hljs-selector-class,.hljs-atom-one-light .hljs-selector-attr,.hljs-atom-one-light .hljs-selector-pseudo,.hljs-atom-one-light .hljs-number{color:#986801}.hljs-atom-one-light .hljs-symbol,.hljs-atom-one-light .hljs-bullet,.hljs-atom-one-light .hljs-link,.hljs-atom-one-light .hljs-meta,.hljs-atom-one-light .hljs-selector-id,.hljs-atom-one-light .hljs-title{color:#4078f2}.hljs-atom-one-light .hljs-emphasis{font-style:italic}.hljs-atom-one-light .hljs-strong{font-weight:bold}.hljs-atom-one-light .hljs-link{text-decoration:underline}.hljs-brown-paper .hljs{display:block;overflow-x:auto;padding:.5em;background:#b7a68e url(brown-papersq.png)}.hljs-brown-paper .hljs-keyword,.hljs-brown-paper .hljs-selector-tag,.hljs-brown-paper .hljs-literal{color:#005599;font-weight:bold}.hljs-brown-paper .hljs,.hljs-brown-paper .hljs-subst{color:#363c69}.hljs-brown-paper .hljs-string,.hljs-brown-paper .hljs-title,.hljs-brown-paper .hljs-section,.hljs-brown-paper .hljs-type,.hljs-brown-paper .hljs-attribute,.hljs-brown-paper .hljs-symbol,.hljs-brown-paper .hljs-bullet,.hljs-brown-paper .hljs-built_in,.hljs-brown-paper .hljs-addition,.hljs-brown-paper .hljs-variable,.hljs-brown-paper .hljs-template-tag,.hljs-brown-paper .hljs-template-variable,.hljs-brown-paper .hljs-link,.hljs-brown-paper .hljs-name{color:#2c009f}.hljs-brown-paper .hljs-comment,.hljs-brown-paper .hljs-quote,.hljs-brown-paper .hljs-meta,.hljs-brown-paper .hljs-deletion{color:#802022}.hljs-brown-paper .hljs-keyword,.hljs-brown-paper .hljs-selector-tag,.hljs-brown-paper .hljs-literal,.hljs-brown-paper .hljs-doctag,.hljs-brown-paper .hljs-title,.hljs-brown-paper .hljs-section,.hljs-brown-paper .hljs-type,.hljs-brown-paper .hljs-name,.hljs-brown-paper .hljs-strong{font-weight:bold}.hljs-brown-paper .hljs-emphasis{font-style:italic}.hljs-codepen-embed .hljs{display:block;overflow-x:auto;padding:.5em;background:#222;color:#fff}.hljs-codepen-embed .hljs-comment,.hljs-codepen-embed .hljs-quote{color:#777}.hljs-codepen-embed .hljs-variable,.hljs-codepen-embed .hljs-template-variable,.hljs-codepen-embed .hljs-tag,.hljs-codepen-embed .hljs-regexp,.hljs-codepen-embed .hljs-meta,.hljs-codepen-embed .hljs-number,.hljs-codepen-embed .hljs-built_in,.hljs-codepen-embed .hljs-builtin-name,.hljs-codepen-embed .hljs-literal,.hljs-codepen-embed .hljs-params,.hljs-codepen-embed .hljs-symbol,.hljs-codepen-embed .hljs-bullet,.hljs-codepen-embed .hljs-link,.hljs-codepen-embed .hljs-deletion{color:#ab875d}.hljs-codepen-embed .hljs-section,.hljs-codepen-embed .hljs-title,.hljs-codepen-embed .hljs-name,.hljs-codepen-embed .hljs-selector-id,.hljs-codepen-embed .hljs-selector-class,.hljs-codepen-embed .hljs-type,.hljs-codepen-embed .hljs-attribute{color:#9b869b}.hljs-codepen-embed .hljs-string,.hljs-codepen-embed .hljs-keyword,.hljs-codepen-embed .hljs-selector-tag,.hljs-codepen-embed .hljs-addition{color:#8f9c6c}.hljs-codepen-embed .hljs-emphasis{font-style:italic}.hljs-codepen-embed .hljs-strong{font-weight:bold}.hljs-color-brewer .hljs{display:block;overflow-x:auto;padding:.5em;background:#fff}.hljs-color-brewer .hljs,.hljs-color-brewer .hljs-subst{color:#000}.hljs-color-brewer .hljs-string,.hljs-color-brewer .hljs-meta,.hljs-color-brewer .hljs-symbol,.hljs-color-brewer .hljs-template-tag,.hljs-color-brewer .hljs-template-variable,.hljs-color-brewer .hljs-addition{color:#756bb1}.hljs-color-brewer .hljs-comment,.hljs-color-brewer .hljs-quote{color:#636363}.hljs-color-brewer .hljs-number,.hljs-color-brewer .hljs-regexp,.hljs-color-brewer .hljs-literal,.hljs-color-brewer .hljs-bullet,.hljs-color-brewer .hljs-link{color:#31a354}.hljs-color-brewer .hljs-deletion,.hljs-color-brewer .hljs-variable{color:#88f}.hljs-color-brewer .hljs-keyword,.hljs-color-brewer .hljs-selector-tag,.hljs-color-brewer .hljs-title,.hljs-color-brewer .hljs-section,.hljs-color-brewer .hljs-built_in,.hljs-color-brewer .hljs-doctag,.hljs-color-brewer .hljs-type,.hljs-color-brewer .hljs-tag,.hljs-color-brewer .hljs-name,.hljs-color-brewer .hljs-selector-id,.hljs-color-brewer .hljs-selector-class,.hljs-color-brewer .hljs-strong{color:#3182bd}.hljs-color-brewer .hljs-emphasis{font-style:italic}.hljs-color-brewer .hljs-attribute{color:#e6550d}.hljs-darcula .hljs{display:block;overflow-x:auto;padding:.5em;background:#2b2b2b}.hljs-darcula .hljs{color:#bababa}.hljs-darcula .hljs-strong,.hljs-darcula .hljs-emphasis{color:#a8a8a2}.hljs-darcula .hljs-bullet,.hljs-darcula .hljs-quote,.hljs-darcula .hljs-link,.hljs-darcula .hljs-number,.hljs-darcula .hljs-regexp,.hljs-darcula .hljs-literal{color:#6896ba}.hljs-darcula .hljs-code,.hljs-darcula .hljs-selector-class{color:#a6e22e}.hljs-darcula .hljs-emphasis{font-style:italic}.hljs-darcula .hljs-keyword,.hljs-darcula .hljs-selector-tag,.hljs-darcula .hljs-section,.hljs-darcula .hljs-attribute,.hljs-darcula .hljs-name,.hljs-darcula .hljs-variable{color:#cb7832}.hljs-darcula .hljs-params{color:#b9b9b9}.hljs-darcula .hljs-string{color:#6a8759}.hljs-darcula .hljs-subst,.hljs-darcula .hljs-type,.hljs-darcula .hljs-built_in,.hljs-darcula .hljs-builtin-name,.hljs-darcula .hljs-symbol,.hljs-darcula .hljs-selector-id,.hljs-darcula .hljs-selector-attr,.hljs-darcula .hljs-selector-pseudo,.hljs-darcula .hljs-template-tag,.hljs-darcula .hljs-template-variable,.hljs-darcula .hljs-addition{color:#e0c46c}.hljs-darcula .hljs-comment,.hljs-darcula .hljs-deletion,.hljs-darcula .hljs-meta{color:#7f7f7f}.hljs-dark .hljs{display:block;overflow-x:auto;padding:.5em;background:#444}.hljs-dark .hljs-keyword,.hljs-dark .hljs-selector-tag,.hljs-dark .hljs-literal,.hljs-dark .hljs-section,.hljs-dark .hljs-link{color:white}.hljs-dark .hljs,.hljs-dark .hljs-subst{color:#ddd}.hljs-dark .hljs-string,.hljs-dark .hljs-title,.hljs-dark .hljs-name,.hljs-dark .hljs-type,.hljs-dark .hljs-attribute,.hljs-dark .hljs-symbol,.hljs-dark .hljs-bullet,.hljs-dark .hljs-built_in,.hljs-dark .hljs-addition,.hljs-dark .hljs-variable,.hljs-dark .hljs-template-tag,.hljs-dark .hljs-template-variable{color:#d88}.hljs-dark .hljs-comment,.hljs-dark .hljs-quote,.hljs-dark .hljs-deletion,.hljs-dark .hljs-meta{color:#777}.hljs-dark .hljs-keyword,.hljs-dark .hljs-selector-tag,.hljs-dark .hljs-literal,.hljs-dark .hljs-title,.hljs-dark .hljs-section,.hljs-dark .hljs-doctag,.hljs-dark .hljs-type,.hljs-dark .hljs-name,.hljs-dark .hljs-strong{font-weight:bold}.hljs-dark .hljs-emphasis{font-style:italic}.hljs-darkula{@import url('darcula.css');}.hljs-default .hljs{display:block;overflow-x:auto;padding:.5em;background:#F0F0F0}.hljs-default .hljs,.hljs-default .hljs-subst{color:#444}.hljs-default .hljs-comment{color:#888888}.hljs-default .hljs-keyword,.hljs-default .hljs-attribute,.hljs-default .hljs-selector-tag,.hljs-default .hljs-meta-keyword,.hljs-default .hljs-doctag,.hljs-default .hljs-name{font-weight:bold}.hljs-default .hljs-type,.hljs-default .hljs-string,.hljs-default .hljs-number,.hljs-default .hljs-selector-id,.hljs-default .hljs-selector-class,.hljs-default .hljs-quote,.hljs-default .hljs-template-tag,.hljs-default .hljs-deletion{color:#880000}.hljs-default .hljs-title,.hljs-default .hljs-section{color:#880000;font-weight:bold}.hljs-default .hljs-regexp,.hljs-default .hljs-symbol,.hljs-default .hljs-variable,.hljs-default .hljs-template-variable,.hljs-default .hljs-link,.hljs-default .hljs-selector-attr,.hljs-default .hljs-selector-pseudo{color:#BC6060}.hljs-default .hljs-literal{color:#78A960}.hljs-default .hljs-built_in,.hljs-default .hljs-bullet,.hljs-default .hljs-code,.hljs-default .hljs-addition{color:#397300}.hljs-default .hljs-meta{color:#1f7199}.hljs-default .hljs-meta-string{color:#4d99bf}.hljs-default .hljs-emphasis{font-style:italic}.hljs-default .hljs-strong{font-weight:bold}.hljs-docco .hljs{display:block;overflow-x:auto;padding:.5em;color:#000;background:#f8f8ff}.hljs-docco .hljs-comment,.hljs-docco .hljs-quote{color:#408080;font-style:italic}.hljs-docco .hljs-keyword,.hljs-docco .hljs-selector-tag,.hljs-docco .hljs-literal,.hljs-docco .hljs-subst{color:#954121}.hljs-docco .hljs-number{color:#40a070}.hljs-docco .hljs-string,.hljs-docco .hljs-doctag{color:#219161}.hljs-docco .hljs-selector-id,.hljs-docco .hljs-selector-class,.hljs-docco .hljs-section,.hljs-docco .hljs-type{color:#19469d}.hljs-docco .hljs-params{color:#00f}.hljs-docco .hljs-title{color:#458;font-weight:bold}.hljs-docco .hljs-tag,.hljs-docco .hljs-name,.hljs-docco .hljs-attribute{color:#000080;font-weight:normal}.hljs-docco .hljs-variable,.hljs-docco .hljs-template-variable{color:#008080}.hljs-docco .hljs-regexp,.hljs-docco .hljs-link{color:#b68}.hljs-docco .hljs-symbol,.hljs-docco .hljs-bullet{color:#990073}.hljs-docco .hljs-built_in,.hljs-docco .hljs-builtin-name{color:#0086b3}.hljs-docco .hljs-meta{color:#999;font-weight:bold}.hljs-docco .hljs-deletion{background:#fdd}.hljs-docco .hljs-addition{background:#dfd}.hljs-docco .hljs-emphasis{font-style:italic}.hljs-docco .hljs-strong{font-weight:bold}.hljs-dracula .hljs{display:block;overflow-x:auto;padding:.5em;background:#282a36}.hljs-dracula .hljs-keyword,.hljs-dracula .hljs-selector-tag,.hljs-dracula .hljs-literal,.hljs-dracula .hljs-section,.hljs-dracula .hljs-link{color:#8be9fd}.hljs-dracula .hljs-function .hljs-keyword{color:#ff79c6}.hljs-dracula .hljs,.hljs-dracula .hljs-subst{color:#f8f8f2}.hljs-dracula .hljs-string,.hljs-dracula .hljs-title,.hljs-dracula .hljs-name,.hljs-dracula .hljs-type,.hljs-dracula .hljs-attribute,.hljs-dracula .hljs-symbol,.hljs-dracula .hljs-bullet,.hljs-dracula .hljs-addition,.hljs-dracula .hljs-variable,.hljs-dracula .hljs-template-tag,.hljs-dracula .hljs-template-variable{color:#f1fa8c}.hljs-dracula .hljs-comment,.hljs-dracula .hljs-quote,.hljs-dracula .hljs-deletion,.hljs-dracula .hljs-meta{color:#6272a4}.hljs-dracula .hljs-keyword,.hljs-dracula .hljs-selector-tag,.hljs-dracula .hljs-literal,.hljs-dracula .hljs-title,.hljs-dracula .hljs-section,.hljs-dracula .hljs-doctag,.hljs-dracula .hljs-type,.hljs-dracula .hljs-name,.hljs-dracula .hljs-strong{font-weight:bold}.hljs-dracula .hljs-emphasis{font-style:italic}.hljs-far .hljs{display:block;overflow-x:auto;padding:.5em;background:#000080}.hljs-far .hljs,.hljs-far .hljs-subst{color:#0ff}.hljs-far .hljs-string,.hljs-far .hljs-attribute,.hljs-far .hljs-symbol,.hljs-far .hljs-bullet,.hljs-far .hljs-built_in,.hljs-far .hljs-builtin-name,.hljs-far .hljs-template-tag,.hljs-far .hljs-template-variable,.hljs-far .hljs-addition{color:#ff0}.hljs-far .hljs-keyword,.hljs-far .hljs-selector-tag,.hljs-far .hljs-section,.hljs-far .hljs-type,.hljs-far .hljs-name,.hljs-far .hljs-selector-id,.hljs-far .hljs-selector-class,.hljs-far .hljs-variable{color:#fff}.hljs-far .hljs-comment,.hljs-far .hljs-quote,.hljs-far .hljs-doctag,.hljs-far .hljs-deletion{color:#888}.hljs-far .hljs-number,.hljs-far .hljs-regexp,.hljs-far .hljs-literal,.hljs-far .hljs-link{color:#0f0}.hljs-far .hljs-meta{color:#008080}.hljs-far .hljs-keyword,.hljs-far .hljs-selector-tag,.hljs-far .hljs-title,.hljs-far .hljs-section,.hljs-far .hljs-name,.hljs-far .hljs-strong{font-weight:bold}.hljs-far .hljs-emphasis{font-style:italic}.hljs-foundation .hljs{display:block;overflow-x:auto;padding:.5em;background:#eee;color:black}.hljs-foundation .hljs-link,.hljs-foundation .hljs-emphasis,.hljs-foundation .hljs-attribute,.hljs-foundation .hljs-addition{color:#070}.hljs-foundation .hljs-emphasis{font-style:italic}.hljs-foundation .hljs-strong,.hljs-foundation .hljs-string,.hljs-foundation .hljs-deletion{color:#d14}.hljs-foundation .hljs-strong{font-weight:bold}.hljs-foundation .hljs-quote,.hljs-foundation .hljs-comment{color:#998;font-style:italic}.hljs-foundation .hljs-section,.hljs-foundation .hljs-title{color:#900}.hljs-foundation .hljs-class .hljs-title,.hljs-foundation .hljs-type{color:#458}.hljs-foundation .hljs-variable,.hljs-foundation .hljs-template-variable{color:#336699}.hljs-foundation .hljs-bullet{color:#997700}.hljs-foundation .hljs-meta{color:#3344bb}.hljs-foundation .hljs-code,.hljs-foundation .hljs-number,.hljs-foundation .hljs-literal,.hljs-foundation .hljs-keyword,.hljs-foundation .hljs-selector-tag{color:#099}.hljs-foundation .hljs-regexp{background-color:#fff0ff;color:#880088}.hljs-foundation .hljs-symbol{color:#990073}.hljs-foundation .hljs-tag,.hljs-foundation .hljs-name,.hljs-foundation .hljs-selector-id,.hljs-foundation .hljs-selector-class{color:#007700}.hljs-github-gist .hljs{display:block;background:white;padding:.5em;color:#333333;overflow-x:auto}.hljs-github-gist .hljs-comment,.hljs-github-gist .hljs-meta{color:#969896}.hljs-github-gist .hljs-string,.hljs-github-gist .hljs-variable,.hljs-github-gist .hljs-template-variable,.hljs-github-gist .hljs-strong,.hljs-github-gist .hljs-emphasis,.hljs-github-gist .hljs-quote{color:#df5000}.hljs-github-gist .hljs-keyword,.hljs-github-gist .hljs-selector-tag,.hljs-github-gist .hljs-type{color:#a71d5d}.hljs-github-gist .hljs-literal,.hljs-github-gist .hljs-symbol,.hljs-github-gist .hljs-bullet,.hljs-github-gist .hljs-attribute{color:#0086b3}.hljs-github-gist .hljs-section,.hljs-github-gist .hljs-name{color:#63a35c}.hljs-github-gist .hljs-tag{color:#333333}.hljs-github-gist .hljs-title,.hljs-github-gist .hljs-attr,.hljs-github-gist .hljs-selector-id,.hljs-github-gist .hljs-selector-class,.hljs-github-gist .hljs-selector-attr,.hljs-github-gist .hljs-selector-pseudo{color:#795da3}.hljs-github-gist .hljs-addition{color:#55a532;background-color:#eaffea}.hljs-github-gist .hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-github-gist .hljs-link{text-decoration:underline}.hljs-github .hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8}.hljs-github .hljs-comment,.hljs-github .hljs-quote{color:#998;font-style:italic}.hljs-github .hljs-keyword,.hljs-github .hljs-selector-tag,.hljs-github .hljs-subst{color:#333;font-weight:bold}.hljs-github .hljs-number,.hljs-github .hljs-literal,.hljs-github .hljs-variable,.hljs-github .hljs-template-variable,.hljs-github .hljs-tag .hljs-attr{color:#008080}.hljs-github .hljs-string,.hljs-github .hljs-doctag{color:#d14}.hljs-github .hljs-title,.hljs-github .hljs-section,.hljs-github .hljs-selector-id{color:#900;font-weight:bold}.hljs-github .hljs-subst{font-weight:normal}.hljs-github .hljs-type,.hljs-github .hljs-class .hljs-title{color:#458;font-weight:bold}.hljs-github .hljs-tag,.hljs-github .hljs-name,.hljs-github .hljs-attribute{color:#000080;font-weight:normal}.hljs-github .hljs-regexp,.hljs-github .hljs-link{color:#009926}.hljs-github .hljs-symbol,.hljs-github .hljs-bullet{color:#990073}.hljs-github .hljs-built_in,.hljs-github .hljs-builtin-name{color:#0086b3}.hljs-github .hljs-meta{color:#999;font-weight:bold}.hljs-github .hljs-deletion{background:#fdd}.hljs-github .hljs-addition{background:#dfd}.hljs-github .hljs-emphasis{font-style:italic}.hljs-github .hljs-strong{font-weight:bold}.hljs-googlecode .hljs{display:block;overflow-x:auto;padding:.5em;background:white;color:black}.hljs-googlecode .hljs-comment,.hljs-googlecode .hljs-quote{color:#800}.hljs-googlecode .hljs-keyword,.hljs-googlecode .hljs-selector-tag,.hljs-googlecode .hljs-section,.hljs-googlecode .hljs-title,.hljs-googlecode .hljs-name{color:#008}.hljs-googlecode .hljs-variable,.hljs-googlecode .hljs-template-variable{color:#660}.hljs-googlecode .hljs-string,.hljs-googlecode .hljs-selector-attr,.hljs-googlecode .hljs-selector-pseudo,.hljs-googlecode .hljs-regexp{color:#080}.hljs-googlecode .hljs-literal,.hljs-googlecode .hljs-symbol,.hljs-googlecode .hljs-bullet,.hljs-googlecode .hljs-meta,.hljs-googlecode .hljs-number,.hljs-googlecode .hljs-link{color:#066}.hljs-googlecode .hljs-title,.hljs-googlecode .hljs-doctag,.hljs-googlecode .hljs-type,.hljs-googlecode .hljs-attr,.hljs-googlecode .hljs-built_in,.hljs-googlecode .hljs-builtin-name,.hljs-googlecode .hljs-params{color:#606}.hljs-googlecode .hljs-attribute,.hljs-googlecode .hljs-subst{color:#000}.hljs-googlecode .hljs-formula{background-color:#eee;font-style:italic}.hljs-googlecode .hljs-selector-id,.hljs-googlecode .hljs-selector-class{color:#9B703F}.hljs-googlecode .hljs-addition{background-color:#baeeba}.hljs-googlecode .hljs-deletion{background-color:#ffc8bd}.hljs-googlecode .hljs-doctag,.hljs-googlecode .hljs-strong{font-weight:bold}.hljs-googlecode .hljs-emphasis{font-style:italic}.hljs-grayscale .hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#fff}.hljs-grayscale .hljs-comment,.hljs-grayscale .hljs-quote{color:#777;font-style:italic}.hljs-grayscale .hljs-keyword,.hljs-grayscale .hljs-selector-tag,.hljs-grayscale .hljs-subst{color:#333;font-weight:bold}.hljs-grayscale .hljs-number,.hljs-grayscale .hljs-literal{color:#777}.hljs-grayscale .hljs-string,.hljs-grayscale .hljs-doctag,.hljs-grayscale .hljs-formula{color:#333;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAJ0lEQVQIW2O8e/fufwYGBgZBQUEQxcCIIfDu3Tuwivfv30NUoAsAALHpFMMLqZlPAAAAAElFTkSuQmCC) repeat}.hljs-grayscale .hljs-title,.hljs-grayscale .hljs-section,.hljs-grayscale .hljs-selector-id{color:#000;font-weight:bold}.hljs-grayscale .hljs-subst{font-weight:normal}.hljs-grayscale .hljs-class .hljs-title,.hljs-grayscale .hljs-type,.hljs-grayscale .hljs-name{color:#333;font-weight:bold}.hljs-grayscale .hljs-tag{color:#333}.hljs-grayscale .hljs-regexp{color:#333;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAICAYAAADA+m62AAAAPUlEQVQYV2NkQAN37979r6yszIgujiIAU4RNMVwhuiQ6H6wQl3XI4oy4FMHcCJPHcDS6J2A2EqUQpJhohQDexSef15DBCwAAAABJRU5ErkJggg==) repeat}.hljs-grayscale .hljs-symbol,.hljs-grayscale .hljs-bullet,.hljs-grayscale .hljs-link{color:#000;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAKElEQVQIW2NkQAO7d+/+z4gsBhJwdXVlhAvCBECKwIIwAbhKZBUwBQA6hBpm5efZsgAAAABJRU5ErkJggg==) repeat}.hljs-grayscale .hljs-built_in,.hljs-grayscale .hljs-builtin-name{color:#000;text-decoration:underline}.hljs-grayscale .hljs-meta{color:#999;font-weight:bold}.hljs-grayscale .hljs-deletion{color:#fff;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAADCAYAAABS3WWCAAAAE0lEQVQIW2MMDQ39zzhz5kwIAQAyxweWgUHd1AAAAABJRU5ErkJggg==) repeat}.hljs-grayscale .hljs-addition{color:#000;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAALUlEQVQYV2N89+7dfwYk8P79ewZBQUFkIQZGOiu6e/cuiptQHAPl0NtNxAQBAM97Oejj3Dg7AAAAAElFTkSuQmCC) repeat}.hljs-grayscale .hljs-emphasis{font-style:italic}.hljs-grayscale .hljs-strong{font-weight:bold}.hljs-gruvbox-dark .hljs{display:block;overflow-x:auto;padding:.5em;background:#282828}.hljs-gruvbox-dark .hljs,.hljs-gruvbox-dark .hljs-subst{color:#ebdbb2}.hljs-gruvbox-dark .hljs-deletion,.hljs-gruvbox-dark .hljs-formula,.hljs-gruvbox-dark .hljs-keyword,.hljs-gruvbox-dark .hljs-link,.hljs-gruvbox-dark .hljs-selector-tag{color:#fb4934}.hljs-gruvbox-dark .hljs-built_in,.hljs-gruvbox-dark .hljs-emphasis,.hljs-gruvbox-dark .hljs-name,.hljs-gruvbox-dark .hljs-quote,.hljs-gruvbox-dark .hljs-strong,.hljs-gruvbox-dark .hljs-title,.hljs-gruvbox-dark .hljs-variable{color:#83a598}.hljs-gruvbox-dark .hljs-attr,.hljs-gruvbox-dark .hljs-params,.hljs-gruvbox-dark .hljs-template-tag,.hljs-gruvbox-dark .hljs-type{color:#fabd2f}.hljs-gruvbox-dark .hljs-builtin-name,.hljs-gruvbox-dark .hljs-doctag,.hljs-gruvbox-dark .hljs-literal,.hljs-gruvbox-dark .hljs-number{color:#8f3f71}.hljs-gruvbox-dark .hljs-code,.hljs-gruvbox-dark .hljs-meta,.hljs-gruvbox-dark .hljs-regexp,.hljs-gruvbox-dark .hljs-selector-id,.hljs-gruvbox-dark .hljs-template-variable{color:#fe8019}.hljs-gruvbox-dark .hljs-addition,.hljs-gruvbox-dark .hljs-meta-string,.hljs-gruvbox-dark .hljs-section,.hljs-gruvbox-dark .hljs-selector-attr,.hljs-gruvbox-dark .hljs-selector-class,.hljs-gruvbox-dark .hljs-string,.hljs-gruvbox-dark .hljs-symbol{color:#b8bb26}.hljs-gruvbox-dark .hljs-attribute,.hljs-gruvbox-dark .hljs-bullet,.hljs-gruvbox-dark .hljs-class,.hljs-gruvbox-dark .hljs-function,.hljs-gruvbox-dark .hljs-function .hljs-keyword,.hljs-gruvbox-dark .hljs-meta-keyword,.hljs-gruvbox-dark .hljs-selector-pseudo,.hljs-gruvbox-dark .hljs-tag{color:#8ec07c}.hljs-gruvbox-dark .hljs-comment{color:#928374}.hljs-gruvbox-dark .hljs-link_label,.hljs-gruvbox-dark .hljs-literal,.hljs-gruvbox-dark .hljs-number{color:#d3869b}.hljs-gruvbox-dark .hljs-comment,.hljs-gruvbox-dark .hljs-emphasis{font-style:italic}.hljs-gruvbox-dark .hljs-section,.hljs-gruvbox-dark .hljs-strong,.hljs-gruvbox-dark .hljs-tag{font-weight:bold}.hljs-gruvbox-light .hljs{display:block;overflow-x:auto;padding:.5em;background:#fbf1c7}.hljs-gruvbox-light .hljs,.hljs-gruvbox-light .hljs-subst{color:#3c3836}.hljs-gruvbox-light .hljs-deletion,.hljs-gruvbox-light .hljs-formula,.hljs-gruvbox-light .hljs-keyword,.hljs-gruvbox-light .hljs-link,.hljs-gruvbox-light .hljs-selector-tag{color:#9d0006}.hljs-gruvbox-light .hljs-built_in,.hljs-gruvbox-light .hljs-emphasis,.hljs-gruvbox-light .hljs-name,.hljs-gruvbox-light .hljs-quote,.hljs-gruvbox-light .hljs-strong,.hljs-gruvbox-light .hljs-title,.hljs-gruvbox-light .hljs-variable{color:#076678}.hljs-gruvbox-light .hljs-attr,.hljs-gruvbox-light .hljs-params,.hljs-gruvbox-light .hljs-template-tag,.hljs-gruvbox-light .hljs-type{color:#b57614}.hljs-gruvbox-light .hljs-builtin-name,.hljs-gruvbox-light .hljs-doctag,.hljs-gruvbox-light .hljs-literal,.hljs-gruvbox-light .hljs-number{color:#8f3f71}.hljs-gruvbox-light .hljs-code,.hljs-gruvbox-light .hljs-meta,.hljs-gruvbox-light .hljs-regexp,.hljs-gruvbox-light .hljs-selector-id,.hljs-gruvbox-light .hljs-template-variable{color:#af3a03}.hljs-gruvbox-light .hljs-addition,.hljs-gruvbox-light .hljs-meta-string,.hljs-gruvbox-light .hljs-section,.hljs-gruvbox-light .hljs-selector-attr,.hljs-gruvbox-light .hljs-selector-class,.hljs-gruvbox-light .hljs-string,.hljs-gruvbox-light .hljs-symbol{color:#79740e}.hljs-gruvbox-light .hljs-attribute,.hljs-gruvbox-light .hljs-bullet,.hljs-gruvbox-light .hljs-class,.hljs-gruvbox-light .hljs-function,.hljs-gruvbox-light .hljs-function .hljs-keyword,.hljs-gruvbox-light .hljs-meta-keyword,.hljs-gruvbox-light .hljs-selector-pseudo,.hljs-gruvbox-light .hljs-tag{color:#427b58}.hljs-gruvbox-light .hljs-comment{color:#928374}.hljs-gruvbox-light .hljs-link_label,.hljs-gruvbox-light .hljs-literal,.hljs-gruvbox-light .hljs-number{color:#8f3f71}.hljs-gruvbox-light .hljs-comment,.hljs-gruvbox-light .hljs-emphasis{font-style:italic}.hljs-gruvbox-light .hljs-section,.hljs-gruvbox-light .hljs-strong,.hljs-gruvbox-light .hljs-tag{font-weight:bold}.hljs-hopscotch .hljs-comment,.hljs-hopscotch .hljs-quote{color:#989498}.hljs-hopscotch .hljs-variable,.hljs-hopscotch .hljs-template-variable,.hljs-hopscotch .hljs-attribute,.hljs-hopscotch .hljs-tag,.hljs-hopscotch .hljs-name,.hljs-hopscotch .hljs-selector-id,.hljs-hopscotch .hljs-selector-class,.hljs-hopscotch .hljs-regexp,.hljs-hopscotch .hljs-link,.hljs-hopscotch .hljs-deletion{color:#dd464c}.hljs-hopscotch .hljs-number,.hljs-hopscotch .hljs-built_in,.hljs-hopscotch .hljs-builtin-name,.hljs-hopscotch .hljs-literal,.hljs-hopscotch .hljs-type,.hljs-hopscotch .hljs-params{color:#fd8b19}.hljs-hopscotch .hljs-class .hljs-title{color:#fdcc59}.hljs-hopscotch .hljs-string,.hljs-hopscotch .hljs-symbol,.hljs-hopscotch .hljs-bullet,.hljs-hopscotch .hljs-addition{color:#8fc13e}.hljs-hopscotch .hljs-meta{color:#149b93}.hljs-hopscotch .hljs-function,.hljs-hopscotch .hljs-section,.hljs-hopscotch .hljs-title{color:#1290bf}.hljs-hopscotch .hljs-keyword,.hljs-hopscotch .hljs-selector-tag{color:#c85e7c}.hljs-hopscotch .hljs{display:block;background:#322931;color:#b9b5b8;padding:.5em}.hljs-hopscotch .hljs-emphasis{font-style:italic}.hljs-hopscotch .hljs-strong{font-weight:bold}.hljs-hybrid .hljs{display:block;overflow-x:auto;padding:.5em;background:#1d1f21}.hljs-hybrid .hljs::selection,.hljs-hybrid .hljs span::selection{background:#373b41}.hljs-hybrid .hljs::-moz-selection,.hljs-hybrid .hljs span::-moz-selection{background:#373b41}.hljs-hybrid .hljs{color:#c5c8c6}.hljs-hybrid .hljs-title,.hljs-hybrid .hljs-name{color:#f0c674}.hljs-hybrid .hljs-comment,.hljs-hybrid .hljs-meta,.hljs-hybrid .hljs-meta .hljs-keyword{color:#707880}.hljs-hybrid .hljs-number,.hljs-hybrid .hljs-symbol,.hljs-hybrid .hljs-literal,.hljs-hybrid .hljs-deletion,.hljs-hybrid .hljs-link{color:#cc6666}.hljs-hybrid .hljs-string,.hljs-hybrid .hljs-doctag,.hljs-hybrid .hljs-addition,.hljs-hybrid .hljs-regexp,.hljs-hybrid .hljs-selector-attr,.hljs-hybrid .hljs-selector-pseudo{color:#b5bd68}.hljs-hybrid .hljs-attribute,.hljs-hybrid .hljs-code,.hljs-hybrid .hljs-selector-id{color:#b294bb}.hljs-hybrid .hljs-keyword,.hljs-hybrid .hljs-selector-tag,.hljs-hybrid .hljs-bullet,.hljs-hybrid .hljs-tag{color:#81a2be}.hljs-hybrid .hljs-subst,.hljs-hybrid .hljs-variable,.hljs-hybrid .hljs-template-tag,.hljs-hybrid .hljs-template-variable{color:#8abeb7}.hljs-hybrid .hljs-type,.hljs-hybrid .hljs-built_in,.hljs-hybrid .hljs-builtin-name,.hljs-hybrid .hljs-quote,.hljs-hybrid .hljs-section,.hljs-hybrid .hljs-selector-class{color:#de935f}.hljs-hybrid .hljs-emphasis{font-style:italic}.hljs-hybrid .hljs-strong{font-weight:bold}.hljs-idea .hljs{display:block;overflow-x:auto;padding:.5em;color:#000;background:#fff}.hljs-idea .hljs-subst,.hljs-idea .hljs-title{font-weight:normal;color:#000}.hljs-idea .hljs-comment,.hljs-idea .hljs-quote{color:#808080;font-style:italic}.hljs-idea .hljs-meta{color:#808000}.hljs-idea .hljs-tag{background:#efefef}.hljs-idea .hljs-section,.hljs-idea .hljs-name,.hljs-idea .hljs-literal,.hljs-idea .hljs-keyword,.hljs-idea .hljs-selector-tag,.hljs-idea .hljs-type,.hljs-idea .hljs-selector-id,.hljs-idea .hljs-selector-class{font-weight:bold;color:#000080}.hljs-idea .hljs-attribute,.hljs-idea .hljs-number,.hljs-idea .hljs-regexp,.hljs-idea .hljs-link{font-weight:bold;color:#0000ff}.hljs-idea .hljs-number,.hljs-idea .hljs-regexp,.hljs-idea .hljs-link{font-weight:normal}.hljs-idea .hljs-string{color:#008000;font-weight:bold}.hljs-idea .hljs-symbol,.hljs-idea .hljs-bullet,.hljs-idea .hljs-formula{color:#000;background:#d0eded;font-style:italic}.hljs-idea .hljs-doctag{text-decoration:underline}.hljs-idea .hljs-variable,.hljs-idea .hljs-template-variable{color:#660e7a}.hljs-idea .hljs-addition{background:#baeeba}.hljs-idea .hljs-deletion{background:#ffc8bd}.hljs-idea .hljs-emphasis{font-style:italic}.hljs-idea .hljs-strong{font-weight:bold}.hljs-ir-black .hljs{display:block;overflow-x:auto;padding:.5em;background:#000;color:#f8f8f8}.hljs-ir-black .hljs-comment,.hljs-ir-black .hljs-quote,.hljs-ir-black .hljs-meta{color:#7c7c7c}.hljs-ir-black .hljs-keyword,.hljs-ir-black .hljs-selector-tag,.hljs-ir-black .hljs-tag,.hljs-ir-black .hljs-name{color:#96cbfe}.hljs-ir-black .hljs-attribute,.hljs-ir-black .hljs-selector-id{color:#ffffb6}.hljs-ir-black .hljs-string,.hljs-ir-black .hljs-selector-attr,.hljs-ir-black .hljs-selector-pseudo,.hljs-ir-black .hljs-addition{color:#a8ff60}.hljs-ir-black .hljs-subst{color:#daefa3}.hljs-ir-black .hljs-regexp,.hljs-ir-black .hljs-link{color:#e9c062}.hljs-ir-black .hljs-title,.hljs-ir-black .hljs-section,.hljs-ir-black .hljs-type,.hljs-ir-black .hljs-doctag{color:#ffffb6}.hljs-ir-black .hljs-symbol,.hljs-ir-black .hljs-bullet,.hljs-ir-black .hljs-variable,.hljs-ir-black .hljs-template-variable,.hljs-ir-black .hljs-literal{color:#c6c5fe}.hljs-ir-black .hljs-number,.hljs-ir-black .hljs-deletion{color:#ff73fd}.hljs-ir-black .hljs-emphasis{font-style:italic}.hljs-ir-black .hljs-strong{font-weight:bold}.hljs-kimbie.dark .hljs-comment,.hljs-kimbie.dark .hljs-quote{color:#d6baad}.hljs-kimbie.dark .hljs-variable,.hljs-kimbie.dark .hljs-template-variable,.hljs-kimbie.dark .hljs-tag,.hljs-kimbie.dark .hljs-name,.hljs-kimbie.dark .hljs-selector-id,.hljs-kimbie.dark .hljs-selector-class,.hljs-kimbie.dark .hljs-regexp,.hljs-kimbie.dark .hljs-meta{color:#dc3958}.hljs-kimbie.dark .hljs-number,.hljs-kimbie.dark .hljs-built_in,.hljs-kimbie.dark .hljs-builtin-name,.hljs-kimbie.dark .hljs-literal,.hljs-kimbie.dark .hljs-type,.hljs-kimbie.dark .hljs-params,.hljs-kimbie.dark .hljs-deletion,.hljs-kimbie.dark .hljs-link{color:#f79a32}.hljs-kimbie.dark .hljs-title,.hljs-kimbie.dark .hljs-section,.hljs-kimbie.dark .hljs-attribute{color:#f06431}.hljs-kimbie.dark .hljs-string,.hljs-kimbie.dark .hljs-symbol,.hljs-kimbie.dark .hljs-bullet,.hljs-kimbie.dark .hljs-addition{color:#889b4a}.hljs-kimbie.dark .hljs-keyword,.hljs-kimbie.dark .hljs-selector-tag,.hljs-kimbie.dark .hljs-function{color:#98676a}.hljs-kimbie.dark .hljs{display:block;overflow-x:auto;background:#221a0f;color:#d3af86;padding:.5em}.hljs-kimbie.dark .hljs-emphasis{font-style:italic}.hljs-kimbie.dark .hljs-strong{font-weight:bold}.hljs-kimbie.light .hljs-comment,.hljs-kimbie.light .hljs-quote{color:#a57a4c}.hljs-kimbie.light .hljs-variable,.hljs-kimbie.light .hljs-template-variable,.hljs-kimbie.light .hljs-tag,.hljs-kimbie.light .hljs-name,.hljs-kimbie.light .hljs-selector-id,.hljs-kimbie.light .hljs-selector-class,.hljs-kimbie.light .hljs-regexp,.hljs-kimbie.light .hljs-meta{color:#dc3958}.hljs-kimbie.light .hljs-number,.hljs-kimbie.light .hljs-built_in,.hljs-kimbie.light .hljs-builtin-name,.hljs-kimbie.light .hljs-literal,.hljs-kimbie.light .hljs-type,.hljs-kimbie.light .hljs-params,.hljs-kimbie.light .hljs-deletion,.hljs-kimbie.light .hljs-link{color:#f79a32}.hljs-kimbie.light .hljs-title,.hljs-kimbie.light .hljs-section,.hljs-kimbie.light .hljs-attribute{color:#f06431}.hljs-kimbie.light .hljs-string,.hljs-kimbie.light .hljs-symbol,.hljs-kimbie.light .hljs-bullet,.hljs-kimbie.light .hljs-addition{color:#889b4a}.hljs-kimbie.light .hljs-keyword,.hljs-kimbie.light .hljs-selector-tag,.hljs-kimbie.light .hljs-function{color:#98676a}.hljs-kimbie.light .hljs{display:block;overflow-x:auto;background:#fbebd4;color:#84613d;padding:.5em}.hljs-kimbie.light .hljs-emphasis{font-style:italic}.hljs-kimbie.light .hljs-strong{font-weight:bold}.hljs-magula .hljs{display:block;overflow-x:auto;padding:.5em;background-color:#f4f4f4}.hljs-magula .hljs,.hljs-magula .hljs-subst{color:black}.hljs-magula .hljs-string,.hljs-magula .hljs-title,.hljs-magula .hljs-symbol,.hljs-magula .hljs-bullet,.hljs-magula .hljs-attribute,.hljs-magula .hljs-addition,.hljs-magula .hljs-variable,.hljs-magula .hljs-template-tag,.hljs-magula .hljs-template-variable{color:#050}.hljs-magula .hljs-comment,.hljs-magula .hljs-quote{color:#777}.hljs-magula .hljs-number,.hljs-magula .hljs-regexp,.hljs-magula .hljs-literal,.hljs-magula .hljs-type,.hljs-magula .hljs-link{color:#800}.hljs-magula .hljs-deletion,.hljs-magula .hljs-meta{color:#00e}.hljs-magula .hljs-keyword,.hljs-magula .hljs-selector-tag,.hljs-magula .hljs-doctag,.hljs-magula .hljs-title,.hljs-magula .hljs-section,.hljs-magula .hljs-built_in,.hljs-magula .hljs-tag,.hljs-magula .hljs-name{font-weight:bold;color:navy}.hljs-magula .hljs-emphasis{font-style:italic}.hljs-magula .hljs-strong{font-weight:bold}.hljs-mono-blue .hljs{display:block;overflow-x:auto;padding:.5em;background:#eaeef3}.hljs-mono-blue .hljs{color:#00193a}.hljs-mono-blue .hljs-keyword,.hljs-mono-blue .hljs-selector-tag,.hljs-mono-blue .hljs-title,.hljs-mono-blue .hljs-section,.hljs-mono-blue .hljs-doctag,.hljs-mono-blue .hljs-name,.hljs-mono-blue .hljs-strong{font-weight:bold}.hljs-mono-blue .hljs-comment{color:#738191}.hljs-mono-blue .hljs-string,.hljs-mono-blue .hljs-title,.hljs-mono-blue .hljs-section,.hljs-mono-blue .hljs-built_in,.hljs-mono-blue .hljs-literal,.hljs-mono-blue .hljs-type,.hljs-mono-blue .hljs-addition,.hljs-mono-blue .hljs-tag,.hljs-mono-blue .hljs-quote,.hljs-mono-blue .hljs-name,.hljs-mono-blue .hljs-selector-id,.hljs-mono-blue .hljs-selector-class{color:#0048ab}.hljs-mono-blue .hljs-meta,.hljs-mono-blue .hljs-subst,.hljs-mono-blue .hljs-symbol,.hljs-mono-blue .hljs-regexp,.hljs-mono-blue .hljs-attribute,.hljs-mono-blue .hljs-deletion,.hljs-mono-blue .hljs-variable,.hljs-mono-blue .hljs-template-variable,.hljs-mono-blue .hljs-link,.hljs-mono-blue .hljs-bullet{color:#4c81c9}.hljs-mono-blue .hljs-emphasis{font-style:italic}.hljs-monokai-sublime .hljs{display:block;overflow-x:auto;padding:.5em;background:#23241f}.hljs-monokai-sublime .hljs,.hljs-monokai-sublime .hljs-tag,.hljs-monokai-sublime .hljs-subst{color:#f8f8f2}.hljs-monokai-sublime .hljs-strong,.hljs-monokai-sublime .hljs-emphasis{color:#a8a8a2}.hljs-monokai-sublime .hljs-bullet,.hljs-monokai-sublime .hljs-quote,.hljs-monokai-sublime .hljs-number,.hljs-monokai-sublime .hljs-regexp,.hljs-monokai-sublime .hljs-literal,.hljs-monokai-sublime .hljs-link{color:#ae81ff}.hljs-monokai-sublime .hljs-code,.hljs-monokai-sublime .hljs-title,.hljs-monokai-sublime .hljs-section,.hljs-monokai-sublime .hljs-selector-class{color:#a6e22e}.hljs-monokai-sublime .hljs-strong{font-weight:bold}.hljs-monokai-sublime .hljs-emphasis{font-style:italic}.hljs-monokai-sublime .hljs-keyword,.hljs-monokai-sublime .hljs-selector-tag,.hljs-monokai-sublime .hljs-name,.hljs-monokai-sublime .hljs-attr{color:#f92672}.hljs-monokai-sublime .hljs-symbol,.hljs-monokai-sublime .hljs-attribute{color:#66d9ef}.hljs-monokai-sublime .hljs-params,.hljs-monokai-sublime .hljs-class .hljs-title{color:#f8f8f2}.hljs-monokai-sublime .hljs-string,.hljs-monokai-sublime .hljs-type,.hljs-monokai-sublime .hljs-built_in,.hljs-monokai-sublime .hljs-builtin-name,.hljs-monokai-sublime .hljs-selector-id,.hljs-monokai-sublime .hljs-selector-attr,.hljs-monokai-sublime .hljs-selector-pseudo,.hljs-monokai-sublime .hljs-addition,.hljs-monokai-sublime .hljs-variable,.hljs-monokai-sublime .hljs-template-variable{color:#e6db74}.hljs-monokai-sublime .hljs-comment,.hljs-monokai-sublime .hljs-deletion,.hljs-monokai-sublime .hljs-meta{color:#75715e}.hljs-monokai .hljs{display:block;overflow-x:auto;padding:.5em;background:#272822;color:#ddd}.hljs-monokai .hljs-tag,.hljs-monokai .hljs-keyword,.hljs-monokai .hljs-selector-tag,.hljs-monokai .hljs-literal,.hljs-monokai .hljs-strong,.hljs-monokai .hljs-name{color:#f92672}.hljs-monokai .hljs-code{color:#66d9ef}.hljs-monokai .hljs-class .hljs-title{color:white}.hljs-monokai .hljs-attribute,.hljs-monokai .hljs-symbol,.hljs-monokai .hljs-regexp,.hljs-monokai .hljs-link{color:#bf79db}.hljs-monokai .hljs-string,.hljs-monokai .hljs-bullet,.hljs-monokai .hljs-subst,.hljs-monokai .hljs-title,.hljs-monokai .hljs-section,.hljs-monokai .hljs-emphasis,.hljs-monokai .hljs-type,.hljs-monokai .hljs-built_in,.hljs-monokai .hljs-builtin-name,.hljs-monokai .hljs-selector-attr,.hljs-monokai .hljs-selector-pseudo,.hljs-monokai .hljs-addition,.hljs-monokai .hljs-variable,.hljs-monokai .hljs-template-tag,.hljs-monokai .hljs-template-variable{color:#a6e22e}.hljs-monokai .hljs-comment,.hljs-monokai .hljs-quote,.hljs-monokai .hljs-deletion,.hljs-monokai .hljs-meta{color:#75715e}.hljs-monokai .hljs-keyword,.hljs-monokai .hljs-selector-tag,.hljs-monokai .hljs-literal,.hljs-monokai .hljs-doctag,.hljs-monokai .hljs-title,.hljs-monokai .hljs-section,.hljs-monokai .hljs-type,.hljs-monokai .hljs-selector-id{font-weight:bold}.hljs-obsidian .hljs{display:block;overflow-x:auto;padding:.5em;background:#282b2e}.hljs-obsidian .hljs-keyword,.hljs-obsidian .hljs-selector-tag,.hljs-obsidian .hljs-literal,.hljs-obsidian .hljs-selector-id{color:#93c763}.hljs-obsidian .hljs-number{color:#ffcd22}.hljs-obsidian .hljs{color:#e0e2e4}.hljs-obsidian .hljs-attribute{color:#668bb0}.hljs-obsidian .hljs-code,.hljs-obsidian .hljs-class .hljs-title,.hljs-obsidian .hljs-section{color:white}.hljs-obsidian .hljs-regexp,.hljs-obsidian .hljs-link{color:#d39745}.hljs-obsidian .hljs-meta{color:#557182}.hljs-obsidian .hljs-tag,.hljs-obsidian .hljs-name,.hljs-obsidian .hljs-bullet,.hljs-obsidian .hljs-subst,.hljs-obsidian .hljs-emphasis,.hljs-obsidian .hljs-type,.hljs-obsidian .hljs-built_in,.hljs-obsidian .hljs-selector-attr,.hljs-obsidian .hljs-selector-pseudo,.hljs-obsidian .hljs-addition,.hljs-obsidian .hljs-variable,.hljs-obsidian .hljs-template-tag,.hljs-obsidian .hljs-template-variable{color:#8cbbad}.hljs-obsidian .hljs-string,.hljs-obsidian .hljs-symbol{color:#ec7600}.hljs-obsidian .hljs-comment,.hljs-obsidian .hljs-quote,.hljs-obsidian .hljs-deletion{color:#818e96}.hljs-obsidian .hljs-selector-class{color:#A082BD}.hljs-obsidian .hljs-keyword,.hljs-obsidian .hljs-selector-tag,.hljs-obsidian .hljs-literal,.hljs-obsidian .hljs-doctag,.hljs-obsidian .hljs-title,.hljs-obsidian .hljs-section,.hljs-obsidian .hljs-type,.hljs-obsidian .hljs-name,.hljs-obsidian .hljs-strong{font-weight:bold}.hljs-ocean .hljs-comment,.hljs-ocean .hljs-quote{color:#65737e}.hljs-ocean .hljs-variable,.hljs-ocean .hljs-template-variable,.hljs-ocean .hljs-tag,.hljs-ocean .hljs-name,.hljs-ocean .hljs-selector-id,.hljs-ocean .hljs-selector-class,.hljs-ocean .hljs-regexp,.hljs-ocean .hljs-deletion{color:#bf616a}.hljs-ocean .hljs-number,.hljs-ocean .hljs-built_in,.hljs-ocean .hljs-builtin-name,.hljs-ocean .hljs-literal,.hljs-ocean .hljs-type,.hljs-ocean .hljs-params,.hljs-ocean .hljs-meta,.hljs-ocean .hljs-link{color:#d08770}.hljs-ocean .hljs-attribute{color:#ebcb8b}.hljs-ocean .hljs-string,.hljs-ocean .hljs-symbol,.hljs-ocean .hljs-bullet,.hljs-ocean .hljs-addition{color:#a3be8c}.hljs-ocean .hljs-title,.hljs-ocean .hljs-section{color:#8fa1b3}.hljs-ocean .hljs-keyword,.hljs-ocean .hljs-selector-tag{color:#b48ead}.hljs-ocean .hljs{display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:.5em}.hljs-ocean .hljs-emphasis{font-style:italic}.hljs-ocean .hljs-strong{font-weight:bold}.hljs-paraiso-dark .hljs-comment,.hljs-paraiso-dark .hljs-quote{color:#8d8687}.hljs-paraiso-dark .hljs-variable,.hljs-paraiso-dark .hljs-template-variable,.hljs-paraiso-dark .hljs-tag,.hljs-paraiso-dark .hljs-name,.hljs-paraiso-dark .hljs-selector-id,.hljs-paraiso-dark .hljs-selector-class,.hljs-paraiso-dark .hljs-regexp,.hljs-paraiso-dark .hljs-link,.hljs-paraiso-dark .hljs-meta{color:#ef6155}.hljs-paraiso-dark .hljs-number,.hljs-paraiso-dark .hljs-built_in,.hljs-paraiso-dark .hljs-builtin-name,.hljs-paraiso-dark .hljs-literal,.hljs-paraiso-dark .hljs-type,.hljs-paraiso-dark .hljs-params,.hljs-paraiso-dark .hljs-deletion{color:#f99b15}.hljs-paraiso-dark .hljs-title,.hljs-paraiso-dark .hljs-section,.hljs-paraiso-dark .hljs-attribute{color:#fec418}.hljs-paraiso-dark .hljs-string,.hljs-paraiso-dark .hljs-symbol,.hljs-paraiso-dark .hljs-bullet,.hljs-paraiso-dark .hljs-addition{color:#48b685}.hljs-paraiso-dark .hljs-keyword,.hljs-paraiso-dark .hljs-selector-tag{color:#815ba4}.hljs-paraiso-dark .hljs{display:block;overflow-x:auto;background:#2f1e2e;color:#a39e9b;padding:.5em}.hljs-paraiso-dark .hljs-emphasis{font-style:italic}.hljs-paraiso-dark .hljs-strong{font-weight:bold}.hljs-paraiso-light .hljs-comment,.hljs-paraiso-light .hljs-quote{color:#776e71}.hljs-paraiso-light .hljs-variable,.hljs-paraiso-light .hljs-template-variable,.hljs-paraiso-light .hljs-tag,.hljs-paraiso-light .hljs-name,.hljs-paraiso-light .hljs-selector-id,.hljs-paraiso-light .hljs-selector-class,.hljs-paraiso-light .hljs-regexp,.hljs-paraiso-light .hljs-link,.hljs-paraiso-light .hljs-meta{color:#ef6155}.hljs-paraiso-light .hljs-number,.hljs-paraiso-light .hljs-built_in,.hljs-paraiso-light .hljs-builtin-name,.hljs-paraiso-light .hljs-literal,.hljs-paraiso-light .hljs-type,.hljs-paraiso-light .hljs-params,.hljs-paraiso-light .hljs-deletion{color:#f99b15}.hljs-paraiso-light .hljs-title,.hljs-paraiso-light .hljs-section,.hljs-paraiso-light .hljs-attribute{color:#fec418}.hljs-paraiso-light .hljs-string,.hljs-paraiso-light .hljs-symbol,.hljs-paraiso-light .hljs-bullet,.hljs-paraiso-light .hljs-addition{color:#48b685}.hljs-paraiso-light .hljs-keyword,.hljs-paraiso-light .hljs-selector-tag{color:#815ba4}.hljs-paraiso-light .hljs{display:block;overflow-x:auto;background:#e7e9db;color:#4f424c;padding:.5em}.hljs-paraiso-light .hljs-emphasis{font-style:italic}.hljs-paraiso-light .hljs-strong{font-weight:bold}.hljs-purebasic .hljs{display:block;overflow-x:auto;padding:.5em;background:#FFFFDF}.hljs-purebasic .hljs,.hljs-purebasic .hljs-type,.hljs-purebasic .hljs-function,.hljs-purebasic .hljs-name,.hljs-purebasic .hljs-number,.hljs-purebasic .hljs-attr,.hljs-purebasic .hljs-params,.hljs-purebasic .hljs-subst{color:#000000}.hljs-purebasic .hljs-comment,.hljs-purebasic .hljs-regexp,.hljs-purebasic .hljs-section,.hljs-purebasic .hljs-selector-pseudo,.hljs-purebasic .hljs-addition{color:#00AAAA}.hljs-purebasic .hljs-title,.hljs-purebasic .hljs-tag,.hljs-purebasic .hljs-variable,.hljs-purebasic .hljs-code{color:#006666}.hljs-purebasic .hljs-keyword,.hljs-purebasic .hljs-class,.hljs-purebasic .hljs-meta-keyword,.hljs-purebasic .hljs-selector-class,.hljs-purebasic .hljs-built_in,.hljs-purebasic .hljs-builtin-name{color:#006666;font-weight:bold}.hljs-purebasic .hljs-string,.hljs-purebasic .hljs-selector-attr{color:#0080FF}.hljs-purebasic .hljs-symbol,.hljs-purebasic .hljs-link,.hljs-purebasic .hljs-deletion,.hljs-purebasic .hljs-attribute{color:#924B72}.hljs-purebasic .hljs-meta,.hljs-purebasic .hljs-literal,.hljs-purebasic .hljs-selector-id{color:#924B72;font-weight:bold}.hljs-purebasic .hljs-strong,.hljs-purebasic .hljs-name{font-weight:bold}.hljs-purebasic .hljs-emphasis{font-style:italic}.hljs-qtcreator_dark .hljs{display:block;overflow-x:auto;padding:.5em;background:#000000}.hljs-qtcreator_dark .hljs,.hljs-qtcreator_dark .hljs-subst,.hljs-qtcreator_dark .hljs-tag,.hljs-qtcreator_dark .hljs-title{color:#aaaaaa}.hljs-qtcreator_dark .hljs-strong,.hljs-qtcreator_dark .hljs-emphasis{color:#a8a8a2}.hljs-qtcreator_dark .hljs-bullet,.hljs-qtcreator_dark .hljs-quote,.hljs-qtcreator_dark .hljs-number,.hljs-qtcreator_dark .hljs-regexp,.hljs-qtcreator_dark .hljs-literal{color:#ff55ff}.hljs-qtcreator_dark .hljs-code .hljs-selector-class{color:#aaaaff}.hljs-qtcreator_dark .hljs-emphasis,.hljs-qtcreator_dark .hljs-stronge,.hljs-qtcreator_dark .hljs-type{font-style:italic}.hljs-qtcreator_dark .hljs-keyword,.hljs-qtcreator_dark .hljs-selector-tag,.hljs-qtcreator_dark .hljs-function,.hljs-qtcreator_dark .hljs-section,.hljs-qtcreator_dark .hljs-symbol,.hljs-qtcreator_dark .hljs-name{color:#ffff55}.hljs-qtcreator_dark .hljs-attribute{color:#ff5555}.hljs-qtcreator_dark .hljs-variable,.hljs-qtcreator_dark .hljs-params,.hljs-qtcreator_dark .hljs-class .hljs-title{color:#8888ff}.hljs-qtcreator_dark .hljs-string,.hljs-qtcreator_dark .hljs-selector-id,.hljs-qtcreator_dark .hljs-selector-attr,.hljs-qtcreator_dark .hljs-selector-pseudo,.hljs-qtcreator_dark .hljs-type,.hljs-qtcreator_dark .hljs-built_in,.hljs-qtcreator_dark .hljs-builtin-name,.hljs-qtcreator_dark .hljs-template-tag,.hljs-qtcreator_dark .hljs-template-variable,.hljs-qtcreator_dark .hljs-addition,.hljs-qtcreator_dark .hljs-link{color:#ff55ff}.hljs-qtcreator_dark .hljs-comment,.hljs-qtcreator_dark .hljs-meta,.hljs-qtcreator_dark .hljs-deletion{color:#55ffff}.hljs-qtcreator_light .hljs{display:block;overflow-x:auto;padding:.5em;background:#ffffff}.hljs-qtcreator_light .hljs,.hljs-qtcreator_light .hljs-subst,.hljs-qtcreator_light .hljs-tag,.hljs-qtcreator_light .hljs-title{color:#000000}.hljs-qtcreator_light .hljs-strong,.hljs-qtcreator_light .hljs-emphasis{color:#000000}.hljs-qtcreator_light .hljs-bullet,.hljs-qtcreator_light .hljs-quote,.hljs-qtcreator_light .hljs-number,.hljs-qtcreator_light .hljs-regexp,.hljs-qtcreator_light .hljs-literal{color:#000080}.hljs-qtcreator_light .hljs-code .hljs-selector-class{color:#800080}.hljs-qtcreator_light .hljs-emphasis,.hljs-qtcreator_light .hljs-stronge,.hljs-qtcreator_light .hljs-type{font-style:italic}.hljs-qtcreator_light .hljs-keyword,.hljs-qtcreator_light .hljs-selector-tag,.hljs-qtcreator_light .hljs-function,.hljs-qtcreator_light .hljs-section,.hljs-qtcreator_light .hljs-symbol,.hljs-qtcreator_light .hljs-name{color:#808000}.hljs-qtcreator_light .hljs-attribute{color:#800000}.hljs-qtcreator_light .hljs-variable,.hljs-qtcreator_light .hljs-params,.hljs-qtcreator_light .hljs-class .hljs-title{color:#0055AF}.hljs-qtcreator_light .hljs-string,.hljs-qtcreator_light .hljs-selector-id,.hljs-qtcreator_light .hljs-selector-attr,.hljs-qtcreator_light .hljs-selector-pseudo,.hljs-qtcreator_light .hljs-type,.hljs-qtcreator_light .hljs-built_in,.hljs-qtcreator_light .hljs-builtin-name,.hljs-qtcreator_light .hljs-template-tag,.hljs-qtcreator_light .hljs-template-variable,.hljs-qtcreator_light .hljs-addition,.hljs-qtcreator_light .hljs-link{color:#008000}.hljs-qtcreator_light .hljs-comment,.hljs-qtcreator_light .hljs-meta,.hljs-qtcreator_light .hljs-deletion{color:#008000}.hljs-railscasts .hljs{display:block;overflow-x:auto;padding:.5em;background:#232323;color:#e6e1dc}.hljs-railscasts .hljs-comment,.hljs-railscasts .hljs-quote{color:#bc9458;font-style:italic}.hljs-railscasts .hljs-keyword,.hljs-railscasts .hljs-selector-tag{color:#c26230}.hljs-railscasts .hljs-string,.hljs-railscasts .hljs-number,.hljs-railscasts .hljs-regexp,.hljs-railscasts .hljs-variable,.hljs-railscasts .hljs-template-variable{color:#a5c261}.hljs-railscasts .hljs-subst{color:#519f50}.hljs-railscasts .hljs-tag,.hljs-railscasts .hljs-name{color:#e8bf6a}.hljs-railscasts .hljs-type{color:#da4939}.hljs-railscasts .hljs-symbol,.hljs-railscasts .hljs-bullet,.hljs-railscasts .hljs-built_in,.hljs-railscasts .hljs-builtin-name,.hljs-railscasts .hljs-attr,.hljs-railscasts .hljs-link{color:#6d9cbe}.hljs-railscasts .hljs-params{color:#d0d0ff}.hljs-railscasts .hljs-attribute{color:#cda869}.hljs-railscasts .hljs-meta{color:#9b859d}.hljs-railscasts .hljs-title,.hljs-railscasts .hljs-section{color:#ffc66d}.hljs-railscasts .hljs-addition{background-color:#144212;color:#e6e1dc;display:inline-block;width:100%}.hljs-railscasts .hljs-deletion{background-color:#600;color:#e6e1dc;display:inline-block;width:100%}.hljs-railscasts .hljs-selector-class{color:#9b703f}.hljs-railscasts .hljs-selector-id{color:#8b98ab}.hljs-railscasts .hljs-emphasis{font-style:italic}.hljs-railscasts .hljs-strong{font-weight:bold}.hljs-railscasts .hljs-link{text-decoration:underline}.hljs-rainbow .hljs{display:block;overflow-x:auto;padding:.5em;background:#474949;color:#d1d9e1}.hljs-rainbow .hljs-comment,.hljs-rainbow .hljs-quote{color:#969896;font-style:italic}.hljs-rainbow .hljs-keyword,.hljs-rainbow .hljs-selector-tag,.hljs-rainbow .hljs-literal,.hljs-rainbow .hljs-type,.hljs-rainbow .hljs-addition{color:#cc99cc}.hljs-rainbow .hljs-number,.hljs-rainbow .hljs-selector-attr,.hljs-rainbow .hljs-selector-pseudo{color:#f99157}.hljs-rainbow .hljs-string,.hljs-rainbow .hljs-doctag,.hljs-rainbow .hljs-regexp{color:#8abeb7}.hljs-rainbow .hljs-title,.hljs-rainbow .hljs-name,.hljs-rainbow .hljs-section,.hljs-rainbow .hljs-built_in{color:#b5bd68}.hljs-rainbow .hljs-variable,.hljs-rainbow .hljs-template-variable,.hljs-rainbow .hljs-selector-id,.hljs-rainbow .hljs-class .hljs-title{color:#ffcc66}.hljs-rainbow .hljs-section,.hljs-rainbow .hljs-name,.hljs-rainbow .hljs-strong{font-weight:bold}.hljs-rainbow .hljs-symbol,.hljs-rainbow .hljs-bullet,.hljs-rainbow .hljs-subst,.hljs-rainbow .hljs-meta,.hljs-rainbow .hljs-link{color:#f99157}.hljs-rainbow .hljs-deletion{color:#dc322f}.hljs-rainbow .hljs-formula{background:#eee8d5}.hljs-rainbow .hljs-attr,.hljs-rainbow .hljs-attribute{color:#81a2be}.hljs-rainbow .hljs-emphasis{font-style:italic}.hljs-school-book .hljs{display:block;overflow-x:auto;padding:15px .5em .5em 30px;font-size:11px;line-height:16px}.hljs-school-book pre{background:#f6f6ae url(school-book.png);border-top:solid 2px #d2e8b9;border-bottom:solid 1px #d2e8b9}.hljs-school-book .hljs-keyword,.hljs-school-book .hljs-selector-tag,.hljs-school-book .hljs-literal{color:#005599;font-weight:bold}.hljs-school-book .hljs,.hljs-school-book .hljs-subst{color:#3e5915}.hljs-school-book .hljs-string,.hljs-school-book .hljs-title,.hljs-school-book .hljs-section,.hljs-school-book .hljs-type,.hljs-school-book .hljs-symbol,.hljs-school-book .hljs-bullet,.hljs-school-book .hljs-attribute,.hljs-school-book .hljs-built_in,.hljs-school-book .hljs-builtin-name,.hljs-school-book .hljs-addition,.hljs-school-book .hljs-variable,.hljs-school-book .hljs-template-tag,.hljs-school-book .hljs-template-variable,.hljs-school-book .hljs-link{color:#2c009f}.hljs-school-book .hljs-comment,.hljs-school-book .hljs-quote,.hljs-school-book .hljs-deletion,.hljs-school-book .hljs-meta{color:#e60415}.hljs-school-book .hljs-keyword,.hljs-school-book .hljs-selector-tag,.hljs-school-book .hljs-literal,.hljs-school-book .hljs-doctag,.hljs-school-book .hljs-title,.hljs-school-book .hljs-section,.hljs-school-book .hljs-type,.hljs-school-book .hljs-name,.hljs-school-book .hljs-selector-id,.hljs-school-book .hljs-strong{font-weight:bold}.hljs-school-book .hljs-emphasis{font-style:italic}.hljs-solarized-dark .hljs{display:block;overflow-x:auto;padding:.5em;background:#002b36;color:#839496}.hljs-solarized-dark .hljs-comment,.hljs-solarized-dark .hljs-quote{color:#586e75}.hljs-solarized-dark .hljs-keyword,.hljs-solarized-dark .hljs-selector-tag,.hljs-solarized-dark .hljs-addition{color:#859900}.hljs-solarized-dark .hljs-number,.hljs-solarized-dark .hljs-string,.hljs-solarized-dark .hljs-meta .hljs-meta-string,.hljs-solarized-dark .hljs-literal,.hljs-solarized-dark .hljs-doctag,.hljs-solarized-dark .hljs-regexp{color:#2aa198}.hljs-solarized-dark .hljs-title,.hljs-solarized-dark .hljs-section,.hljs-solarized-dark .hljs-name,.hljs-solarized-dark .hljs-selector-id,.hljs-solarized-dark .hljs-selector-class{color:#268bd2}.hljs-solarized-dark .hljs-attribute,.hljs-solarized-dark .hljs-attr,.hljs-solarized-dark .hljs-variable,.hljs-solarized-dark .hljs-template-variable,.hljs-solarized-dark .hljs-class .hljs-title,.hljs-solarized-dark .hljs-type{color:#b58900}.hljs-solarized-dark .hljs-symbol,.hljs-solarized-dark .hljs-bullet,.hljs-solarized-dark .hljs-subst,.hljs-solarized-dark .hljs-meta,.hljs-solarized-dark .hljs-meta .hljs-keyword,.hljs-solarized-dark .hljs-selector-attr,.hljs-solarized-dark .hljs-selector-pseudo,.hljs-solarized-dark .hljs-link{color:#cb4b16}.hljs-solarized-dark .hljs-built_in,.hljs-solarized-dark .hljs-deletion{color:#dc322f}.hljs-solarized-dark .hljs-formula{background:#073642}.hljs-solarized-dark .hljs-emphasis{font-style:italic}.hljs-solarized-dark .hljs-strong{font-weight:bold}.hljs-solarized-light .hljs{display:block;overflow-x:auto;padding:.5em;background:#fdf6e3;color:#657b83}.hljs-solarized-light .hljs-comment,.hljs-solarized-light .hljs-quote{color:#93a1a1}.hljs-solarized-light .hljs-keyword,.hljs-solarized-light .hljs-selector-tag,.hljs-solarized-light .hljs-addition{color:#859900}.hljs-solarized-light .hljs-number,.hljs-solarized-light .hljs-string,.hljs-solarized-light .hljs-meta .hljs-meta-string,.hljs-solarized-light .hljs-literal,.hljs-solarized-light .hljs-doctag,.hljs-solarized-light .hljs-regexp{color:#2aa198}.hljs-solarized-light .hljs-title,.hljs-solarized-light .hljs-section,.hljs-solarized-light .hljs-name,.hljs-solarized-light .hljs-selector-id,.hljs-solarized-light .hljs-selector-class{color:#268bd2}.hljs-solarized-light .hljs-attribute,.hljs-solarized-light .hljs-attr,.hljs-solarized-light .hljs-variable,.hljs-solarized-light .hljs-template-variable,.hljs-solarized-light .hljs-class .hljs-title,.hljs-solarized-light .hljs-type{color:#b58900}.hljs-solarized-light .hljs-symbol,.hljs-solarized-light .hljs-bullet,.hljs-solarized-light .hljs-subst,.hljs-solarized-light .hljs-meta,.hljs-solarized-light .hljs-meta .hljs-keyword,.hljs-solarized-light .hljs-selector-attr,.hljs-solarized-light .hljs-selector-pseudo,.hljs-solarized-light .hljs-link{color:#cb4b16}.hljs-solarized-light .hljs-built_in,.hljs-solarized-light .hljs-deletion{color:#dc322f}.hljs-solarized-light .hljs-formula{background:#eee8d5}.hljs-solarized-light .hljs-emphasis{font-style:italic}.hljs-solarized-light .hljs-strong{font-weight:bold}.hljs-sunburst .hljs{display:block;overflow-x:auto;padding:.5em;background:#000;color:#f8f8f8}.hljs-sunburst .hljs-comment,.hljs-sunburst .hljs-quote{color:#aeaeae;font-style:italic}.hljs-sunburst .hljs-keyword,.hljs-sunburst .hljs-selector-tag,.hljs-sunburst .hljs-type{color:#e28964}.hljs-sunburst .hljs-string{color:#65b042}.hljs-sunburst .hljs-subst{color:#daefa3}.hljs-sunburst .hljs-regexp,.hljs-sunburst .hljs-link{color:#e9c062}.hljs-sunburst .hljs-title,.hljs-sunburst .hljs-section,.hljs-sunburst .hljs-tag,.hljs-sunburst .hljs-name{color:#89bdff}.hljs-sunburst .hljs-class .hljs-title,.hljs-sunburst .hljs-doctag{text-decoration:underline}.hljs-sunburst .hljs-symbol,.hljs-sunburst .hljs-bullet,.hljs-sunburst .hljs-number{color:#3387cc}.hljs-sunburst .hljs-params,.hljs-sunburst .hljs-variable,.hljs-sunburst .hljs-template-variable{color:#3e87e3}.hljs-sunburst .hljs-attribute{color:#cda869}.hljs-sunburst .hljs-meta{color:#8996a8}.hljs-sunburst .hljs-formula{background-color:#0e2231;color:#f8f8f8;font-style:italic}.hljs-sunburst .hljs-addition{background-color:#253b22;color:#f8f8f8}.hljs-sunburst .hljs-deletion{background-color:#420e09;color:#f8f8f8}.hljs-sunburst .hljs-selector-class{color:#9b703f}.hljs-sunburst .hljs-selector-id{color:#8b98ab}.hljs-sunburst .hljs-emphasis{font-style:italic}.hljs-sunburst .hljs-strong{font-weight:bold}.hljs-tomorrow-night-blue .hljs-comment,.hljs-tomorrow-night-blue .hljs-quote{color:#7285b7}.hljs-tomorrow-night-blue .hljs-variable,.hljs-tomorrow-night-blue .hljs-template-variable,.hljs-tomorrow-night-blue .hljs-tag,.hljs-tomorrow-night-blue .hljs-name,.hljs-tomorrow-night-blue .hljs-selector-id,.hljs-tomorrow-night-blue .hljs-selector-class,.hljs-tomorrow-night-blue .hljs-regexp,.hljs-tomorrow-night-blue .hljs-deletion{color:#ff9da4}.hljs-tomorrow-night-blue .hljs-number,.hljs-tomorrow-night-blue .hljs-built_in,.hljs-tomorrow-night-blue .hljs-builtin-name,.hljs-tomorrow-night-blue .hljs-literal,.hljs-tomorrow-night-blue .hljs-type,.hljs-tomorrow-night-blue .hljs-params,.hljs-tomorrow-night-blue .hljs-meta,.hljs-tomorrow-night-blue .hljs-link{color:#ffc58f}.hljs-tomorrow-night-blue .hljs-attribute{color:#ffeead}.hljs-tomorrow-night-blue .hljs-string,.hljs-tomorrow-night-blue .hljs-symbol,.hljs-tomorrow-night-blue .hljs-bullet,.hljs-tomorrow-night-blue .hljs-addition{color:#d1f1a9}.hljs-tomorrow-night-blue .hljs-title,.hljs-tomorrow-night-blue .hljs-section{color:#bbdaff}.hljs-tomorrow-night-blue .hljs-keyword,.hljs-tomorrow-night-blue .hljs-selector-tag{color:#ebbbff}.hljs-tomorrow-night-blue .hljs{display:block;overflow-x:auto;background:#002451;color:white;padding:.5em}.hljs-tomorrow-night-blue .hljs-emphasis{font-style:italic}.hljs-tomorrow-night-blue .hljs-strong{font-weight:bold}.hljs-tomorrow-night-bright .hljs-comment,.hljs-tomorrow-night-bright .hljs-quote{color:#969896}.hljs-tomorrow-night-bright .hljs-variable,.hljs-tomorrow-night-bright .hljs-template-variable,.hljs-tomorrow-night-bright .hljs-tag,.hljs-tomorrow-night-bright .hljs-name,.hljs-tomorrow-night-bright .hljs-selector-id,.hljs-tomorrow-night-bright .hljs-selector-class,.hljs-tomorrow-night-bright .hljs-regexp,.hljs-tomorrow-night-bright .hljs-deletion{color:#d54e53}.hljs-tomorrow-night-bright .hljs-number,.hljs-tomorrow-night-bright .hljs-built_in,.hljs-tomorrow-night-bright .hljs-builtin-name,.hljs-tomorrow-night-bright .hljs-literal,.hljs-tomorrow-night-bright .hljs-type,.hljs-tomorrow-night-bright .hljs-params,.hljs-tomorrow-night-bright .hljs-meta,.hljs-tomorrow-night-bright .hljs-link{color:#e78c45}.hljs-tomorrow-night-bright .hljs-attribute{color:#e7c547}.hljs-tomorrow-night-bright .hljs-string,.hljs-tomorrow-night-bright .hljs-symbol,.hljs-tomorrow-night-bright .hljs-bullet,.hljs-tomorrow-night-bright .hljs-addition{color:#b9ca4a}.hljs-tomorrow-night-bright .hljs-title,.hljs-tomorrow-night-bright .hljs-section{color:#7aa6da}.hljs-tomorrow-night-bright .hljs-keyword,.hljs-tomorrow-night-bright .hljs-selector-tag{color:#c397d8}.hljs-tomorrow-night-bright .hljs{display:block;overflow-x:auto;background:black;color:#eaeaea;padding:.5em}.hljs-tomorrow-night-bright .hljs-emphasis{font-style:italic}.hljs-tomorrow-night-bright .hljs-strong{font-weight:bold}.hljs-tomorrow-night-eighties .hljs-comment,.hljs-tomorrow-night-eighties .hljs-quote{color:#999999}.hljs-tomorrow-night-eighties .hljs-variable,.hljs-tomorrow-night-eighties .hljs-template-variable,.hljs-tomorrow-night-eighties .hljs-tag,.hljs-tomorrow-night-eighties .hljs-name,.hljs-tomorrow-night-eighties .hljs-selector-id,.hljs-tomorrow-night-eighties .hljs-selector-class,.hljs-tomorrow-night-eighties .hljs-regexp,.hljs-tomorrow-night-eighties .hljs-deletion{color:#f2777a}.hljs-tomorrow-night-eighties .hljs-number,.hljs-tomorrow-night-eighties .hljs-built_in,.hljs-tomorrow-night-eighties .hljs-builtin-name,.hljs-tomorrow-night-eighties .hljs-literal,.hljs-tomorrow-night-eighties .hljs-type,.hljs-tomorrow-night-eighties .hljs-params,.hljs-tomorrow-night-eighties .hljs-meta,.hljs-tomorrow-night-eighties .hljs-link{color:#f99157}.hljs-tomorrow-night-eighties .hljs-attribute{color:#ffcc66}.hljs-tomorrow-night-eighties .hljs-string,.hljs-tomorrow-night-eighties .hljs-symbol,.hljs-tomorrow-night-eighties .hljs-bullet,.hljs-tomorrow-night-eighties .hljs-addition{color:#99cc99}.hljs-tomorrow-night-eighties .hljs-title,.hljs-tomorrow-night-eighties .hljs-section{color:#6699cc}.hljs-tomorrow-night-eighties .hljs-keyword,.hljs-tomorrow-night-eighties .hljs-selector-tag{color:#cc99cc}.hljs-tomorrow-night-eighties .hljs{display:block;overflow-x:auto;background:#2d2d2d;color:#cccccc;padding:.5em}.hljs-tomorrow-night-eighties .hljs-emphasis{font-style:italic}.hljs-tomorrow-night-eighties .hljs-strong{font-weight:bold}.hljs-tomorrow-night .hljs-comment,.hljs-tomorrow-night .hljs-quote{color:#969896}.hljs-tomorrow-night .hljs-variable,.hljs-tomorrow-night .hljs-template-variable,.hljs-tomorrow-night .hljs-tag,.hljs-tomorrow-night .hljs-name,.hljs-tomorrow-night .hljs-selector-id,.hljs-tomorrow-night .hljs-selector-class,.hljs-tomorrow-night .hljs-regexp,.hljs-tomorrow-night .hljs-deletion{color:#cc6666}.hljs-tomorrow-night .hljs-number,.hljs-tomorrow-night .hljs-built_in,.hljs-tomorrow-night .hljs-builtin-name,.hljs-tomorrow-night .hljs-literal,.hljs-tomorrow-night .hljs-type,.hljs-tomorrow-night .hljs-params,.hljs-tomorrow-night .hljs-meta,.hljs-tomorrow-night .hljs-link{color:#de935f}.hljs-tomorrow-night .hljs-attribute{color:#f0c674}.hljs-tomorrow-night .hljs-string,.hljs-tomorrow-night .hljs-symbol,.hljs-tomorrow-night .hljs-bullet,.hljs-tomorrow-night .hljs-addition{color:#b5bd68}.hljs-tomorrow-night .hljs-title,.hljs-tomorrow-night .hljs-section{color:#81a2be}.hljs-tomorrow-night .hljs-keyword,.hljs-tomorrow-night .hljs-selector-tag{color:#b294bb}.hljs-tomorrow-night .hljs{display:block;overflow-x:auto;background:#1d1f21;color:#c5c8c6;padding:.5em}.hljs-tomorrow-night .hljs-emphasis{font-style:italic}.hljs-tomorrow-night .hljs-strong{font-weight:bold}.hljs-tomorrow .hljs-comment,.hljs-tomorrow .hljs-quote{color:#8e908c}.hljs-tomorrow .hljs-variable,.hljs-tomorrow .hljs-template-variable,.hljs-tomorrow .hljs-tag,.hljs-tomorrow .hljs-name,.hljs-tomorrow .hljs-selector-id,.hljs-tomorrow .hljs-selector-class,.hljs-tomorrow .hljs-regexp,.hljs-tomorrow .hljs-deletion{color:#c82829}.hljs-tomorrow .hljs-number,.hljs-tomorrow .hljs-built_in,.hljs-tomorrow .hljs-builtin-name,.hljs-tomorrow .hljs-literal,.hljs-tomorrow .hljs-type,.hljs-tomorrow .hljs-params,.hljs-tomorrow .hljs-meta,.hljs-tomorrow .hljs-link{color:#f5871f}.hljs-tomorrow .hljs-attribute{color:#eab700}.hljs-tomorrow .hljs-string,.hljs-tomorrow .hljs-symbol,.hljs-tomorrow .hljs-bullet,.hljs-tomorrow .hljs-addition{color:#718c00}.hljs-tomorrow .hljs-title,.hljs-tomorrow .hljs-section{color:#4271ae}.hljs-tomorrow .hljs-keyword,.hljs-tomorrow .hljs-selector-tag{color:#8959a8}.hljs-tomorrow .hljs{display:block;overflow-x:auto;background:white;color:#4d4d4c;padding:.5em}.hljs-tomorrow .hljs-emphasis{font-style:italic}.hljs-tomorrow .hljs-strong{font-weight:bold}.hljs-vs .hljs{display:block;overflow-x:auto;padding:.5em;background:white;color:black}.hljs-vs .hljs-comment,.hljs-vs .hljs-quote,.hljs-vs .hljs-variable{color:#008000}.hljs-vs .hljs-keyword,.hljs-vs .hljs-selector-tag,.hljs-vs .hljs-built_in,.hljs-vs .hljs-name,.hljs-vs .hljs-tag{color:#00f}.hljs-vs .hljs-string,.hljs-vs .hljs-title,.hljs-vs .hljs-section,.hljs-vs .hljs-attribute,.hljs-vs .hljs-literal,.hljs-vs .hljs-template-tag,.hljs-vs .hljs-template-variable,.hljs-vs .hljs-type,.hljs-vs .hljs-addition{color:#a31515}.hljs-vs .hljs-deletion,.hljs-vs .hljs-selector-attr,.hljs-vs .hljs-selector-pseudo,.hljs-vs .hljs-meta{color:#2b91af}.hljs-vs .hljs-doctag{color:#808080}.hljs-vs .hljs-attr{color:#f00}.hljs-vs .hljs-symbol,.hljs-vs .hljs-bullet,.hljs-vs .hljs-link{color:#00b0e8}.hljs-vs .hljs-emphasis{font-style:italic}.hljs-vs .hljs-strong{font-weight:bold}.hljs-xcode .hljs{display:block;overflow-x:auto;padding:.5em;background:#fff;color:black}.hljs-xcode .hljs-comment,.hljs-xcode .hljs-quote{color:#006a00}.hljs-xcode .hljs-keyword,.hljs-xcode .hljs-selector-tag,.hljs-xcode .hljs-literal{color:#aa0d91}.hljs-xcode .hljs-name{color:#008}.hljs-xcode .hljs-variable,.hljs-xcode .hljs-template-variable{color:#660}.hljs-xcode .hljs-string{color:#c41a16}.hljs-xcode .hljs-regexp,.hljs-xcode .hljs-link{color:#080}.hljs-xcode .hljs-title,.hljs-xcode .hljs-tag,.hljs-xcode .hljs-symbol,.hljs-xcode .hljs-bullet,.hljs-xcode .hljs-number,.hljs-xcode .hljs-meta{color:#1c00cf}.hljs-xcode .hljs-section,.hljs-xcode .hljs-class .hljs-title,.hljs-xcode .hljs-type,.hljs-xcode .hljs-attr,.hljs-xcode .hljs-built_in,.hljs-xcode .hljs-builtin-name,.hljs-xcode .hljs-params{color:#5c2699}.hljs-xcode .hljs-attribute,.hljs-xcode .hljs-subst{color:#000}.hljs-xcode .hljs-formula{background-color:#eee;font-style:italic}.hljs-xcode .hljs-addition{background-color:#baeeba}.hljs-xcode .hljs-deletion{background-color:#ffc8bd}.hljs-xcode .hljs-selector-id,.hljs-xcode .hljs-selector-class{color:#9b703f}.hljs-xcode .hljs-doctag,.hljs-xcode .hljs-strong{font-weight:bold}.hljs-xcode .hljs-emphasis{font-style:italic}.hljs-xt256 .hljs{display:block;overflow-x:auto;color:#eaeaea;background:#000;padding:.5}.hljs-xt256 .hljs-subst{color:#eaeaea}.hljs-xt256 .hljs-emphasis{font-style:italic}.hljs-xt256 .hljs-strong{font-weight:bold}.hljs-xt256 .hljs-builtin-name,.hljs-xt256 .hljs-type{color:#eaeaea}.hljs-xt256 .hljs-params{color:#da0000}.hljs-xt256 .hljs-literal,.hljs-xt256 .hljs-number,.hljs-xt256 .hljs-name{color:#ff0000;font-weight:bolder}.hljs-xt256 .hljs-comment{color:#969896}.hljs-xt256 .hljs-selector-id,.hljs-xt256 .hljs-quote{color:#00ffff}.hljs-xt256 .hljs-template-variable,.hljs-xt256 .hljs-variable,.hljs-xt256 .hljs-title{color:#00ffff;font-weight:bold}.hljs-xt256 .hljs-selector-class,.hljs-xt256 .hljs-keyword,.hljs-xt256 .hljs-symbol{color:#fff000}.hljs-xt256 .hljs-string,.hljs-xt256 .hljs-bullet{color:#00ff00}.hljs-xt256 .hljs-tag,.hljs-xt256 .hljs-section{color:#000fff}.hljs-xt256 .hljs-selector-tag{color:#000fff;font-weight:bold}.hljs-xt256 .hljs-attribute,.hljs-xt256 .hljs-built_in,.hljs-xt256 .hljs-regexp,.hljs-xt256 .hljs-link{color:#ff00ff}.hljs-xt256 .hljs-meta{color:#fff;font-weight:bolder}.hljs-zenburn .hljs{display:block;overflow-x:auto;padding:.5em;background:#3f3f3f;color:#dcdcdc}.hljs-zenburn .hljs-keyword,.hljs-zenburn .hljs-selector-tag,.hljs-zenburn .hljs-tag{color:#e3ceab}.hljs-zenburn .hljs-template-tag{color:#dcdcdc}.hljs-zenburn .hljs-number{color:#8cd0d3}.hljs-zenburn .hljs-variable,.hljs-zenburn .hljs-template-variable,.hljs-zenburn .hljs-attribute{color:#efdcbc}.hljs-zenburn .hljs-literal{color:#efefaf}.hljs-zenburn .hljs-subst{color:#8f8f8f}.hljs-zenburn .hljs-title,.hljs-zenburn .hljs-name,.hljs-zenburn .hljs-selector-id,.hljs-zenburn .hljs-selector-class,.hljs-zenburn .hljs-section,.hljs-zenburn .hljs-type{color:#efef8f}.hljs-zenburn .hljs-symbol,.hljs-zenburn .hljs-bullet,.hljs-zenburn .hljs-link{color:#dca3a3}.hljs-zenburn .hljs-deletion,.hljs-zenburn .hljs-string,.hljs-zenburn .hljs-built_in,.hljs-zenburn .hljs-builtin-name{color:#cc9393}.hljs-zenburn .hljs-addition,.hljs-zenburn .hljs-comment,.hljs-zenburn .hljs-quote,.hljs-zenburn .hljs-meta{color:#7f9f7f}.hljs-zenburn .hljs-emphasis{font-style:italic}.hljs-zenburn .hljs-strong{font-weight:bold}</style>
    <title>   </title>
    <meta charset="utf-8">
    <style>
      @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body { font-family: 'Droid Serif'; }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: normal;
      }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
    </style>
  </head>
  <body class="remark-container">
    <textarea id="source" style="display: none;">class: center, middle

#     



## 




### yuo u o

---

##  :

### yuo u o 

-      
	  
-   

-   

-          5 - 9 

---

## whoami (who am I), part Max:

### Massimiliano Stucchi

  - IPv6 Programme Manager at RIPE NCC
    - Here representing myself only

	
  - IPv6 "Enthusiast"

  
  - @stucchimax, https://stucchi.ch


---

## Introduce yourself

- A quick introduction about yourself:

  - Your name

  - Your favourite BSD

  - Your experience with networking

  - Your experience with PF

  - Your goal(s)

???

This introduction serves for us to understand the level of the room, and
 decide on how to better suit
the tutorial.

Getting an idea of the level makes it so that we might quickly go 
through the basics, and focus on something
more advanced, rather than spend time on something that everybody knows 
already.

---

## Agenda

1. PF Basics
2. Exercise: Host configuration
3. NAT and Redirects
4. Exercise: Setup a gateway
5. Hosting Services
6. Exercise: Hosting Services, redirects
7. Traffic Shaping
8. Exercise: Setting up queueing
9. Tips
10. Troubleshooting
11. Exercise: NAT64
12. End

---

class: center, middle

# PF Basics
  
  
### Section 1

---
## It all started with a copyright violation

- OpenBSD up to 2.9 (2001) used Darren Reed's IPFilter

  - Almost, but not quite BSD licensed

  - No right to distribute changed versions



- IPFilter removed on May 29th, 2001

  - First commit of the new PF code June 24 2001 at 19:48:58 UTC

  - OpenBSD 3.0 release pushed to Dec 1 by the extra effort


- *License audit* of src tree + ports tree followed

But let's jump to the present -

???



---
## Network design 101

How to build a maintainable network:

- Start with something simple

- Think dual stack (IPv6 and IPv4)

- Users
  - Access to local and remote services
    - and their security requirements

- The services you offer and the ones you consume
  - i.e: SMTP, WWW, DNS

- **Keep it simple, not stupid** 

---
## But first, how do we build rulesets?

The basic _rule_ format is, 

 **verb** _criteria_ **actions** ... options

```shell
 pass in on egress proto tcp to egress port ssh
```

```shell
 match out on egress nat-to egress
```

```shell
 block all
```


You can do complete rulesets with only these, but you may also want to 
declare things -&gt;

( **egress** ? -&gt; the _interface group_ consisting of interfaces that
 have a default route )

---
## Next, declarations

Declaring objects your rules will use:

**Macros:**

```shell
macro-name = "definition"
```

**Tables:**

```shell
table &lt;tablename&gt; 
```

**Queues:**


```shell
queue queuename on interface bandwidth number ...
```

You can also *set* options.

We'll be returning to all of those, in the meantime [man 
pf.conf](http://man.openbsd.org/pf.conf) is always your friend.

---
## Block by default

- A firewall is supposed to block by default, right?

- Let's start with the ruleset for a client

- Useful baseline:
  - block by default
  - pass traffic we generate

```shell
    block
    pass from (self)
```

---
## In practice

- On my laptop in my home network, that expands to:

```shell
    $ doas pfctl -vnf /etc/pf.conf
    block drop all
    pass inet6 from ::1 to any flags S/SA
    pass on lo0 inet6 from fe80::1 to any flags S/SA
    pass on iwm0 inet6 from fe80::a2a8:cdff:fe63:abb9 to any flags S/SA
    pass inet6 from 2001:470:28:658:a2a8:cdff:fe63:abb9 to any flags 
S/SA
    pass inet6 from 2001:470:28:658:8c43:4c81:e110:9d83 to any flags 
S/SA
    pass inet from 127.0.0.1 to any flags S/SA
    pass inet from 192.168.103.126 to any flags S/SA
```
???

It would be nice in this slide to ask questions, to see the general 
knowledge about protocols:

- IPv6 LLA
- IPv6 GUA
- IPv6 GUA with privacy extensions
- IPv4 Private address

This can give us an idea of how to proceed with IPv6 depending on the 
level of the participants.


---
##   Anatomy of a ruleset 

- Ruleset evaluated top to bottom

- **Last match wins**  (unless _quick_ is used)

- Stateful by default

- For more details, see [man pf.conf](http://man.openbsd.org/pf.conf)
  - http://man.openbsd.org/pf.conf

---
## A ruleset can contain

- **Options**
	- General configuration

- **Macros**
	- Content to be expanded
  
- **Tables**
	- When macros fall short

- **Redirections**

- **Rules**
	- How PF should behave

- The order of the items in the ruleset used to be important, but not 
anymore

---

## Options

- General configuration for pf

- Useful for debugging, appliying default timeout values, etc.

```shell
    set limit states 100000
```

- or

```shell
    set debug debug
    set loginterface dc0
    set timeout tcp.first 120 
    set timeout tcp.established 86400 
    set timeout { adaptive.start 6000, adaptive.end 12000 }
```

---

## Macros

- Content that will later be expanded in context

- Name must start with a letter, digit, or underscore

- Useful to keep rulesets simple and clean

```shell
    ext_if = "kue0" 
    all_ifs = "{" $ext_if lo0 "}" 
    pass out on $ext_if from any to any 
    pass in  on $ext_if proto tcp from any to any port 25
```

- Could also be port or address ranges

```shell
   bacula_ports = "9101:9103"
   dmz_hosts = "192.0.2.1 - 192.0.2.254"
```

???

If we have more slide space, then separate the second example in its own
 slide

---
##   Tables

- When IP address list macros grow too long, use tables instead

- Hold only addresses and networks
  - No port ranges

- Provide fast lookups
  
```shell
   table &lt;bruteforce&gt; persist counters
```

- They can be used in rules

```shell
   block from &lt;bruteforce&gt;
```

- Unlike macros with port or address lists, _do not_ expand to multiple 
rules
  - More optimised ruleset

---

## Tables continued


- Content can be loaded from files or from CLI

```shell
    table &lt;popflooders&gt; persist counters file 
"/var/tmp/popflooders"
```

- use [pfctl](http://man.openbsd.org/pfctl) to add/remove entries from 
command line

```shell
   $ doas pfctl -t bruteforce -T add 192.0.2.11 
2001:db8::dead:beef:baad:f00d
```
  
- optionally maintained by daemons such as 
[spamd](http://man.openbsd.org/spamd), 
[bgpd](http://man.openbsd.org/bgpd) and 
[dhcpd](http://man.openbsd.org/dhcpd)


---

class: center, middle

##   Implementing your spec

### How would you do this in your home/soho infrastructure ?

???

We ask the participants how they think they would implement this in 
their infrastructure.

This is to create discussion, and hopefully make it so that we all learn
 a bit by trial-and-error.

Let's put out the question, wait for some time to see if anyone comes up
 with a nice description, and then walk them through what is a sensible 
setup.

This is in preparation for the first exercise which comes next.

---
class: center, middle

# Exercise 1
  
  
### Protecting your host

---
## Excercise 1 - Let's start

- Lab environment:
  - Open your favourite browser, then
  - Go to [labs.pftutorial.net](https://labs.pftutorial.net)

- check that pf is indeed loaded and running (*hint*: 
[pfctl](http://man.openbsd.org/pfctl))

- Try accessing other lab hosts

---

## Exercise 1 - net config

- Configure the external interface on gateway

- _vi /etc/hostname.re0_

```shell 
		inet 10.255.255.XX/24
		!route add 0/0 10.255.255.254
		inet6 fd18:b5d:cafe::XX/64
		!route add -inet6 ::/0 fd18:b5d:cafe::a
```

- and then _vi /etc/resolv.conf_


```shell 
    nameserver 10.255.255.254
    nameserver fd18:b5d:cafe::a
```

followed by 

```shell 
    sh /etc/netstart
```


---

## Exercise 1 - on gateway

- Start with a block ruleset

```shell 
    block
    pass quick inet6 proto tcp from fd18::/16 to port ssh
```

- Allow traffic to be generated from your host

```shell
	pass from self
```

and then, reload _pf.conf_

```shell
   pfctl -vnf /etc/pf.conf
   pfctl -f /etc/pf.conf
```

- **NB:** Reload pf this way after every statement in the exercises

---

## Exercise 1 - Tests

- From your gateway ping a host

- First IPv6

```shell 
 # ping6 fd18:b5d:cafe::a
 PING fd18:b5d:cafe::a (fd18:b5d:cafe::a): 56 data bytes
 64 bytes from fd18:b5d:cafe::a: icmp_seq=0 hlim=64 time=0.548 ms
 64 bytes from fd18:b5d:cafe::a: icmp_seq=1 hlim=64 time=0.492 ms
 64 bytes from fd18:b5d:cafe::a: icmp_seq=2 hlim=64 time=0.494 ms

```

- Then IPv4

```shell 
 # ping stucchi.ch
 PING stucchi.ch (37.59.51.141): 56 data bytes
 64 bytes from 37.59.51.141: icmp_seq=0 ttl=56 time=6.264 ms
 64 bytes from 37.59.51.141: icmp_seq=1 ttl=56 time=6.273 ms
 64 bytes from 37.59.51.141: icmp_seq=2 ttl=56 time=6.117 ms
```

---

## Exercise 1 - Wrap up

- Does ping work?

- Do other commands work?
  - working from total block, proceed to make restricted workstation
    - name resolution
    - _http_ and _https_

- Access public web sites, other Internet resources.

- What would it take to access the other lab hosts?

---

class: center, middle


# Questions ?
  
???

Let's ask if there are any questions before continuing.  Make sure we 
have everyone onboard.

---

class: center, middle

# Gateway, NAT and Redirects 
  
  
### Section 2

---
## Easy! How do we improve on this?

- Make a 'firewall':

  - a point of policy enforcement

  - a gateway

  - filter for other hosts

  - redirection tricks

---
## Introducing NAT

- **N**etwork **A**ddress **T**ranslation 
([RFC1631](https://tools.ietf.org/html/rfc1631) onwards)

- -&gt; 'Hide' several hosts behind 1 public address, using 
[RFC1918](https://tools.ietf.org/html/rfc1918) addresses

- Modern PF has _nat-to_ on 'pass' and 'match' rules:

```shell
	match out on $extif inet nat-to ($extif)
```

- *Neat trick*: egress is the interface group that has a default route, 
you can filter on it


```shell
	match out on egress inet nat-to (egress)
```



- In modern networks we **should** (also) have IPv6 (inet6)

???

NAT, the stopgap measure that's old enough to drink, more than 22 years 
old.  NAT was created as a temporary measure that hasn't been replaced 
by now.  Not even IPv6.

We haven't discusses "egress" yet, so this is the right time to 
introduce it.

Spend some time discussing it, along with the rest of the NAT 
specifications.

Unfortunately, there's also NAT for IPv6, called NAT66

---
## A (filtering) Gateway

_"I decide which packets pass"_

#### Enable forwarding:

- Temporarily set from command line with 
[sysctl](http://man.openbsd.org/sysctl):

```shell 
    # sysctl net.inet.ip.forwarding=1 
    # sysctl net.inet6.ip6.forwarding=1 
```

- Make permanent in 
[/etc/sysctl.conf](http://man.openbsd.org/sysctl.conf)

```shell 
    net.inet.ip.forwarding=1
    net.inet6.ip6.forwarding=1
```


---
## The minimal gateway

- Do you *NAT* for IPv4? Of course you do.

- Do you run IPv6? Of course you do.

```shell 
    ext_if=bge0
    int_if=bge1
    match out on egress inet nat-to ($ext_if)
    block all
    pass proto tcp from { self, $int_if:network }
```

- The "pass" rule, withouth _inet_ or _inet6_ applies to both

**Keep in mind**: This is a point of policy enforcement

---
## A Point of policy enforcement

- Now some policy, and macros

```shell 
  ext_if=bge0
  int_if=bge1

  client_out = "{ ftp-data, ftp, ssh, domain, pop3, auth, nntp, http, \
      https, 2628, 5999, 8000, 8080 }
  udp_services = "{ domain, ntp }"

  match out on egress inet nat-to ($ext_if)
* block
* pass quick proto { tcp, udp } to port $udp_services keep state
*
* pass proto tcp from $int_if:network to port $client_out
*
* pass proto tcp to self port ssh
```

- What services do your clients consume?

???

Log to on the system we have for showing out, and then show the rules 
there and how they expand to different parts.

---
## Letting dhcpd(8) direct access

OpenBSD [dhcpd(8)](http://man.openbsd.org/dhcpd) can interact with your 
ruleset via tables:

*/etc/rc.conf.local*
```shell 
dhcpd_flags="-L leased_ip_table -A abandoned_ip_table -C 
changed_ip_table bge1"
```

```shell 
  ext_if=bge0
  int_if=bge1
* table &lt;abandoned_ip_table&gt; persist counters
* table &lt;changed_ip_table&gt; persist counters
* table &lt;leased_ip_table&gt; persist counters

  client_out = "{ ftp-data, ftp, ssh, domain, pop3, auth, nntp, http, \
                  https, 2628, 5999, 8000, 8080 }"
  udp_services = "{ domain, ntp }"

  match out on egress inet nat-to ($ext_if)
  block
  pass quick proto { tcp, udp } to port $udp_services keep state
* pass proto tcp from &lt;leased_ip_table&gt; to port $client_out
  pass proto tcp to self port ssh
```
**=&gt;** only pass traffic from hosts with active leases from *me*

???

Maybe move this slide to a later section.

---
## Redirects (and divert-to)

  Modern PF has two classes of redirect

  * **rdr-to** on match and pass rules - rewrite destination address 
while filtering (locally or even to other hosts)

```shell 
      pass in on egress to port www rdr-to $webserver
```


  * **divert-to** on match and pass rules - 
[divert()](http://man.openbsd.org/divert) socket for local use

```shell 
      pass in on egress to port smtp divert-to 127.0.0.1 port spamd
```


---

## FTP Proxy

- If your users need to access FTP services, 
[ftp-proxy](http://man.openbsd.org/ftp-proxy) is what you need

- FTP does not easily pass through a block firewall, some help is needed


```shell 
$ doas rcctl enable ftpproxy6
```

- or for IPv4

```shell 
$ doas rcctl enable ftpproxy
```

- and then add an anchor and divert rules to your config

```shell 
anchor "ftp-proxy/*"
  ... 
pass in quick inet proto  tcp to port ftp divert-to 127.0.0.1 port 8021
pass in quick inet6 proto tcp to port ftp divert-to ::1 port 8021
pass out proto tcp from $proxy to port ftp
```

There is even a reverse mode (**-R**) for when you host FTP servers, see
 [man ftp-proxy](http://man.openbsd.org/ftp-proxy)

---

class: center, middle

# Exercise 2
  
  
### Protecting your network

---

## Exercise 2 - Goals

- Your network grows, you become a gateway

- Extend the configuration to enable the network to access the internet

---
background-image: url(images/exercise2.png)

## Exercise 2 - Your network


---

## Exercise 2

- Turn on ip forwarding (sysctl)

```shell 
    # sysctl net.inet.ip.forwarding=1 
    # sysctl net.inet6.ip6.forwarding=1 
```

- Set up NAT

```shell
	match out on egress inet nat-to (egress)
```

Also, pass traffic from that local net

---

## Exercise 2 - check your results

- From client 1, ping a host on the internet

- First IPv6

```shell 
 # ping6 stucchi.ch
 PING stucchi.ch (2001:41d0:8:6ed8::80): 56 data bytes
 64 bytes from 2001:41d0:8:6ed8::80: icmp_seq=1 hlim=56 time=7.414 ms
 64 bytes from 2001:41d0:8:6ed8::80: icmp_seq=2 hlim=56 time=6.333 ms
 64 bytes from 2001:41d0:8:6ed8::80: icmp_seq=3 hlim=56 time=6.441 ms
```

- Then IPv4

```shell 
 # ping stucchi.ch
 PING stucchi.ch (37.59.51.141): 56 data bytes
 64 bytes from 37.59.51.141: icmp_seq=0 ttl=56 time=6.264 ms
 64 bytes from 37.59.51.141: icmp_seq=1 ttl=56 time=6.273 ms
 64 bytes from 37.59.51.141: icmp_seq=2 ttl=56 time=6.117 ms
```

---
# Exercise 2b: FTP

Try fetching 
*ftp://ftp.ripe.net/pub/stats/ripencc/delegated-ripencc-extended-latest*

Check your result

If it didn't work, configure FTP-proxy and try again.


---

class: center, middle

# Hosting Services
  
  
### Section 3

---

## Hosting services behind your gateway


- Now you actually want some 'pass in on egress' rules :)

- Get your specifications clear, put in writing:

  - your services and the ports they use
    - the names could be in **/etc/services** already

  - the hosts (IP addresses) that run the services

  - decide who/what/where to be reachable for/from

- Check services requiring extra help (i.e. proxying).

---
## Proxies and other helpers

- OpenBSD comes with several proxies and other service helper programs 
in the base system:

  - [ftp-proxy](http://man.openbsd.org/ftp-proxy) (you guessed it)

  - [relayd](http://man.openbsd.org/relayd) (load balancing and lots 
more)

  - [spamd](http://man.openbsd.org/spamd) (if you run SMTP - annoy 
spammers)

&lt;br&gt;&lt;br&gt;&lt;br&gt;

- There are also such things as squid and varnish (web proxies) in 
packages

&lt;br&gt;&lt;br&gt;&lt;br&gt;

- Clients and services in the same subnet? Or do the DMZs?
  
---
## DMZ, defined

### '*D*e-*M*ilitarized *Z*one'

- when a group of host needs special treatment 

&lt;br&gt;&lt;br&gt;

- attached to separate interfaces(s), separate sub-rulesets

&lt;br&gt;&lt;br&gt;

- And **YES**, you can have several

&lt;br&gt;&lt;br&gt;

- Think multiple customers, *N* environments each

---
background-image: url(images/exercise3.png)
class: right
## DMZ, illustrated




---
##Allowing some services in

```shell 
    ext_if=bge0 # adjust to what your system has
    int_if=bge1 # adjust to what your system has

    client_out = "{ ftp-data, ftp, ssh, domain, pop3, auth, nntp, http, \
                https, 2628, 5999, 8000, 8080 }"
    udp_services = "{ domain, ntp }"

*   webserver = "192.0.2.227"
*   webports = "{ http, https }"
*   emailserver = "192.0.2.225"
*   email = "{ smtp, pop3, imap, imap3, imaps, pop3s }"
*   nameservers = "{ 192.0.2.221, 192.0.2.223 }"

    match out on egress inet nat-to ($ext_if)
    block
    pass quick proto { tcp, udp } to port $udp_services keep state
    pass proto tcp from $int_if:network to port $client_out
    pass proto tcp to self port ssh

*   pass proto tcp to $webserver port $webports 
*   pass proto tcp to $emailserver port $email 
*   pass log proto tcp from $emailserver to port smtp 
*   pass inet proto { tcp, udp } to $nameservers port domain

```

Now try loading this with *pfctl -vnf /etc/pf.conf* and see what this 
expands to (you can also fetch 
[pf.services01.conf](samples/pf.services01.conf) and try)

---
## Tackling noise (attacks) with state-tracking options

### Scenario: ssh bruteforcers

In our previous ruleset, add 

```shell 
table &lt;bruteforce&gt; persist counters
block from &lt;bruteforce&gt;
```

and change the **ssh** rule to

```shell 
* pass proto tcp to port ssh flags S/SA keep state \
*   (max-src-conn 15, max-src-conn-rate 2/10, overload 
&lt;bruteforce&gt; flush global)

```

- Tune to taste
- More info on options in [man pf.conf](http://man.openbsd.org/pf.conf)
- Remember *[pfctl](http://man.openbsd.org/pfctl) expire*

???
max-src-conn - see man page but max number of simultaneous connections 
from one host
max-src-conn-rate - number of new connections per number of seconds 

---

## Tackling noise (attacks) with state-tracking options

### Scenario: Wordpress site

- Wordpress is a usual target for many different attacks

- -&gt; Make the attackers suffer by forcing them through smaller 
"windows"
  - Use tables and block by connection rates

- Mix and match settings, consult [man 
pf.conf](http://man.openbsd.org/pf.conf) and remember 
*[pfctl](http://man.openbsd.org/pfctl) expire*

- Also see [Forcing the password gropers through a smaller hole with 
OpenBSD's PF 
queues](http://bsdly.blogspot.ca/2017/04/forcing-password-gropers-through.html)
 + [The Book of PF](https://www.nostarch.com/pf3)

---

## Scenario: Wordpress site

- You can re-use the *bruteforce* table or make a separate one, like

```shell 
  table &lt;web_brutes&gt; persist counters
  block from &lt;web_brutes&gt;
```

- Now change the **$webports** rule to

```shell 
* pass proto tcp to port $webports flags S/SA keep state \
*   (max-src-conn 15, max-src-conn-rate 5/10, overload 
&lt;web_brutes&gt; flush global)

```

- Alternatively, on a machine (the gateway) that does not run Wordpress,
 do

```shell 
  grep wp-login /var/www/logs/access.log | awk '{print $1}' | \ 
    sort -u | xargs doas pfctl -t web_brutes -T add
```

- (**Wordpressers**: Do these look right? Consult web logs and 
[tcpdump](http://man.openbsd.org/tcpdump) output.)


???
max-src-conn - see man page but max number of simultaneous connections 
from one host
max-src-conn-rate - number of new connections per number of seconds 
You could also look into max-src-nodes, max-src-states

---

## Annoying spammers with spamd

- [spamd(8)](http://man.openbsd.org/spamd) is good, clean, fun
&lt;br&gt;&lt;br&gt;
- Speaks enough SMTP to do 
[greylisting](https://en.wikipedia.org/wiki/Greylisting)
&lt;br&gt;&lt;br&gt;
- Can tarpit known bad senders and generate blacklists by greytrapping
&lt;br&gt;&lt;br&gt;
- Default [spamd.conf](http://man.openbsd.org/spamd.conf) gives you one 
blacklist import and basics
  - (**Hint:** no real SMTP service required)
&lt;br&gt;&lt;br&gt;
- You can even generate your own blacklists by *greytrapping* via 
*non-deliverable* spamtrap addresses in your own domain(s)
&lt;br&gt;&lt;br&gt;
- Also see: 
  - [The Book of PF](https://www.nostarch.com/pf3)
  - [In The Name Of Sane Email: Setting Up OpenBSD's spamd(8) With 
Secondary 
MXes](http://bsdly.blogspot.ca/2012/05/in-name-of-sane-email-setting-up-spamd.html)

  - [Maintaining A Publicly Available 
Blacklist](http://bsdly.blogspot.ca/2013/04/maintaining-publicly-available.html)

---
##
 Annoying spammers with spamd

- Set up tables
- Divert traffic to the spamd process
- Only let the "good guys" pass to the real SMTP daemon

```shell 
table &lt;spamd-white&gt; persist
table &lt;nospamd&gt; persist file "/etc/mail/nospamd"
pass in on egress proto tcp to any port smtp divert-to 127.0.0.1 port 
spamd
pass in on egress proto tcp from &lt;nospamd&gt; to any port smtp
pass in log on egress proto tcp from &lt;spamd-white&gt; to any port 
smtp
pass out log on egress proto tcp to any port smtp
```

- and then run

```shell
$ doas rcctl enable spamd
$ doas rcctl start spamd
```

**TIP:** check out [smtpctl spf walk 
&lt;_nospamd_domains.txt_](https://man.openbsd.org/smtpctl) to feed your
 _nospamd_ table from live 
[SPF](https://en.wikipedia.org/wiki/Sender_Policy_Framework) data 
(requires 6.2-current or later)

---
## Consider: what about that separate DMZ?

- What do you need?
&lt;br&gt;&lt;br&gt;&lt;br&gt;
- IP addresses: Segment off or allocate separate address ranges
&lt;br&gt;&lt;br&gt;&lt;br&gt;
- Attach each segment to separate interface, VLAN
&lt;br&gt;&lt;br&gt;&lt;br&gt;
- Do the ruleset surgery
  - which services do you run, where
  - do you need renumbering?
  - what traffic (in and out) is actually required?

???



---

class: center, middle


# Questions ?
  
???

Let's ask if there are any questions before continuing.  Make sure we 
have everyone onboard.

---

class: center, middle
# Exercise 3

  
### Offering services

---

## Excercise 3 - Goals

- You're now offering services
&lt;br&gt;&lt;br&gt;&lt;br&gt;
- **FreeBSD Host** will provide **http** service
&lt;br&gt;&lt;br&gt;&lt;br&gt;
- **OpenBSD Client** will provide **smtp** service
&lt;br&gt;&lt;br&gt;&lt;br&gt;
- We need to setup:
  - The services
  - Redirects
  - Firewall rules

---
background-image: url(images/exercise3.png)
class: right
## Exercise 3 - Network

???

This is not exactly the network we have, but could be thought as such.

Host1 and Host2 are in what could be considered our DMZ.

---
## Exercise 3 - preparation

- Configure the hosts with the following IPv6 addresses

- *Gateway (re1):* fd18:b5d:XX::a
- *FreeBSD:* fd18:b5d:XX::80
- *OpenBSD Client:* fd18:b5d:XX::25
&lt;br/ &gt; &lt;br/&gt;

- Also, on FreeBSD and OpenBSD client, set fd18:b5d:XX::a as the default
 gateway

- .. and take note of their IPv4 addresses

---
## Exercise 3 - on FreeBSD

- We need to install nginx

```shell
 # pkg install nginx
```

- and start it

```shell
 # /usr/local/etc/rc.d/nginx onestart
```

---
## Exercise 3 - on OpenBSD Client

- Change the config to listen on all interfaces:
  - Change the appropriate line in
  
### /etc/mail/smtpd.conf

```shell
  listen on all
```
&lt;br&gt;&lt;br&gt;
- Then start the daemon

```shell
 # rcctl enable smtpd
 # rcctl start smtpd
 smtpd(ok)
```
- (It might take a while)

---
## Exercise 3 - on gateway

### /etc/pf.conf

```shell
webserver_v4 = "$IP_addr_of_freebsd"
webserver_v6 = "fd18:b5d:XX::80"
webports = "{ http, https }"
emailserver_v4 = "$IP_addr_of_openbsd_client"
emailserver_v6 = "fd18:b5d:XX::25"
email = "{ smtp, pop3, imap, imap3, imaps, pop3s }"

match in on egress inet proto tcp to egress port $webports rdr-to 
$webserver_v4
match in on egress inet proto tcp to egress port $email rdr-to 
$emailserver_v4

pass inet proto tcp to $webserver_v4 port $webports
pass inet proto tcp to $emailserver_v4 port $email
pass log inet proto tcp from $emailserver_v4 to port smtp

pass inet6 proto tcp to $webserver_v6 port $webports
pass inet6 proto tcp to $emailserver_v6 port $email
pass log inet6 proto tcp from $emailserver_v6 to port smtp
```

- **NB:** No redirects are needed for IPv6

---
## Exercise 3 - checks

- Try connecting to the HTTP and SMTP port of your friends/neighbours:
&lt;br&gt;&lt;br&gt;
- From Gateway:

```shell
    telnet -6 fd18:b5d:XX::80 80
    telnet -4 10.255.255.XX 80

```
&lt;br&gt;&lt;br&gt;
- and

```shell
    telnet -6 fd18:b5d:XX::25 25
    telnet -4 10.255.255.XX 25

```

---

## Tips

- Decide your network topology
  - DMZ (?)
  - Multi-customer (?)
  - Multi-customer, Multi-DMZ(?)

- Segment off your subnets
  - IPv4 (Do you NAT)?
  - IPv6
  - Do you NAT64?

- Per subnet (customer)
  - Which services do you expose?
  - Write the rules
  - pamper^H^H^H^H^Hproxying

---


class: center, middle

# Traffic Shaping
  
  
### Section 4

---

## Traffic shaping

- OpenBSD has three separate shaping techniques:

  - *priorities* (set prio), introduced in OpenBSD 5.0

  - *queues*, introduced in OpenBSD 5.5, and

  - *flows*, introduced in OpenBSD 6.2 (aka FQ-CoDel)
&lt;br&gt;&lt;br&gt;
- **Remember:**

  - Traffic shaping is about *dropping packets*

  - But is only relevant when there's a *reason* to start dropping

  - Then you get to pick which ones using the traffic shaping tools
&lt;br&gt;&lt;br&gt;
- Works only one way, **outbound**

---
## Traffic shaping with priorities  

- In OpenBSD, every packet has a priority
&lt;br&gt;&lt;br&gt;
- Possible values are 0 (garbage) through 7 (want!)
  - Default for most traffic is 3.
&lt;br&gt;&lt;br&gt;
- So if you want *all* ssh traffic to move ahead of other traffic you 
could do a
&lt;br&gt;&lt;br&gt;
```shell
  pass proto tcp to port ssh set prio 6
```
&lt;br&gt;&lt;br&gt;
- and assign specific, non-default ( != 3 ) values to others.

---
## Beating the FIFO with prio  

- By default, packets are serviced on a first come, first served basis
  - or 'First in, First out' (FIFO).
&lt;br&gt;&lt;br&gt;
- But: TCP wants ACKs for sent packets within a reasonable time
  - Otherwise the packet is considered lost, and retransmit will follow 
(transfer stalls).
&lt;br&gt;&lt;br&gt;
- ACKs are tiny and have their TOS set to lowdelay, and this trick will 
cheat the FIFO:
&lt;br&gt;&lt;br&gt;
```shell
   match out on $ext_if proto tcp from $ext_if set prio (3, 7)
   match in  on $ext_if proto tcp to $ext_if set prio (3, 7)
```
&lt;br&gt;&lt;br&gt;
- See [Prioritizing empty TCP ACKs with pf and 
ALTQ](http://www.benzedrine.ch/ackpri.html) by Daniel Hartmeier for the 
ALTQ way

---
## FQ-CoDel flows for fair bandwidth sharing

Introduced in [OpenBSD 6.2](https://www.openbsd.org/62.html), the 
FQ-CoDel algorithm (see [RFC8290](https://tools.ietf.org/html/rfc8290)) 
defines **flows** to set up fair sharing for a specified number of 
simultaneous connections

Enable for your configuration with something like

```shell
queue outq on bge0 bandwidth 18M max 18M flows 1024 qlimit 1024 \
               default
```

Estimate your approximate high number of simultaneous clients, put that 
number in (up to 32767) 

---
##  Shaping with HFSC queues - fixed sizes

- When priorities don't quite cut it, you can slice your bandwidth into 
queues.
&lt;br&gt;&lt;br&gt;
- For static shaping, give bandwidth values in absolute values:
&lt;br&gt;&lt;br&gt;
- Only leaf queues can be assigned traffic
 - make sure allocations sum up to parent queue allocation
&lt;br&gt;&lt;br&gt;
- Unless quotas approach saturation, no actual shaping (dropping) will 
take place
  
---
## Shaping with HFSC queues - fixed sizes
&lt;br&gt;&lt;br&gt;&lt;br&gt;

```shell
  queue main on $ext_if bandwidth 20M
      queue defq parent main bandwidth 3600K default
      queue ftp parent main bandwidth 2000K
      queue udp parent main bandwidth 6000K
      queue web parent main bandwidth 4000K
      queue ssh parent main bandwidth 4000K
        queue ssh_interactive parent ssh bandwidth 800K
        queue ssh_bulk parent ssh bandwidth 3200K
  queue icmp parent main bandwidth 400K
```

---
##  Shaping with HFSC queues - fixed assignment

- You can either do queue assignment with match rules:
  
```shell
match log quick on $ext_if proto tcp to port ssh \
	queue (ssh_bulk, ssh_interactive)
match in quick on $ext_if proto tcp to port ftp queue ftp
match in quick on $ext_if proto tcp to port www queue http
match out on $ext_if proto udp queue udp
match out on $ext_if proto icmp queue icmp
```
- treat filtering (block, pass) in separate rules,

-  *or*

  - append 'set queue' to individual pass rules

- Any traffic not explicitly assigned goes in the default queue
  
---
##  Shaping with HFSC queues - flexible allocations (min, max, burst)

You can build in flexibility:
  
```shell
queue rootq on $ext_if bandwidth 20M
        queue main parent rootq bandwidth 20479K min 1M max 20479K 
qlimit 100
             queue qdef parent main bandwidth 9600K min 6000K max 18M 
default
             queue qweb parent main bandwidth 9600K min 6000K max 18M
             queue qpri parent main bandwidth 700K min 100K max 1200K
             queue qdns parent main bandwidth 200K min 12K burst 600K 
for 3000ms
        queue spamd parent rootq bandwidth 1K min 0K max 1K qlimit 300
```
Note here the added *min* and *max* values: combinded queue bandwidth 
can exceed actual sum; this gets you upper and lower bound within 
physical limits.

  *burst N for M* - allow bursts of that size and length

  *qlimit* - size of the queue's holding buffer - larger values *may* 
delay (packets are kept longer before sending)

---
## Systat

- Available on all the BSDs
  - OpenBSD version has added functionalities

- Offers view into your system's traffic
  - Live queues, states, rules
  
- Check how your rules are behaving on your system in realtime

- More info in the man page [systat(1)](http://man.openbsd.org/systat)

---
## queue monitoring - systat queues

&lt;br&gt;&lt;br&gt;&lt;br&gt;

```shell
   1 users Load 2.56 2.27 2.28                        skapet.bsdly.net 
20:55:50

QUEUE                BW SCH  PRI    PKTS   BYTES   DROP_P   DROP_B QLEN 
BOR SUS  P/S   B/S
rootq on bge0       20M                0       0        0        0    0 
           0     0
 main               20M                0       0        0        0    0 
           0     0
  qdef               9M          6416363   2338M      136    15371    0 
         462 30733
  qweb               9M           431590 144565K        0        0    0 
         0.6   480
  qpri               2M          2854556 181684K        5      390    0 
          79  5243
  qdns             100K           802874  68379K        0        0    0 
         0.6    52
 spamd               1K           596022  36021K  1177533 72871514  299 
           2   136
```  
or

---
## queue monitoring - pfctl   

```shell
$ doas pfctl -vsq
  [ pkts:          0  bytes:          0  dropped pkts:      0 bytes:    
  0 ]
  [ qlength:   0/ 50 ]
queue rootq on bge0 bandwidth 20M qlimit 50
  [ pkts:          0  bytes:          0  dropped pkts:      0 bytes:    
  0 ]
  [ qlength:   0/ 50 ]
queue main parent rootq bandwidth 20M, min 1M, max 20M qlimit 100
  [ pkts:          0  bytes:          0  dropped pkts:      0 bytes:    
  0 ]
  [ qlength:   0/100 ]
queue qdef parent main bandwidth 9M, min 8M, max 18M default qlimit 50
  [ pkts:    6517150  bytes: 2458545319  dropped pkts:    136 bytes:  
15371 ]
  [ qlength:   0/ 50 ]
queue qweb parent main bandwidth 9M, min 8M, max 18M qlimit 50
  [ pkts:     431741  bytes:  148072219  dropped pkts:      0 bytes:    
  0 ]
  [ qlength:   0/ 50 ]
queue qpri parent main bandwidth 2M, min 700K, max 2M burst 4M for 
3000ms qlimit 50
  [ pkts:    2855418  bytes:  186101241  dropped pkts:      5 bytes:    
390 ]
  [ qlength:   0/ 50 ]
queue qdns parent main bandwidth 100K, min 12K burst 600K for 3000ms 
qlimit 50
  [ pkts:     803548  bytes:   70079760  dropped pkts:      0 bytes:    
  0 ]
  [ qlength:   0/ 50 ]
queue spamd parent rootq bandwidth 1K, max 1K qlimit 300
  [ pkts:     596424  bytes:   36910940  dropped pkts: 1178456 bytes: 
72928604 ]
  [ qlength: 300/300 ]
```  

add another v ([pfctl](http://man.openbsd.org/pfctl) -vvsq) for 
continuously updating display
 
---

class: center, middle


# Questions ?
  
???

Let's ask if there are any questions before continuing.  Make sure we 
have everyone onboard.

---




class: center, middle

# Exercise 4

  
### Queueing

---

##  Exercise 4 - Goals

- With the configs from exercise 3, now add:
&lt;br&gt;&lt;br&gt;&lt;br&gt;
- A set of queues, and
&lt;br&gt;&lt;br&gt;&lt;br&gt;
- Statements to add rules to the queues

---

## Exercise 4 - on Gateway

- Configure the queues
&lt;br&gt;&lt;br&gt;

### /etc/pf.conf

```shell
queue rootq on $ext_if bandwidth 20M
    queue main parent rootq bandwidth 20479K min 1M max 20479K qlimit 
100
        queue default parent main bandwidth 9600K min 6000K max 18M 
default
        queue http parent main bandwidth 9600K min 6000K max 18M
        queue smtp parent main bandwidth 9600K min 6000K max 18M
    queue spamd parent rootq bandwidth 1K min 0K max 1K qlimit 300
```

---
## Exercise 4 - on Gateway

- and then apply them to the match statements

### /etc/pf.conf

```shell
match in on egress inet proto tcp to egress port $webports rdr-to 
$webserver_v4 \
      queue http
match in on egress inet proto tcp to egress port $email rdr-to 
$emailserver_v4 \
      queue smtp

pass inet6 proto tcp to $webserver_v6 port $webports set queue http
pass inet6 proto tcp to $emailserver_v6 port $email set queue smtp
pass log inet6 proto tcp from $emailserver_v6 to port smtp set queue 
smtp

```

---


## Exercise 4 - Check

- Check the queues have been effectively created

```shell
 # systat queues

```
&lt;br&gt;&lt;br&gt;&lt;br&gt;
- or, alternatively

```shell
 # pfctl -vsq

```
---

class: center, middle

# Tips
  
  
### Section 5

---
# Choosing your ISP, a quick guide

- Are they national or regional IX members?
&lt;br&gt;&lt;br&gt;
- Do they have geographical redundancy ?
  - or do you need to arrange that for yourself ?
&lt;br&gt;&lt;br&gt;
- Do they actually understand your questions about peering, routing, 
multiple paths?
  - (avoid consumer oriented SOHO-only shops)
&lt;br&gt;&lt;br&gt;
- Do they _suck_?

---
## Getting transit

- Find well peered transit providers
  - Can improve quality and shorten AS paths
  - No capacity problems
&lt;br&gt;&lt;br&gt;&lt;br&gt;
- Find your top traffic destinations:
  - Can improve quality
  - Peer with them or find closer upstream
  - Traffic profile from flow collectors can be useful

---

## Common mistakes

- No diversity
  - All reached over same cable
  - All connect to the same transit
  - All have poor onward transit and peering arrangements 
&lt;br&gt;&lt;br&gt;&lt;br&gt;
- Signing up with too many transit providers
  - Lots of small circuits
  - These cost more per Mbps than larger ones

---
##   Basic OpenBGPd configuration, operation and interaction with PF
  
  - **B**order **G**ateway **P**rotocol
    - Manage and exchange route information with BGP peers

  - Once you have the ASn registered, do the basic config. 
&lt;!--
- (You were in [phessler's 
session](http://www.bsdcan.org/2017/schedule/events/783.en.html), 
right?)
--&gt;
  - In your *pf.conf*:
    - enable BGP to pass between your routers and your peers' -- **TCP 
and UDP 179**

  - **Neat trick**: Define tables in your 
[pf.conf](http://man.openbsd.org/pf.conf)
    - bgpd maintains them via **pftable** attributes on 
[bgpd.conf](http://man.openbsd.org/bgpd.conf) objects

---
## Use cases for OSPF, BGP or ECMP

- **OSPF:** **O**pen **S**hortest **P**ath **F**irst 
  - Each router maintains link state information for links and networks 
within your AS
  - Calculates routing cost
  - Use [ospf6d](http://man.openbsd.org/ospf6d) for IPv6
  - Use [ospfd](http://man.openbsd.org/ospfd) for IPv4
  - Need to *pass proto ospf* between routers.

- **BGP:** announces and receives routes
  - Use [bgpd](http://man.openbsd.org/bgpd)
  - need to *pass proto tcp port 179* between routers

- **ECMP:** **E**qual **C**ost **M**ulti-**P**ath
  - target reachable via more than one route
  - load distribution or redundancy over multiple links
  - **Tip** Use [ifstated](http://man.openbsd.org/ifstated) to handle 
link downtime.

---
## BCP38, MANRS and Internet peering

- "[**BCP38**](https://tools.ietf.org/html/bcp38)"
  - Discussed also in another effort
  
- **M**utually **A**greed **N**orms for **R**outing **S**ecurity (MANRS)

- Define four concrete actions network operators should implement
  - Coordination
    - Keep your contacts updated
  - Validation
    - Route objects, RPKI, BGPSec
  - Anti-spoofing
    - uRPF
  - Filtering

- Build a visible community of security-minded operators

- Valuable resource: [The Routing 
Manifesto](https://www.routingmanifesto.org/)

---
##    Introducing VXLAN in your network

[vxlan](http://man.openbsd.org/vxlan) - the **V**irtual e**X**tensible 
**L**ocal **A**rea **N**etwork tunnel interface
&lt;br&gt;&lt;br&gt;
- Pushes layer 2 network (Ethernet frames) over layer 3 (IP) tunnels
  - 24-bit *vnetid* (vs max 4k VLANs)
&lt;br&gt;&lt;br&gt;
- Has *no* built in security
- Intended for '*trusted*' (Datacenter, inter-hypervisor) environments
  - Otherwise, consider transport over IPSEC.
&lt;br&gt;&lt;br&gt;
- Default transport over **UDP 4789** (aka **vxlan**)
 - make sure that traffic passes between endpoints

---
#    Introducing VXLAN in your network

```shell
 # ifconfig vxlan0 tunnel 192.168.100.101 192.168.200.201 vnetid 17
 # ifconfig vxlan0 10.11.12.100/24

```
&lt;br&gt;&lt;br&gt;
```shell
 # ifconfig vxlan0 tunnel 192.168.200.201 192.168.100.101  vnetid 17
 # ifconfig vxlan0 10.11.12.101/24

```
&lt;br&gt;&lt;br&gt;
```shell
table &lt;vxendpoints&gt; { 192.168.200.201 192.168.200.204 }
pass from &lt;vxendpoints&gt; to port vxlan
```
&lt;br&gt;&lt;br&gt;
Buy [Reyk](http://www.bsdcan.org/2017/schedule/speakers/227.en.html) a 
beer.

 
---
## Readable and maintainable toolsets

- **Macros**
  - descriptive names, keep uniform
- **Tables** 
  - descriptive names
  - consider daemon/scripting interface
- **Interface groups**
  - you know egress already
  - make your own and filter on them
- **Anchors**
  - group rules by common criteria
  - tagging 
  - interface or group
- Service names vs port numbers

- **Comments** - yes, you **will** forget why this was a good idea

---
## Now let's add wireless

- Wireless used to be hard, (WPA in particular), now it's 'just another 
interface'
&lt;br&gt;&lt;br&gt;
- 802.11* support in OpenBSD has a,b,g,n but no ac yet
&lt;br&gt;&lt;br&gt;
- Not all drivers support hostap
  - check man pages before buying kit for access point use
&lt;br&gt;&lt;br&gt;
- Optionally setup with commercial APs for radio part
  - do dhcp filtering auth etc from OpenBSD

---
class: center, middle


# Questions ?
  
???

Let's ask if there are any questions before continuing.  Make sure we 
have everyone onboard.

---

class: center, middle

# Troubleshooting
  
  
### Section 6

#### "It's all your fault. Until you track down and fix the root cause."
---
## Troubleshooting 101: ICMP(v6)

- ICMP: **I**nternet **C**ontrol **M**essage **P**rotocol

- The *ping of death* scare is almost over, let's enable 
[ping](http://man.openbsd.org/ping):
&lt;br&gt;&lt;br&gt;
```shell 
  icmp_types = "{ echoreq, unreach }"
  
  pass inet proto icmp all icmp-type $icmp_types keep state
  
  pass inet proto icmp from $localnet icmp-type $icmp_types
  pass inet proto icmp to $ext_if icmp-type $icmp_types
  pass inet6 proto icmp6 from $localnet icmp6-type $icmp6_types
  pass inet6 proto icmp6 to $ext_if icmp6-type $icmp6_types
```
&lt;br&gt;&lt;br&gt;
- **echoreq**: lets [ping](http://man.openbsd.org/ping) do its thing

- **unreach**: lets you do _path MTU discovery_ (PMTUD)

---

## Troubleshooting 101: Statistics

- Statistics can be had with **[pfctl](http://man.openbsd.org/pfctl) -s 
info**

For statistics (bytes/packets passed per rule) attach _labels_ per rule

```shell 
pass log proto { tcp, udp } to $emailserver port smtp label "mail-in"
pass log proto { tcp, udp } from $emailserver to port smtp label 
"mail-out"
```

```shell
$ doas pfctl -vs rules
pass inet proto tcp from any to 192.0.2.225 port = smtp flags S/SA keep 
state label "mail-in"
[ Evaluations: 1664158 Packets: 1601986 Bytes: 763762591 States: 0 ]
[ Inserted: uid 0 pid 24490 ]
pass inet proto tcp from 192.0.2.225 to any port = smtp flags S/SA keep 
state label "mail-out"
[ Evaluations: 2814933 Packets: 2711211 Bytes: 492510664 States: 0 ]
[ Inserted: uid 0 pid 24490 ] 
```

---
## Troubleshooting 101: Statistics

- If you need to pass the data to a script
 - Or a database
 - A graphing engine

&lt;br&gt;&lt;br&gt;&lt;br&gt;

```shell
$ doas pfctl -zvsl
mail-in 1664158 1601986 763762591 887895 682427415 714091 81335176
mail-out 2814933 2711211 492510664 1407278 239776267 1303933 252734397
```

---
## Troubleshooting 101: log to pflog

Rules with the **log** keyword log packet data to the 
[pflog](http://man.openbsd.org/pflog) device(s)

```shell
# log blocked packets
block log(all)

# logs initial packet of matching connections:	
pass log proto tcp to port ssh
   
# logs all matching packets:
pass log(all) proto tcp to port ssh log(all) 

# logs matches on this and all succeeding rules
pass log(matches) proto tcp to port ssh  

# logs all packets matches on this and all succeeding rules
pass log(all, matches) proto tcp to port ssh  
```


```shell
match log(all, matches) # log *everything*
```



---
## Troubleshooting 101: tcpdump, read from pflog

- [tcpdump](https://man.openbsd.org/tcpdump) is your friend

- Let it loose on the pflog device:

```shell
$ doas tcpdump -n -e -ttt -i pflog0 
tcpdump: WARNING: snaplen raised from 116 to 160
tcpdump: listening on pflog0, link-type PFLOG
May 29 21:06:27.165561 rule def/(match) pass in on bge1: 
192.168.103.126.15526 &gt;
213.187.179.198.22: . ack 2951513182 win 16332 (DF) [tos 0x10]
May 29 21:06:27.166934 rule 16/(match) pass in on bge0: 
158.36.191.135.22 &gt;
213.187.179.198.59516: . ack 1734404306 win 64800 [tos 0x8]
May 29 21:06:27.166939 rule 2/(match) match in on bge0: 
158.36.191.135.22 &gt;
213.187.179.198.59516: . ack 1 win 64800 [tos 0x8]
May 29 21:06:27.168340 rule def/(match) pass out on bge1: 
213.187.179.198.22 &gt;
192.168.103.126.15526: P 69:153(84) ack 0 win 17520 [tos 0x10]
May 29 21:06:27.169150 rule def/(match) pass out on bge1: 
213.187.179.198.22 &gt;
192.168.103.126.15526: P 153:333(180) ack 0 win 17520 [tos 0x10]
May 29 21:06:27.169265 rule def/(match) pass out on bge1: 
213.187.179.198.22 &gt;
```

- **NB** rule number, matches your *loaded* rule set

---
## Troubleshooting 101: Hitting and avoiding limits

- On busy systems, you may need to raise limits from default values

- Check with:

```shell
$ doas pfctl -s info
```
- versus the output of **pfctl -s memory** and **pfctl -s timeouts**

- You may need to bump up from defaults:

```shell
# increase state limit from 10'000 states on busy systems
set limit states 100000
# increase no of source nodes 
set limit src-nodes 100000
```


---
## Troubleshooting 101: netflow aka pflow (IPFIX)

- Records TCP/IP *flow* metadata
  - srcIP
  - dstIP 
  - (srcPort, dstPort)
  - startTime
  - endTime 
  - Packets
  - Bytes

- OpenBSD has the [pflow(4)](http://man.openbsd.org/plflow) virtual 
network interface
  - which generates the datagrams from the state table

- Useful for network monitoring, DDoS protection, etc.

---
## Troubleshooting 101: netflow setup

- Set up a *sensor*:

```shell
$ cat /etc/hostname.pflow0
flowsrc 192.168.103.1 flowdst 192.168.103.252:9995
pflowproto 10
```

- Then configure your *collector* at the **flowdst** IP address for 
analysis and network overlordship.

&lt;br&gt;&lt;br&gt;&lt;br&gt;
- Lots of collector options available in ports: nfsen, flow-tools, 
others.

- More info:
  - Michael W. Lucas:[Network Flow 
Analysis](https://www.nostarch.com/networkflow)
  - and Peter N. M. Hansteen: [Yes, You Too Can Be An Evil Network 
Overlord - On The Cheap With OpenBSD, pflow And 
nfsen](http://bsdly.blogspot.ca/2014/02/yes-you-too-can-be-evil-network.html).


---


class:
 center, middle

# Exercise 5

  
### NAT64

---

##  NAT64

- Single-stack clients will only have IPv6
&lt;br&gt;&lt;br&gt;

- Translator box will strip all headers and replace them with IPv4
&lt;br&gt;&lt;br&gt;
- Requires some DNS magic
  - Capture responses and replace A with AAAA
  - Response is crafted based on target IPv4 address

&lt;br&gt;&lt;br&gt;
- Usually implies address sharing on IPv4


---
background-image: url(images/nat64.png)


---

## 464-XLAT

- Extension to NAT64 to access IPv4-only applications (like Skype or 
Whatsapp)
&lt;br&gt;&lt;br&gt;&lt;br&gt;

- Handset pretends there is an IPv4 address (CLAT) and sends IPv4 
packets in UDP over IPv6

---
background-image: url(images/464-xlat.png)


---

## Exercise 5 - Goals

- Define the translating prefix
  - 64:ff9b::/96 is reserved by IETF

- Add NAT64 configuration to PF

- Remove IPv4 from the internal network

- Configure DNS64 on unbound

---

## Exercise 5

- _pf.conf_

```shell
pass in quick on $int_if inet6 from any to 64:ff9b::/96 \
   af-to inet from (egress:0) keep state
```

- _unbound.conf_

```shell
module-config: "dns64 validator iterator"

dns64-prefix: 64:FF9B::/96

```

and it's done!

---

class: center, middle


# Questions ?

### Last chance...

### or questions@pftutorial.net

???

Let's ask if there are any questions before continuing.  Make sure we 
have everyone onboard.

---

## Web accessible resources

[http://www.openbsd.org/](http://www.openbsd.org/)  The official OpenBSD
 website  to donate: 
[http://www.openbsd.org/donations.html](http://www.openbsd.org/donations.html)
 and please do donate, corporates may prefer 
[https://www.openbsdfoundation.org/](https://www.openbsdfoundation.org/)
  - a Canadian non-profit

[The PF User Guide on the OpenBSD web 
site](http://www.openbsd.org/faq/index.html)

[OpenBSD online man pages](http://man.openbsd.org/)

[http://undeadly.org/](http://undeadly.org/)  - The OpenBSD Journal news
 site

[http://bsdly.blogspot.com/](http://bsdly.blogspot.com/)  - Peter's 
rants^H^H^H^H^Hblog posts

[http://www.tedunangst.com/flak/](http://www.tedunangst.com/flak/)  
tedu@ on developments

Michael W Lucas: [Absolute OpenBSD, 2nd 
ed.](https://www.nostarch.com/openbsd2e)

Peter N. M. Hansteen: [The Book of PF, 3rd 
ed.](https://www.nostarch.com/pf3)

---
background-image: url(images/end.png)
 
- 

???

Notes for this slide    
  
---
background-image: url(images/end2.png)

- 
  
???

Notes for this other slide

  
---    </textarea>
    <script src="remark-latest.js">
    </script>
    <script>
      var slideshow = remark.create({highlightLines: 'true', 
		highlightSpans: 'true',
		slideNumberFormat: '%current%'});
    </script><div class="remark-notes-area">
  <div class="remark-top-area">
    <div class="remark-toolbar">
      <a class="remark-toolbar-link" href="#increase">+</a>
      <a class="remark-toolbar-link" href="#decrease">-</a>
      <span class="remark-toolbar-timer">0:21:54</span>
    </div>
  </div>
  <div class="remark-bottom-area">
    <div class="remark-notes-current-area">
      <div class="remark-toggle">Notes for current slide</div>
      <div class="remark-notes"></div>
    </div>
    <div class="remark-notes-preview-area">
      <div class="remark-toggle">Notes for next slide</div>
      <div class="remark-notes-preview"></div>
    </div>
  </div>
</div>
<div class="remark-slides-area"><div class="remark-slide-container remark-visible"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="pf-and-networking-tutorial">PF and Networking tutorial</h1>
<h2 id="asiabsdcon-2018">AsiaBSDCon 2018</h2>
<h3 id="peter-hansteen-and-massimiliano-stucchi">Peter Hansteen and Massimiliano Stucchi</h3><div class="remark-slide-number">1</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="whoami-who-am-i-part-peter-">whoami (who am I), part Peter:</h2>
<h3 id="peter-hansteen-peter-bsdly-net-">Peter Hansteen <a href="mailto:peter@bsdly.net">peter@bsdly.net</a></h3>
<ul>
<li><p>Sysadmin, <a href="http://www.openbsd.org/">OpenBSD</a> user since before the millenium </p>
</li>
<li><p>Wrote <a href="https://www.nostarch.com/pf3">The Book of PF</a>, now in its third edition</p>
</li>
<li><p>Blog at <a href="http://bsdly.blogspot.com/">bsdly.blogspot.com</a> about (lack of) sanity in IT</p>
</li>
<li><p>Yes, I'll do another book any decade now</p>
</li>
</ul><div class="remark-slide-number">2</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="whoami-who-am-i-part-max-">whoami (who am I), part Max:</h2>
<h3 id="massimiliano-stucchi">Massimiliano Stucchi</h3>
<ul>
<li>IPv6 Programme Manager at RIPE NCC<ul>
<li>Here representing myself only</li>
</ul>
</li>
</ul>
<ul>
<li>IPv6 "Enthusiast"</li>
</ul>
<ul>
<li>@stucchimax, <a href="https://stucchi.ch/">https://stucchi.ch</a></li>
</ul><div class="remark-slide-number">3</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="introduce-yourself">Introduce yourself</h2>
<ul>
<li><p>A quick introduction about yourself:</p>
<ul>
<li><p>Your name</p>
</li>
<li><p>Your favourite BSD</p>
</li>
<li><p>Your experience with networking</p>
</li>
<li><p>Your experience with PF</p>
</li>
<li><p>Your goal(s)</p>
</li>
</ul>
</li>
</ul><div class="remark-slide-number">4</div></div></div></div><div class="remark-slide-notes"><p>This introduction serves for us to understand the level of the room, and decide on how to better suit
the tutorial.</p>
<p>Getting an idea of the level makes it so that we might quickly go through the basics, and focus on something
more advanced, rather than spend time on something that everybody knows already.</p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="agenda">Agenda</h2>
<ol>
<li>PF Basics</li>
<li>Exercise: Host configuration</li>
<li>NAT and Redirects</li>
<li>Exercise: Setup a gateway</li>
<li>Hosting Services</li>
<li>Exercise: Hosting Services, redirects</li>
<li>Traffic Shaping</li>
<li>Exercise: Setting up queueing</li>
<li>Tips</li>
<li>Troubleshooting</li>
<li>Exercise: NAT64</li>
<li>End</li>
</ol><div class="remark-slide-number">5</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="pf-basics">PF Basics</h1>
<h3 id="section-1">Section 1</h3><div class="remark-slide-number">6</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="it-all-started-with-a-copyright-violation">It all started with a copyright violation</h2>
<ul>
<li><p>OpenBSD up to 2.9 (2001) used Darren Reed's IPFilter</p>
<ul>
<li><p>Almost, but not quite BSD licensed</p>
</li>
<li><p>No right to distribute changed versions</p>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>IPFilter removed on May 29th, 2001</p>
<ul>
<li><p>First commit of the new PF code June 24 2001 at 19:48:58 UTC</p>
</li>
<li><p>OpenBSD 3.0 release pushed to Dec 1 by the extra effort</p>
</li>
</ul>
</li>
</ul>
<ul>
<li><em>License audit</em> of src tree + ports tree followed</li>
</ul>
<p>But let's jump to the present -</p><div class="remark-slide-number">7</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="network-design-101">Network design 101</h2>
<p>How to build a maintainable network:</p>
<ul>
<li><p>Start with something simple</p>
</li>
<li><p>Think dual stack (IPv6 and IPv4)</p>
</li>
<li><p>Users</p>
<ul>
<li>Access to local and remote services</li>
<li>and their security requirements</li>
</ul>
</li>
<li><p>The services you offer and the ones you consume</p>
<ul>
<li>i.e: SMTP, WWW, DNS</li>
</ul>
</li>
<li><p><strong>Keep it simple, not stupid</strong> </p>
</li>
</ul><div class="remark-slide-number">8</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="but-first-how-do-we-build-rulesets-">But first, how do we build rulesets?</h2>
<p>The basic <em>rule</em> format is, </p>
<p> <strong>verb</strong> <em>criteria</em> <strong>actions</strong> ... options</p>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line"> <span class="hljs-built_in">pass</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">port</span> ssh</div></code></pre>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line"> <span class="hljs-built_in">match</span> <span class="hljs-keyword">out</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">nat-to</span> <span class="hljs-literal">egress</span></div></code></pre>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line"> <span class="hljs-built_in">block</span> <span class="hljs-literal">all</span></div></code></pre>
<p>You can do complete rulesets with only these, but you may also want to declare things -&gt;</p>
<p>( <strong>egress</strong> ? -&gt; the <em>interface group</em> consisting of interfaces that have a default route )</p><div class="remark-slide-number">9</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="next-declarations">Next, declarations</h2>
<p>Declaring objects your rules will use:</p>
<p><strong>Macros:</strong></p>
<pre><code class="shell hljs crystal remark-code"><div class="remark-code-line"><span class="hljs-function"><span class="hljs-keyword">macro</span><span class="hljs-title">-</span></span>name = <span class="hljs-string">"definition"</span></div></code></pre>
<p><strong>Tables:</strong></p>
<pre><code class="shell hljs gams remark-code"><div class="remark-code-line"><span class="hljs-keyword">table</span> &lt;tablename&gt;</div></code></pre>
<p><strong>Queues:</strong></p>
<pre><code class="shell hljs applescript remark-code"><div class="remark-code-line">queue queuename <span class="hljs-keyword">on</span> interface bandwidth <span class="hljs-built_in">number</span> ...</div></code></pre>
<p>You can also <em>set</em> options.</p>
<p>We'll be returning to all of those, in the meantime <a href="http://man.openbsd.org/pf.conf">man pf.conf</a> is always your friend.</p><div class="remark-slide-number">10</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="block-by-default">Block by default</h2>
<ul>
<li><p>A firewall is supposed to block by default, right?</p>
</li>
<li><p>Let's start with the ruleset for a client</p>
</li>
<li><p>Useful baseline:</p>
<ul>
<li>block by default</li>
<li>pass traffic we generate</li>
</ul>
</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">    <span class="hljs-built_in">block</span></div><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">from</span> (<span class="hljs-literal">self</span>)</div></code></pre><div class="remark-slide-number">11</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="in-practice">In practice</h2>
<ul>
<li>On my laptop in my home network, that expands to:</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">    $ doas pfctl -vnf /etc/pf.conf</div><div class="remark-code-line">    <span class="hljs-built_in">block</span> drop <span class="hljs-literal">all</span></div><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">from</span> ::<span class="hljs-number">1</span> <span class="hljs-keyword">to</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">flags</span> S/SA</div><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">on</span> lo0 <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">from</span> fe80::<span class="hljs-number">1</span> <span class="hljs-keyword">to</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">flags</span> S/SA</div><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">on</span> iwm0 <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">from</span> fe80::a2a8:cdff:fe63:abb9 <span class="hljs-keyword">to</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">flags</span> S/SA</div><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">from</span> <span class="hljs-number">2001</span>:<span class="hljs-number">470</span>:<span class="hljs-number">28</span>:<span class="hljs-number">658</span>:a2a8:cdff:fe63:abb9 <span class="hljs-keyword">to</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">flags</span> S/SA</div><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">from</span> <span class="hljs-number">2001</span>:<span class="hljs-number">470</span>:<span class="hljs-number">28</span>:<span class="hljs-number">658</span>:<span class="hljs-number">8</span>c43:<span class="hljs-number">4</span>c81:e110:<span class="hljs-number">9</span>d83 <span class="hljs-keyword">to</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">flags</span> S/SA</div><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">from</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> <span class="hljs-keyword">to</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">flags</span> S/SA</div><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">from</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">103.126</span> <span class="hljs-keyword">to</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">flags</span> S/SA</div></code></pre><div class="remark-slide-number">12</div></div></div></div><div class="remark-slide-notes"><p>It would be nice in this slide to ask questions, to see the general knowledge about protocols:</p>
<ul>
<li>IPv6 LLA</li>
<li>IPv6 GUA</li>
<li>IPv6 GUA with privacy extensions</li>
<li>IPv4 Private address</li>
</ul>
<p>This can give us an idea of how to proceed with IPv6 depending on the level of the participants.</p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="anatomy-of-a-ruleset">Anatomy of a ruleset</h2>
<ul>
<li><p>Ruleset evaluated top to bottom</p>
</li>
<li><p><strong>Last match wins</strong>  (unless <em>quick</em> is used)</p>
</li>
<li><p>Stateful by default</p>
</li>
<li><p>For more details, see <a href="http://man.openbsd.org/pf.conf">man pf.conf</a></p>
<ul>
<li><a href="http://man.openbsd.org/pf.conf">http://man.openbsd.org/pf.conf</a></li>
</ul>
</li>
</ul><div class="remark-slide-number">13</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="a-ruleset-can-contain">A ruleset can contain</h2>
<ul>
<li><p><strong>Options</strong></p>
<ul>
<li>General configuration</li>
</ul>
</li>
<li><p><strong>Macros</strong></p>
<ul>
<li>Content to be expanded</li>
</ul>
</li>
<li><p><strong>Tables</strong></p>
<ul>
<li>When macros fall short</li>
</ul>
</li>
<li><p><strong>Redirections</strong></p>
</li>
<li><p><strong>Rules</strong></p>
<ul>
<li>How PF should behave</li>
</ul>
</li>
<li><p>The order of the items in the ruleset used to be important, but not anymore</p>
</li>
</ul><div class="remark-slide-number">14</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="options">Options</h2>
<ul>
<li><p>General configuration for pf</p>
</li>
<li><p>Useful for debugging, appliying default timeout values, etc.</p>
</li>
</ul>
<pre><code class="shell hljs bash remark-code"><div class="remark-code-line">    <span class="hljs-built_in">set</span> <span class="hljs-built_in">limit</span> states 100000</div></code></pre>
<ul>
<li>or</li>
</ul>
<pre><code class="shell hljs applescript remark-code"><div class="remark-code-line">    <span class="hljs-keyword">set</span> debug debug</div><div class="remark-code-line">    <span class="hljs-keyword">set</span> loginterface dc0</div><div class="remark-code-line">    <span class="hljs-keyword">set</span> <span class="hljs-keyword">timeout</span> tcp.<span class="hljs-keyword">first</span> <span class="hljs-number">120</span> </div><div class="remark-code-line">    <span class="hljs-keyword">set</span> <span class="hljs-keyword">timeout</span> tcp.established <span class="hljs-number">86400</span> </div><div class="remark-code-line">    <span class="hljs-keyword">set</span> <span class="hljs-keyword">timeout</span> { adaptive.start <span class="hljs-number">6000</span>, adaptive.<span class="hljs-keyword">end</span> <span class="hljs-number">12000</span> }</div></code></pre><div class="remark-slide-number">15</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="macros">Macros</h2>
<ul>
<li><p>Content that will later be expanded in context</p>
</li>
<li><p>Name must start with a letter, digit, or underscore</p>
</li>
<li><p>Useful to keep rulesets simple and clean</p>
</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">    ext_if = <span class="hljs-string">"kue0"</span> </div><div class="remark-code-line">    all_ifs = <span class="hljs-string">"{"</span> <span class="hljs-variable">$ext_if</span> lo0 <span class="hljs-string">"}"</span> </div><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">out</span> <span class="hljs-keyword">on</span> <span class="hljs-variable">$ext_if</span> <span class="hljs-keyword">from</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">to</span> <span class="hljs-literal">any</span> </div><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">in</span>  <span class="hljs-keyword">on</span> <span class="hljs-variable">$ext_if</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">from</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">to</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">port</span> <span class="hljs-number">25</span></div></code></pre>
<ul>
<li>Could also be port or address ranges</li>
</ul>
<pre><code class="shell hljs nix remark-code"><div class="remark-code-line">   <span class="hljs-attr">bacula_ports</span> = <span class="hljs-string">"9101:9103"</span></div><div class="remark-code-line">   <span class="hljs-attr">dmz_hosts</span> = <span class="hljs-string">"192.0.2.1 - 192.0.2.254"</span></div></code></pre><div class="remark-slide-number">16</div></div></div></div><div class="remark-slide-notes"><p>If we have more slide space, then separate the second example in its own slide</p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="tables">Tables</h2>
<ul>
<li><p>When IP address list macros grow too long, use tables instead</p>
</li>
<li><p>Hold only addresses and networks</p>
<ul>
<li>No port ranges</li>
</ul>
</li>
<li><p>Provide fast lookups</p>
</li>
</ul>
<pre><code class="shell hljs gams remark-code"><div class="remark-code-line">   <span class="hljs-keyword">table</span> &lt;bruteforce&gt; persist <span class="hljs-comment">counters</span></div></code></pre>
<ul>
<li>They can be used in rules</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">   <span class="hljs-built_in">block</span> <span class="hljs-keyword">from</span> <span class="hljs-variable">&lt;bruteforce&gt;</span></div></code></pre>
<ul>
<li>Unlike macros with port or address lists, <em>do not</em> expand to multiple rules<ul>
<li>More optimised ruleset</li>
</ul>
</li>
</ul><div class="remark-slide-number">17</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="tables-continued">Tables continued</h2>
<ul>
<li>Content can be loaded from files or from CLI</li>
</ul>
<pre><code class="shell hljs gams remark-code"><div class="remark-code-line">    <span class="hljs-keyword">table</span> &lt;popflooders&gt; persist <span class="hljs-comment">counters file</span> <span class="hljs-comment">"/var/tmp/popflooders"</span></div></code></pre>
<ul>
<li>use <a href="http://man.openbsd.org/pfctl">pfctl</a> to add/remove entries from command line</li>
</ul>
<pre><code class="shell hljs elixir remark-code"><div class="remark-code-line">   <span class="hljs-variable">$ </span>doas pfctl -t bruteforce -T add <span class="hljs-number">192.0</span>.<span class="hljs-number">2.11</span> <span class="hljs-number">2001</span><span class="hljs-symbol">:db8</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:dead</span><span class="hljs-symbol">:beef</span><span class="hljs-symbol">:baad</span><span class="hljs-symbol">:f00d</span></div></code></pre>
<ul>
<li>optionally maintained by daemons such as <a href="http://man.openbsd.org/spamd">spamd</a>, <a href="http://man.openbsd.org/bgpd">bgpd</a> and <a href="http://man.openbsd.org/dhcpd">dhcpd</a></li>
</ul><div class="remark-slide-number">18</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h2 id="implementing-your-spec">Implementing your spec</h2>
<h3 id="how-would-you-do-this-in-your-home-soho-infrastructure-">How would you do this in your home/soho infrastructure ?</h3><div class="remark-slide-number">19</div></div></div></div><div class="remark-slide-notes"><p>We ask the participants how they think they would implement this in their infrastructure.</p>
<p>This is to create discussion, and hopefully make it so that we all learn a bit by trial-and-error.</p>
<p>Let's put out the question, wait for some time to see if anyone comes
 up with a nice description, and then walk them through what is a 
sensible setup.</p>
<p>This is in preparation for the first exercise which comes next.</p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="exercise-1">Exercise 1</h1>
<h3 id="protecting-your-host">Protecting your host</h3><div class="remark-slide-number">20</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="excercise-1-let-s-start">Excercise 1 - Let's start</h2>
<ul>
<li><p>Lab environment:</p>
<ul>
<li>Open your favourite browser, then</li>
<li>Go to <a href="https://labs.pftutorial.net/">labs.pftutorial.net</a></li>
</ul>
</li>
<li><p>check that pf is indeed loaded and running (<em>hint</em>: <a href="http://man.openbsd.org/pfctl">pfctl</a>)</p>
</li>
<li><p>Try accessing other lab hosts</p>
</li>
</ul><div class="remark-slide-number">21</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-1-net-config">Exercise 1 - net config</h2>
<ul>
<li><p>Configure the external interface on gateway</p>
</li>
<li><p><em>vi /etc/hostname.re0</em></p>
</li>
</ul>
<pre><code class="shell hljs groovy remark-code"><div class="remark-code-line">        inet <span class="hljs-number">10.255</span><span class="hljs-number">.255</span>.XX/<span class="hljs-number">24</span></div><div class="remark-code-line">        !route add <span class="hljs-number">0</span>/<span class="hljs-number">0</span> <span class="hljs-number">10.255</span><span class="hljs-number">.255</span><span class="hljs-number">.254</span></div><div class="remark-code-line">        inet6 <span class="hljs-string">fd18:</span><span class="hljs-string">b5d:</span><span class="hljs-string">cafe:</span>:XX/<span class="hljs-number">64</span></div><div class="remark-code-line">        !route add -<span class="hljs-string">inet6 :</span>:/<span class="hljs-number">0</span> <span class="hljs-string">fd18:</span><span class="hljs-string">b5d:</span><span class="hljs-string">cafe:</span>:a</div></code></pre>
<ul>
<li>and then <em>vi /etc/resolv.conf</em></li>
</ul>
<pre><code class="shell hljs css remark-code"><div class="remark-code-line">    <span class="hljs-selector-tag">nameserver</span> 10<span class="hljs-selector-class">.255</span><span class="hljs-selector-class">.255</span><span class="hljs-selector-class">.254</span></div><div class="remark-code-line">    <span class="hljs-selector-tag">nameserver</span> <span class="hljs-selector-tag">fd18</span><span class="hljs-selector-pseudo">:b5d</span><span class="hljs-selector-pseudo">:cafe</span><span class="hljs-selector-pseudo">::a</span></div></code></pre>
<p>followed by </p>
<pre><code class="shell hljs awk remark-code"><div class="remark-code-line">    sh <span class="hljs-regexp">/etc/</span>netstart</div></code></pre><div class="remark-slide-number">22</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-1-on-gateway">Exercise 1 - on gateway</h2>
<ul>
<li>Start with a block ruleset</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">    <span class="hljs-built_in">block</span></div><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">quick</span> <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">from</span> fd18::/<span class="hljs-number">16</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> ssh</div></code></pre>
<ul>
<li>Allow traffic to be generated from your host</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">from</span> <span class="hljs-literal">self</span></div></code></pre>
<p>and then, reload <em>pf.conf</em></p>
<pre><code class="shell hljs stylus remark-code"><div class="remark-code-line">   pfctl -vnf /etc/pf<span class="hljs-selector-class">.conf</span></div><div class="remark-code-line">   pfctl -f /etc/pf<span class="hljs-selector-class">.conf</span></div></code></pre>
<ul>
<li><strong>NB:</strong> Reload pf this way after every statement in the exercises</li>
</ul><div class="remark-slide-number">23</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-1-tests">Exercise 1 - Tests</h2>
<ul>
<li><p>From your gateway ping a host</p>
</li>
<li><p>First IPv6</p>
</li>
</ul>
<pre><code class="shell hljs livecodeserver remark-code"><div class="remark-code-line"> <span class="hljs-comment"># ping6 fd18:b5d:cafe::a</span></div><div class="remark-code-line"> PING fd18:b5d:cafe::<span class="hljs-keyword">a</span> (fd18:b5d:cafe::<span class="hljs-keyword">a</span>): <span class="hljs-number">56</span> data <span class="hljs-keyword">bytes</span></div><div class="remark-code-line"> <span class="hljs-number">64</span> <span class="hljs-keyword">bytes</span> <span class="hljs-built_in">from</span> fd18:b5d:cafe::<span class="hljs-keyword">a</span>: icmp_seq=<span class="hljs-number">0</span> hlim=<span class="hljs-number">64</span> <span class="hljs-built_in">time</span>=<span class="hljs-number">0.548</span> ms</div><div class="remark-code-line"> <span class="hljs-number">64</span> <span class="hljs-keyword">bytes</span> <span class="hljs-built_in">from</span> fd18:b5d:cafe::<span class="hljs-keyword">a</span>: icmp_seq=<span class="hljs-number">1</span> hlim=<span class="hljs-number">64</span> <span class="hljs-built_in">time</span>=<span class="hljs-number">0.492</span> ms</div><div class="remark-code-line"> <span class="hljs-number">64</span> <span class="hljs-keyword">bytes</span> <span class="hljs-built_in">from</span> fd18:b5d:cafe::<span class="hljs-keyword">a</span>: icmp_seq=<span class="hljs-number">2</span> hlim=<span class="hljs-number">64</span> <span class="hljs-built_in">time</span>=<span class="hljs-number">0.494</span> ms</div></code></pre>
<ul>
<li>Then IPv4</li>
</ul>
<pre><code class="shell hljs livecodeserver remark-code"><div class="remark-code-line"> <span class="hljs-comment"># ping stucchi.ch</span></div><div class="remark-code-line"> PING stucchi.ch (<span class="hljs-number">37.59</span><span class="hljs-number">.51</span><span class="hljs-number">.141</span>): <span class="hljs-number">56</span> data <span class="hljs-keyword">bytes</span></div><div class="remark-code-line"> <span class="hljs-number">64</span> <span class="hljs-keyword">bytes</span> <span class="hljs-built_in">from</span> <span class="hljs-number">37.59</span><span class="hljs-number">.51</span><span class="hljs-number">.141</span>: icmp_seq=<span class="hljs-number">0</span> ttl=<span class="hljs-number">56</span> <span class="hljs-built_in">time</span>=<span class="hljs-number">6.264</span> ms</div><div class="remark-code-line"> <span class="hljs-number">64</span> <span class="hljs-keyword">bytes</span> <span class="hljs-built_in">from</span> <span class="hljs-number">37.59</span><span class="hljs-number">.51</span><span class="hljs-number">.141</span>: icmp_seq=<span class="hljs-number">1</span> ttl=<span class="hljs-number">56</span> <span class="hljs-built_in">time</span>=<span class="hljs-number">6.273</span> ms</div><div class="remark-code-line"> <span class="hljs-number">64</span> <span class="hljs-keyword">bytes</span> <span class="hljs-built_in">from</span> <span class="hljs-number">37.59</span><span class="hljs-number">.51</span><span class="hljs-number">.141</span>: icmp_seq=<span class="hljs-number">2</span> ttl=<span class="hljs-number">56</span> <span class="hljs-built_in">time</span>=<span class="hljs-number">6.117</span> ms</div></code></pre><div class="remark-slide-number">24</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-1-wrap-up">Exercise 1 - Wrap up</h2>
<ul>
<li><p>Does ping work?</p>
</li>
<li><p>Do other commands work?</p>
<ul>
<li>working from total block, proceed to make restricted workstation</li>
<li>name resolution</li>
<li><em>http</em> and <em>https</em></li>
</ul>
</li>
<li><p>Access public web sites, other Internet resources.</p>
</li>
<li><p>What would it take to access the other lab hosts?</p>
</li>
</ul><div class="remark-slide-number">25</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="questions-">Questions ?</h1><div class="remark-slide-number">26</div></div></div></div><div class="remark-slide-notes"><p>Let's ask if there are any questions before continuing.  Make sure we have everyone onboard.</p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="gateway-nat-and-redirects">Gateway, NAT and Redirects</h1>
<h3 id="section-2">Section 2</h3><div class="remark-slide-number">27</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="easy-how-do-we-improve-on-this-">Easy! How do we improve on this?</h2>
<ul>
<li><p>Make a 'firewall':</p>
<ul>
<li><p>a point of policy enforcement</p>
</li>
<li><p>a gateway</p>
</li>
<li><p>filter for other hosts</p>
</li>
<li><p>redirection tricks</p>
</li>
</ul>
</li>
</ul><div class="remark-slide-number">28</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="introducing-nat">Introducing NAT</h2>
<ul>
<li><p><strong>N</strong>etwork <strong>A</strong>ddress <strong>T</strong>ranslation (<a href="https://tools.ietf.org/html/rfc1631">RFC1631</a> onwards)</p>
</li>
<li><p>-&gt; 'Hide' several hosts behind 1 public address, using <a href="https://tools.ietf.org/html/rfc1918">RFC1918</a> addresses</p>
</li>
<li><p>Modern PF has <em>nat-to</em> on 'pass' and 'match' rules:</p>
</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">    <span class="hljs-built_in">match</span> <span class="hljs-keyword">out</span> <span class="hljs-keyword">on</span> <span class="hljs-variable">$extif</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">nat-to</span> (<span class="hljs-variable">$extif</span>)</div></code></pre>
<ul>
<li><em>Neat trick</em>: egress is the interface group that has a default route, you can filter on it</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">    <span class="hljs-built_in">match</span> <span class="hljs-keyword">out</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">nat-to</span> (<span class="hljs-literal">egress</span>)</div></code></pre>
<ul>
<li>In modern networks we <strong>should</strong> (also) have IPv6 (inet6)</li>
</ul><div class="remark-slide-number">29</div></div></div></div><div class="remark-slide-notes"><p>NAT,
 the stopgap measure that's old enough to drink, more than 22 years old.
  NAT was created as a temporary measure that hasn't been replaced by 
now.  Not even IPv6.</p>
<p>We haven't discusses "egress" yet, so this is the right time to introduce it.</p>
<p>Spend some time discussing it, along with the rest of the NAT specifications.</p>
<p>Unfortunately, there's also NAT for IPv6, called NAT66</p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="a-filtering-gateway">A (filtering) Gateway</h2>
<p><em>"I decide which packets pass"</em></p>
<h4 id="enable-forwarding-">Enable forwarding:</h4>
<ul>
<li>Temporarily set from command line with <a href="http://man.openbsd.org/sysctl">sysctl</a>:</li>
</ul>
<pre><code class="shell hljs cpp remark-code"><div class="remark-code-line">    <span class="hljs-meta"># sysctl net.inet.ip.forwarding=1 </span></div><div class="remark-code-line">    <span class="hljs-meta"># sysctl net.inet6.ip6.forwarding=1</span></div></code></pre>
<ul>
<li>Make permanent in <a href="http://man.openbsd.org/sysctl.conf">/etc/sysctl.conf</a></li>
</ul>
<pre><code class="shell hljs stylus remark-code"><div class="remark-code-line">    net<span class="hljs-selector-class">.inet</span><span class="hljs-selector-class">.ip</span><span class="hljs-selector-class">.forwarding</span>=<span class="hljs-number">1</span></div><div class="remark-code-line">    net<span class="hljs-selector-class">.inet6</span><span class="hljs-selector-class">.ip6</span><span class="hljs-selector-class">.forwarding</span>=<span class="hljs-number">1</span></div></code></pre><div class="remark-slide-number">30</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="the-minimal-gateway">The minimal gateway</h2>
<ul>
<li><p>Do you <em>NAT</em> for IPv4? Of course you do.</p>
</li>
<li><p>Do you run IPv6? Of course you do.</p>
</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">    ext_if=bge0</div><div class="remark-code-line">    int_if=bge1</div><div class="remark-code-line">    <span class="hljs-built_in">match</span> <span class="hljs-keyword">out</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">nat-to</span> (<span class="hljs-variable">$ext_if</span>)</div><div class="remark-code-line">    <span class="hljs-built_in">block</span> <span class="hljs-literal">all</span></div><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">from</span> { <span class="hljs-literal">self</span>, <span class="hljs-variable">$int_if</span>:network }</div></code></pre>
<ul>
<li>The "pass" rule, withouth <em>inet</em> or <em>inet6</em> applies to both</li>
</ul>
<p><strong>Keep in mind</strong>: This is a point of policy enforcement</p><div class="remark-slide-number">31</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="a-point-of-policy-enforcement">A Point of policy enforcement</h2>
<ul>
<li>Now some policy, and macros</li>
</ul>
<pre><code class="shell hljs stata remark-code"><div class="remark-code-line">  ext_if=bge0</div><div class="remark-code-line">  int_if=bge1</div><div class="remark-code-line"></div><div class="remark-code-line">  client_out = "{ ftp-data, ftp, ssh, domain, pop3, auth, nntp, http, \</div><div class="remark-code-line">      https, 2628, 5999, 8000, 8080 }</div><div class="remark-code-line">  udp_services = <span class="hljs-string">"{ domain, ntp }"</span></div><div class="remark-code-line"></div><div class="remark-code-line">  match <span class="hljs-keyword">out</span> <span class="hljs-keyword">on</span> egress inet nat-to (<span class="hljs-variable">$ext_if</span>)</div><div class="remark-code-line remark-code-line-highlighted">  block</div><div class="remark-code-line remark-code-line-highlighted">  pass quick proto { tcp, udp } to port <span class="hljs-variable">$udp_services</span> <span class="hljs-keyword">keep</span> state</div><div class="remark-code-line remark-code-line-highlighted"></div><div class="remark-code-line remark-code-line-highlighted">  pass proto tcp from <span class="hljs-variable">$int_if</span>:network to port <span class="hljs-variable">$client_out</span></div><div class="remark-code-line remark-code-line-highlighted"></div><div class="remark-code-line remark-code-line-highlighted">  pass proto tcp to self port ssh</div></code></pre>
<ul>
<li>What services do your clients consume?</li>
</ul><div class="remark-slide-number">32</div></div></div></div><div class="remark-slide-notes"><p>Log to on the system we have for showing out, and then show the rules there and how they expand to different parts.</p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="letting-dhcpd-8-direct-access">Letting dhcpd(8) direct access</h2>
<p>OpenBSD <a href="http://man.openbsd.org/dhcpd">dhcpd(8)</a> can interact with your ruleset via tables:</p>
<p><em>/etc/rc.conf.local</em></p>
<pre><code class="shell hljs ini remark-code"><div class="remark-code-line"><span class="hljs-attr">dhcpd_flags</span>=<span class="hljs-string">"-L leased_ip_table -A abandoned_ip_table -C changed_ip_table bge1"</span></div></code></pre>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">  ext_if=bge0</div><div class="remark-code-line">  int_if=bge1</div><div class="remark-code-line remark-code-line-highlighted">  <span class="hljs-built_in">table</span> <span class="hljs-variable">&lt;abandoned_ip_table&gt;</span> persist <span class="hljs-keyword">counters</span></div><div class="remark-code-line remark-code-line-highlighted">  <span class="hljs-built_in">table</span> <span class="hljs-variable">&lt;changed_ip_table&gt;</span> persist <span class="hljs-keyword">counters</span></div><div class="remark-code-line remark-code-line-highlighted">  <span class="hljs-built_in">table</span> <span class="hljs-variable">&lt;leased_ip_table&gt;</span> persist <span class="hljs-keyword">counters</span></div><div class="remark-code-line"></div><div class="remark-code-line">  client_out = <span class="hljs-string">"{ ftp-data, ftp, ssh, domain, pop3, auth, nntp, http, \</span></div><div class="remark-code-line">                  https, 2628, 5999, 8000, 8080 }"</div><div class="remark-code-line">  udp_services = <span class="hljs-string">"{ domain, ntp }"</span></div><div class="remark-code-line"></div><div class="remark-code-line">  <span class="hljs-built_in">match</span> <span class="hljs-keyword">out</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">nat-to</span> (<span class="hljs-variable">$ext_if</span>)</div><div class="remark-code-line">  <span class="hljs-built_in">block</span></div><div class="remark-code-line">  <span class="hljs-built_in">pass</span> <span class="hljs-keyword">quick</span> <span class="hljs-keyword">proto</span> { tcp, udp } <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$udp_services</span> <span class="hljs-keyword">keep</span> <span class="hljs-keyword">state</span></div><div class="remark-code-line remark-code-line-highlighted">  <span class="hljs-built_in">pass</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">from</span> <span class="hljs-variable">&lt;leased_ip_table&gt;</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$client_out</span></div><div class="remark-code-line">  <span class="hljs-built_in">pass</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-literal">self</span> <span class="hljs-keyword">port</span> ssh</div></code></pre>
<p><strong>=&gt;</strong> only pass traffic from hosts with active leases from <em>me</em></p><div class="remark-slide-number">33</div></div></div></div><div class="remark-slide-notes"><p>Maybe move this slide to a later section.</p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="redirects-and-divert-to-">Redirects (and divert-to)</h2>
<p>  Modern PF has two classes of redirect</p>
<ul>
<li><strong>rdr-to</strong> on match and pass rules - rewrite destination address while filtering (locally or even to other hosts)</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">      <span class="hljs-built_in">pass</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> www <span class="hljs-keyword">rdr-to</span> <span class="hljs-variable">$webserver</span></div></code></pre>
<ul>
<li><strong>divert-to</strong> on match and pass rules - <a href="http://man.openbsd.org/divert">divert()</a> socket for local use</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">      <span class="hljs-built_in">pass</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> smtp <span class="hljs-keyword">divert-to</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> <span class="hljs-keyword">port</span> spamd</div></code></pre><div class="remark-slide-number">34</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="ftp-proxy">FTP Proxy</h2>
<ul>
<li><p>If your users need to access FTP services, <a href="http://man.openbsd.org/ftp-proxy">ftp-proxy</a> is what you need</p>
</li>
<li><p>FTP does not easily pass through a block firewall, some help is needed</p>
</li>
</ul>
<pre><code class="shell hljs bash remark-code"><div class="remark-code-line">$ doas rcctl <span class="hljs-built_in">enable</span> ftpproxy6</div></code></pre>
<ul>
<li>or for IPv4</li>
</ul>
<pre><code class="shell hljs bash remark-code"><div class="remark-code-line">$ doas rcctl <span class="hljs-built_in">enable</span> ftpproxy</div></code></pre>
<ul>
<li>and then add an anchor and divert rules to your config</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line"><span class="hljs-built_in">anchor</span> <span class="hljs-string">"ftp-proxy/*"</span></div><div class="remark-code-line">  ... </div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">quick</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">proto</span>  tcp <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> ftp <span class="hljs-keyword">divert-to</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> <span class="hljs-keyword">port</span> <span class="hljs-number">8021</span></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">quick</span> <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> ftp <span class="hljs-keyword">divert-to</span> ::<span class="hljs-number">1</span> <span class="hljs-keyword">port</span> <span class="hljs-number">8021</span></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">out</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">from</span> <span class="hljs-variable">$proxy</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> ftp</div></code></pre>
<p>There is even a reverse mode (<strong>-R</strong>) for when you host FTP servers, see <a href="http://man.openbsd.org/ftp-proxy">man ftp-proxy</a></p><div class="remark-slide-number">35</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="exercise-2">Exercise 2</h1>
<h3 id="protecting-your-network">Protecting your network</h3><div class="remark-slide-number">36</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-2-goals">Exercise 2 - Goals</h2>
<ul>
<li><p>Your network grows, you become a gateway</p>
</li>
<li><p>Extend the configuration to enable the network to access the internet</p>
</li>
</ul><div class="remark-slide-number">37</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default" style="background-image: url(&quot;images/exercise2.png&quot;);"><h2 id="exercise-2-your-network">Exercise 2 - Your network</h2><div class="remark-slide-number">38</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-2">Exercise 2</h2>
<ul>
<li>Turn on ip forwarding (sysctl)</li>
</ul>
<pre><code class="shell hljs cpp remark-code"><div class="remark-code-line">    <span class="hljs-meta"># sysctl net.inet.ip.forwarding=1 </span></div><div class="remark-code-line">    <span class="hljs-meta"># sysctl net.inet6.ip6.forwarding=1</span></div></code></pre>
<ul>
<li>Set up NAT</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">    <span class="hljs-built_in">match</span> <span class="hljs-keyword">out</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">nat-to</span> (<span class="hljs-literal">egress</span>)</div></code></pre>
<p>Also, pass traffic from that local net</p><div class="remark-slide-number">39</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-2-check-your-results">Exercise 2 - check your results</h2>
<ul>
<li><p>From client 1, ping a host on the internet</p>
</li>
<li><p>First IPv6</p>
</li>
</ul>
<pre><code class="shell hljs livecodeserver remark-code"><div class="remark-code-line"> <span class="hljs-comment"># ping6 stucchi.ch</span></div><div class="remark-code-line"> PING stucchi.ch (<span class="hljs-number">2001</span>:<span class="hljs-number">41</span>d0:<span class="hljs-number">8</span>:<span class="hljs-number">6</span>ed8::<span class="hljs-number">80</span>): <span class="hljs-number">56</span> data <span class="hljs-keyword">bytes</span></div><div class="remark-code-line"> <span class="hljs-number">64</span> <span class="hljs-keyword">bytes</span> <span class="hljs-built_in">from</span> <span class="hljs-number">2001</span>:<span class="hljs-number">41</span>d0:<span class="hljs-number">8</span>:<span class="hljs-number">6</span>ed8::<span class="hljs-number">80</span>: icmp_seq=<span class="hljs-number">1</span> hlim=<span class="hljs-number">56</span> <span class="hljs-built_in">time</span>=<span class="hljs-number">7.414</span> ms</div><div class="remark-code-line"> <span class="hljs-number">64</span> <span class="hljs-keyword">bytes</span> <span class="hljs-built_in">from</span> <span class="hljs-number">2001</span>:<span class="hljs-number">41</span>d0:<span class="hljs-number">8</span>:<span class="hljs-number">6</span>ed8::<span class="hljs-number">80</span>: icmp_seq=<span class="hljs-number">2</span> hlim=<span class="hljs-number">56</span> <span class="hljs-built_in">time</span>=<span class="hljs-number">6.333</span> ms</div><div class="remark-code-line"> <span class="hljs-number">64</span> <span class="hljs-keyword">bytes</span> <span class="hljs-built_in">from</span> <span class="hljs-number">2001</span>:<span class="hljs-number">41</span>d0:<span class="hljs-number">8</span>:<span class="hljs-number">6</span>ed8::<span class="hljs-number">80</span>: icmp_seq=<span class="hljs-number">3</span> hlim=<span class="hljs-number">56</span> <span class="hljs-built_in">time</span>=<span class="hljs-number">6.441</span> ms</div></code></pre>
<ul>
<li>Then IPv4</li>
</ul>
<pre><code class="shell hljs livecodeserver remark-code"><div class="remark-code-line"> <span class="hljs-comment"># ping stucchi.ch</span></div><div class="remark-code-line"> PING stucchi.ch (<span class="hljs-number">37.59</span><span class="hljs-number">.51</span><span class="hljs-number">.141</span>): <span class="hljs-number">56</span> data <span class="hljs-keyword">bytes</span></div><div class="remark-code-line"> <span class="hljs-number">64</span> <span class="hljs-keyword">bytes</span> <span class="hljs-built_in">from</span> <span class="hljs-number">37.59</span><span class="hljs-number">.51</span><span class="hljs-number">.141</span>: icmp_seq=<span class="hljs-number">0</span> ttl=<span class="hljs-number">56</span> <span class="hljs-built_in">time</span>=<span class="hljs-number">6.264</span> ms</div><div class="remark-code-line"> <span class="hljs-number">64</span> <span class="hljs-keyword">bytes</span> <span class="hljs-built_in">from</span> <span class="hljs-number">37.59</span><span class="hljs-number">.51</span><span class="hljs-number">.141</span>: icmp_seq=<span class="hljs-number">1</span> ttl=<span class="hljs-number">56</span> <span class="hljs-built_in">time</span>=<span class="hljs-number">6.273</span> ms</div><div class="remark-code-line"> <span class="hljs-number">64</span> <span class="hljs-keyword">bytes</span> <span class="hljs-built_in">from</span> <span class="hljs-number">37.59</span><span class="hljs-number">.51</span><span class="hljs-number">.141</span>: icmp_seq=<span class="hljs-number">2</span> ttl=<span class="hljs-number">56</span> <span class="hljs-built_in">time</span>=<span class="hljs-number">6.117</span> ms</div></code></pre><div class="remark-slide-number">40</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h1 id="exercise-2b-ftp">Exercise 2b: FTP</h1>
<p>Try fetching <em>ftp://ftp.ripe.net/pub/stats/ripencc/delegated-ripencc-extended-latest</em></p>
<p>Check your result</p>
<p>If it didn't work, configure FTP-proxy and try again.</p><div class="remark-slide-number">41</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="hosting-services">Hosting Services</h1>
<h3 id="section-3">Section 3</h3><div class="remark-slide-number">42</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="hosting-services-behind-your-gateway">Hosting services behind your gateway</h2>
<ul>
<li><p>Now you actually want some 'pass in on egress' rules :)</p>
</li>
<li><p>Get your specifications clear, put in writing:</p>
<ul>
<li>your services and the ports they use</li>
<li><p>the names could be in <strong>/etc/services</strong> already</p>
</li>
<li><p>the hosts (IP addresses) that run the services</p>
</li>
<li><p>decide who/what/where to be reachable for/from</p>
</li>
</ul>
</li>
<li><p>Check services requiring extra help (i.e. proxying).</p>
</li>
</ul><div class="remark-slide-number">43</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="proxies-and-other-helpers">Proxies and other helpers</h2>
<ul>
<li><p>OpenBSD comes with several proxies and other service helper programs in the base system:</p>
<ul>
<li><p><a href="http://man.openbsd.org/ftp-proxy">ftp-proxy</a> (you guessed it)</p>
</li>
<li><p><a href="http://man.openbsd.org/relayd">relayd</a> (load balancing and lots more)</p>
</li>
<li><p><a href="http://man.openbsd.org/spamd">spamd</a> (if you run SMTP - annoy spammers)</p>
</li>
</ul>
</li>
</ul>
<p><br><br><br></p>
<ul>
<li>There are also such things as squid and varnish (web proxies) in packages</li>
</ul>
<p><br><br><br></p>
<ul>
<li>Clients and services in the same subnet? Or do the DMZs?</li>
</ul><div class="remark-slide-number">44</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="dmz-defined">DMZ, defined</h2>
<h3 id="-d-e-m-ilitarized-z-one-">'<em>D</em>e-<em>M</em>ilitarized <em>Z</em>one'</h3>
<ul>
<li>when a group of host needs special treatment </li>
</ul>
<p><br><br></p>
<ul>
<li>attached to separate interfaces(s), separate sub-rulesets</li>
</ul>
<p><br><br></p>
<ul>
<li>And <strong>YES</strong>, you can have several</li>
</ul>
<p><br><br></p>
<ul>
<li>Think multiple customers, <em>N</em> environments each</li>
</ul><div class="remark-slide-number">45</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content right hljs-default" style="background-image: url(&quot;images/exercise3.png&quot;);"><h2 id="dmz-illustrated">DMZ, illustrated</h2><div class="remark-slide-number">46</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="allowing-some-services-in">Allowing some services in</h2>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">    ext_if=bge0 <span class="hljs-comment"># adjust to what your system has</span></div><div class="remark-code-line">    int_if=bge1 <span class="hljs-comment"># adjust to what your system has</span></div><div class="remark-code-line"></div><div class="remark-code-line">    client_out = <span class="hljs-string">"{ ftp-data, ftp, ssh, domain, pop3, auth, nntp, http, \</span></div><div class="remark-code-line">                https, 2628, 5999, 8000, 8080 }"</div><div class="remark-code-line">    udp_services = <span class="hljs-string">"{ domain, ntp }"</span></div><div class="remark-code-line"></div><div class="remark-code-line remark-code-line-highlighted">    webserver = <span class="hljs-string">"192.0.2.227"</span></div><div class="remark-code-line remark-code-line-highlighted">    webports = <span class="hljs-string">"{ http, https }"</span></div><div class="remark-code-line remark-code-line-highlighted">    emailserver = <span class="hljs-string">"192.0.2.225"</span></div><div class="remark-code-line remark-code-line-highlighted">    email = <span class="hljs-string">"{ smtp, pop3, imap, imap3, imaps, pop3s }"</span></div><div class="remark-code-line remark-code-line-highlighted">    nameservers = <span class="hljs-string">"{ 192.0.2.221, 192.0.2.223 }"</span></div><div class="remark-code-line"></div><div class="remark-code-line">    <span class="hljs-built_in">match</span> <span class="hljs-keyword">out</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">nat-to</span> (<span class="hljs-variable">$ext_if</span>)</div><div class="remark-code-line">    <span class="hljs-built_in">block</span></div><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">quick</span> <span class="hljs-keyword">proto</span> { tcp, udp } <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$udp_services</span> <span class="hljs-keyword">keep</span> <span class="hljs-keyword">state</span></div><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">from</span> <span class="hljs-variable">$int_if</span>:network <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$client_out</span></div><div class="remark-code-line">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-literal">self</span> <span class="hljs-keyword">port</span> ssh</div><div class="remark-code-line"></div><div class="remark-code-line remark-code-line-highlighted">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-variable">$webserver</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$webports</span> </div><div class="remark-code-line remark-code-line-highlighted">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-variable">$emailserver</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$email</span> </div><div class="remark-code-line remark-code-line-highlighted">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">log</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">from</span> <span class="hljs-variable">$emailserver</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> smtp </div><div class="remark-code-line remark-code-line-highlighted">    <span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">proto</span> { tcp, udp } <span class="hljs-keyword">to</span> <span class="hljs-variable">$nameservers</span> <span class="hljs-keyword">port</span> domain</div></code></pre>
<p>Now try loading this with <em>pfctl -vnf /etc/pf.conf</em> and see what this expands to (you can also fetch <a href="https://home.nuug.no/~peter/pftutorial/samples/pf.services01.conf">pf.services01.conf</a> and try)</p><div class="remark-slide-number">47</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="tackling-noise-attacks-with-state-tracking-options">Tackling noise (attacks) with state-tracking options</h2>
<h3 id="scenario-ssh-bruteforcers">Scenario: ssh bruteforcers</h3>
<p>In our previous ruleset, add </p>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line"><span class="hljs-built_in">table</span> <span class="hljs-variable">&lt;bruteforce&gt;</span> persist <span class="hljs-keyword">counters</span></div><div class="remark-code-line"><span class="hljs-built_in">block</span> <span class="hljs-keyword">from</span> <span class="hljs-variable">&lt;bruteforce&gt;</span></div></code></pre>
<p>and change the <strong>ssh</strong> rule to</p>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line remark-code-line-highlighted">  <span class="hljs-built_in">pass</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> ssh <span class="hljs-keyword">flags</span> S/SA <span class="hljs-keyword">keep</span> <span class="hljs-keyword">state</span> \</div><div class="remark-code-line remark-code-line-highlighted">    (max-src-conn <span class="hljs-number">15</span>, max-src-conn-rate <span class="hljs-number">2</span>/<span class="hljs-number">10</span>, <span class="hljs-keyword">overload</span> <span class="hljs-variable">&lt;bruteforce&gt;</span> flush <span class="hljs-keyword">global</span>)</div></code></pre>
<ul>
<li>Tune to taste</li>
<li>More info on options in <a href="http://man.openbsd.org/pf.conf">man pf.conf</a></li>
<li>Remember <em><a href="http://man.openbsd.org/pfctl">pfctl</a> expire</em></li>
</ul><div class="remark-slide-number">48</div></div></div></div><div class="remark-slide-notes"><p>max-src-conn - see man page but max number of simultaneous connections from one host
max-src-conn-rate - number of new connections per number of seconds </p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="tackling-noise-attacks-with-state-tracking-options">Tackling noise (attacks) with state-tracking options</h2>
<h3 id="scenario-wordpress-site">Scenario: Wordpress site</h3>
<ul>
<li><p>Wordpress is a usual target for many different attacks</p>
</li>
<li><p>-&gt; Make the attackers suffer by forcing them through smaller "windows"</p>
<ul>
<li>Use tables and block by connection rates</li>
</ul>
</li>
<li><p>Mix and match settings, consult <a href="http://man.openbsd.org/pf.conf">man pf.conf</a> and remember <em><a href="http://man.openbsd.org/pfctl">pfctl</a> expire</em></p>
</li>
<li><p>Also see <a href="http://bsdly.blogspot.ca/2017/04/forcing-password-gropers-through.html">Forcing the password gropers through a smaller hole with OpenBSD's PF queues</a> + <a href="https://www.nostarch.com/pf3">The Book of PF</a></p>
</li>
</ul><div class="remark-slide-number">49</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="scenario-wordpress-site">Scenario: Wordpress site</h2>
<ul>
<li>You can re-use the <em>bruteforce</em> table or make a separate one, like</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">  <span class="hljs-built_in">table</span> <span class="hljs-variable">&lt;web_brutes&gt;</span> persist <span class="hljs-keyword">counters</span></div><div class="remark-code-line">  <span class="hljs-built_in">block</span> <span class="hljs-keyword">from</span> <span class="hljs-variable">&lt;web_brutes&gt;</span></div></code></pre>
<ul>
<li>Now change the <strong>$webports</strong> rule to</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line remark-code-line-highlighted">  <span class="hljs-built_in">pass</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$webports</span> <span class="hljs-keyword">flags</span> S/SA <span class="hljs-keyword">keep</span> <span class="hljs-keyword">state</span> \</div><div class="remark-code-line remark-code-line-highlighted">    (max-src-conn <span class="hljs-number">15</span>, max-src-conn-rate <span class="hljs-number">5</span>/<span class="hljs-number">10</span>, <span class="hljs-keyword">overload</span> <span class="hljs-variable">&lt;web_brutes&gt;</span> flush <span class="hljs-keyword">global</span>)</div></code></pre>
<ul>
<li>Alternatively, on a machine (the gateway) that does not run Wordpress, do</li>
</ul>
<pre><code class="shell hljs vim remark-code"><div class="remark-code-line">  <span class="hljs-keyword">grep</span> <span class="hljs-keyword">wp</span>-login /var/www/logs/access.<span class="hljs-built_in">log</span> | awk <span class="hljs-string">'{print $1}'</span> | \ </div><div class="remark-code-line">    <span class="hljs-keyword">sort</span> -<span class="hljs-keyword">u</span> | xargs doas pfctl -t web_brutes -T <span class="hljs-built_in">add</span></div></code></pre>
<ul>
<li>(<strong>Wordpressers</strong>: Do these look right? Consult web logs and <a href="http://man.openbsd.org/tcpdump">tcpdump</a> output.)</li>
</ul><div class="remark-slide-number">50</div></div></div></div><div class="remark-slide-notes"><p>max-src-conn - see man page but max number of simultaneous connections from one host
max-src-conn-rate - number of new connections per number of seconds 
You could also look into max-src-nodes, max-src-states</p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="annoying-spammers-with-spamd">Annoying spammers with spamd</h2>
<ul>
<li><a href="http://man.openbsd.org/spamd">spamd(8)</a> is good, clean, fun
<br><br></li>
<li>Speaks enough SMTP to do <a href="https://en.wikipedia.org/wiki/Greylisting">greylisting</a>
<br><br></li>
<li>Can tarpit known bad senders and generate blacklists by greytrapping
<br><br></li>
<li>Default <a href="http://man.openbsd.org/spamd.conf">spamd.conf</a> gives you one blacklist import and basics<ul>
<li>(<strong>Hint:</strong> no real SMTP service required)
<br><br></li>
</ul>
</li>
<li>You can even generate your own blacklists by <em>greytrapping</em> via <em>non-deliverable</em> spamtrap addresses in your own domain(s)
<br><br></li>
<li>Also see: <ul>
<li><a href="https://www.nostarch.com/pf3">The Book of PF</a></li>
<li><a href="http://bsdly.blogspot.ca/2012/05/in-name-of-sane-email-setting-up-spamd.html">In The Name Of Sane Email: Setting Up OpenBSD's spamd(8) With Secondary MXes</a></li>
<li><a href="http://bsdly.blogspot.ca/2013/04/maintaining-publicly-available.html">Maintaining A Publicly Available Blacklist</a></li>
</ul>
</li>
</ul><div class="remark-slide-number">51</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="annoying-spammers-with-spamd">Annoying spammers with spamd</h2>
<ul>
<li>Set up tables</li>
<li>Divert traffic to the spamd process</li>
<li>Only let the "good guys" pass to the real SMTP daemon</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line"><span class="hljs-built_in">table</span> <span class="hljs-variable">&lt;spamd-white&gt;</span> persist</div><div class="remark-code-line"><span class="hljs-built_in">table</span> <span class="hljs-variable">&lt;nospamd&gt;</span> persist file <span class="hljs-string">"/etc/mail/nospamd"</span></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">port</span> smtp <span class="hljs-keyword">divert-to</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> <span class="hljs-keyword">port</span> spamd</div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">from</span> <span class="hljs-variable">&lt;nospamd&gt;</span> <span class="hljs-keyword">to</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">port</span> smtp</div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">log</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">from</span> <span class="hljs-variable">&lt;spamd-white&gt;</span> <span class="hljs-keyword">to</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">port</span> smtp</div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">out</span> <span class="hljs-keyword">log</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">port</span> smtp</div></code></pre>
<ul>
<li>and then run</li>
</ul>
<pre><code class="shell hljs elixir remark-code"><div class="remark-code-line"><span class="hljs-variable">$ </span>doas rcctl enable spamd</div><div class="remark-code-line"><span class="hljs-variable">$ </span>doas rcctl start spamd</div></code></pre>
<p><strong>TIP:</strong> check out <a href="https://man.openbsd.org/smtpctl">smtpctl spf walk &lt;<em>nospamd_domains.txt</em></a> to feed your <em>nospamd</em> table from live <a href="https://en.wikipedia.org/wiki/Sender_Policy_Framework">SPF</a> data (requires 6.2-current or later)</p><div class="remark-slide-number">52</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="consider-what-about-that-separate-dmz-">Consider: what about that separate DMZ?</h2>
<ul>
<li>What do you need?
<br><br><br></li>
<li>IP addresses: Segment off or allocate separate address ranges
<br><br><br></li>
<li>Attach each segment to separate interface, VLAN
<br><br><br></li>
<li>Do the ruleset surgery<ul>
<li>which services do you run, where</li>
<li>do you need renumbering?</li>
<li>what traffic (in and out) is actually required?</li>
</ul>
</li>
</ul><div class="remark-slide-number">53</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="questions-">Questions ?</h1><div class="remark-slide-number">54</div></div></div></div><div class="remark-slide-notes"><p>Let's ask if there are any questions before continuing.  Make sure we have everyone onboard.</p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="exercise-3">Exercise 3</h1>
<h3 id="offering-services">Offering services</h3><div class="remark-slide-number">55</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="excercise-3-goals">Excercise 3 - Goals</h2>
<ul>
<li>You're now offering services
<br><br><br></li>
<li><strong>FreeBSD Host</strong> will provide <strong>http</strong> service
<br><br><br></li>
<li><strong>OpenBSD Client</strong> will provide <strong>smtp</strong> service
<br><br><br></li>
<li>We need to setup:<ul>
<li>The services</li>
<li>Redirects</li>
<li>Firewall rules</li>
</ul>
</li>
</ul><div class="remark-slide-number">56</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content right hljs-default" style="background-image: url(&quot;images/exercise3.png&quot;);"><h2 id="exercise-3-network">Exercise 3 - Network</h2><div class="remark-slide-number">57</div></div></div></div><div class="remark-slide-notes"><p>This is not exactly the network we have, but could be thought as such.</p>
<p>Host1 and Host2 are in what could be considered our DMZ.</p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-3-preparation">Exercise 3 - preparation</h2>
<ul>
<li><p>Configure the hosts with the following IPv6 addresses</p>
</li>
<li><p><em>Gateway (re1):</em> fd18:b5d:XX::a</p>
</li>
<li><em>FreeBSD:</em> fd18:b5d:XX::80</li>
<li><p><em>OpenBSD Client:</em> fd18:b5d:XX::25
<br> <br></p>
</li>
<li><p>Also, on FreeBSD and OpenBSD client, set fd18:b5d:XX::a as the default gateway</p>
</li>
<li><p>.. and take note of their IPv4 addresses</p>
</li>
</ul><div class="remark-slide-number">58</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-3-on-freebsd">Exercise 3 - on FreeBSD</h2>
<ul>
<li>We need to install nginx</li>
</ul>
<pre><code class="shell hljs cpp remark-code"><div class="remark-code-line"> <span class="hljs-meta"># pkg install nginx</span></div></code></pre>
<ul>
<li>and start it</li>
</ul>
<pre><code class="shell hljs apache remark-code"><div class="remark-code-line"> <span class="hljs-comment"># /usr/local/etc/rc.d/nginx onestart</span></div></code></pre><div class="remark-slide-number">59</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-3-on-openbsd-client">Exercise 3 - on OpenBSD Client</h2>
<ul>
<li>Change the config to listen on all interfaces:<ul>
<li>Change the appropriate line in</li>
</ul>
</li>
</ul>
<h3 id="-etc-mail-smtpd-conf">/etc/mail/smtpd.conf</h3>
<pre><code class="shell hljs apache remark-code"><div class="remark-code-line">  <span class="hljs-attribute"><span class="hljs-nomarkup">listen</span></span> <span class="hljs-literal">on</span> <span class="hljs-literal">all</span></div></code></pre>
<p><br><br></p>
<ul>
<li>Then start the daemon</li>
</ul>
<pre><code class="shell hljs lisp remark-code"><div class="remark-code-line"> # rcctl enable smtpd</div><div class="remark-code-line"> # rcctl start smtpd</div><div class="remark-code-line"> smtpd(<span class="hljs-name">ok</span>)</div></code></pre>
<ul>
<li>(It might take a while)</li>
</ul><div class="remark-slide-number">60</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-3-on-gateway">Exercise 3 - on gateway</h2>
<h3 id="-etc-pf-conf">/etc/pf.conf</h3>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">webserver_v4 = <span class="hljs-string">"$IP_addr_of_freebsd"</span></div><div class="remark-code-line">webserver_v6 = <span class="hljs-string">"fd18:b5d:XX::80"</span></div><div class="remark-code-line">webports = <span class="hljs-string">"{ http, https }"</span></div><div class="remark-code-line">emailserver_v4 = <span class="hljs-string">"$IP_addr_of_openbsd_client"</span></div><div class="remark-code-line">emailserver_v6 = <span class="hljs-string">"fd18:b5d:XX::25"</span></div><div class="remark-code-line">email = <span class="hljs-string">"{ smtp, pop3, imap, imap3, imaps, pop3s }"</span></div><div class="remark-code-line"></div><div class="remark-code-line"><span class="hljs-built_in">match</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$webports</span> <span class="hljs-keyword">rdr-to</span> <span class="hljs-variable">$webserver_v4</span></div><div class="remark-code-line"><span class="hljs-built_in">match</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$email</span> <span class="hljs-keyword">rdr-to</span> <span class="hljs-variable">$emailserver_v4</span></div><div class="remark-code-line"></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-variable">$webserver_v4</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$webports</span></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-variable">$emailserver_v4</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$email</span></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">log</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">from</span> <span class="hljs-variable">$emailserver_v4</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> smtp</div><div class="remark-code-line"></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-variable">$webserver_v6</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$webports</span></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-variable">$emailserver_v6</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$email</span></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">log</span> <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">from</span> <span class="hljs-variable">$emailserver_v6</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> smtp</div></code></pre>
<ul>
<li><strong>NB:</strong> No redirects are needed for IPv6</li>
</ul><div class="remark-slide-number">61</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-3-checks">Exercise 3 - checks</h2>
<ul>
<li>Try connecting to the HTTP and SMTP port of your friends/neighbours:
<br><br></li>
<li>From Gateway:</li>
</ul>
<pre><code class="shell hljs css remark-code"><div class="remark-code-line">    <span class="hljs-selector-tag">telnet</span> <span class="hljs-selector-tag">-6</span> <span class="hljs-selector-tag">fd18</span><span class="hljs-selector-pseudo">:b5d</span><span class="hljs-selector-pseudo">:XX</span><span class="hljs-selector-pseudo">::80</span> 80</div><div class="remark-code-line">    <span class="hljs-selector-tag">telnet</span> <span class="hljs-selector-tag">-4</span> 10<span class="hljs-selector-class">.255</span><span class="hljs-selector-class">.255</span><span class="hljs-selector-class">.XX</span> 80</div></code></pre>
<p><br><br></p>
<ul>
<li>and</li>
</ul>
<pre><code class="shell hljs css remark-code"><div class="remark-code-line">    <span class="hljs-selector-tag">telnet</span> <span class="hljs-selector-tag">-6</span> <span class="hljs-selector-tag">fd18</span><span class="hljs-selector-pseudo">:b5d</span><span class="hljs-selector-pseudo">:XX</span><span class="hljs-selector-pseudo">::25</span> 25</div><div class="remark-code-line">    <span class="hljs-selector-tag">telnet</span> <span class="hljs-selector-tag">-4</span> 10<span class="hljs-selector-class">.255</span><span class="hljs-selector-class">.255</span><span class="hljs-selector-class">.XX</span> 25</div></code></pre><div class="remark-slide-number">62</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="tips">Tips</h2>
<ul>
<li><p>Decide your network topology</p>
<ul>
<li>DMZ (?)</li>
<li>Multi-customer (?)</li>
<li>Multi-customer, Multi-DMZ(?)</li>
</ul>
</li>
<li><p>Segment off your subnets</p>
<ul>
<li>IPv4 (Do you NAT)?</li>
<li>IPv6</li>
<li>Do you NAT64?</li>
</ul>
</li>
<li><p>Per subnet (customer)</p>
<ul>
<li>Which services do you expose?</li>
<li>Write the rules</li>
<li>pamper^H^H^H^H^Hproxying</li>
</ul>
</li>
</ul><div class="remark-slide-number">63</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="traffic-shaping">Traffic Shaping</h1>
<h3 id="section-4">Section 4</h3><div class="remark-slide-number">64</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="traffic-shaping">Traffic shaping</h2>
<ul>
<li><p>OpenBSD has three separate shaping techniques:</p>
<ul>
<li><p><em>priorities</em> (set prio), introduced in OpenBSD 5.0</p>
</li>
<li><p><em>queues</em>, introduced in OpenBSD 5.5, and</p>
</li>
<li><p><em>flows</em>, introduced in OpenBSD 6.2 (aka FQ-CoDel)
<br><br></p>
</li>
</ul>
</li>
<li><p><strong>Remember:</strong></p>
<ul>
<li><p>Traffic shaping is about <em>dropping packets</em></p>
</li>
<li><p>But is only relevant when there's a <em>reason</em> to start dropping</p>
</li>
<li><p>Then you get to pick which ones using the traffic shaping tools
<br><br></p>
</li>
</ul>
</li>
<li>Works only one way, <strong>outbound</strong></li>
</ul><div class="remark-slide-number">65</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="traffic-shaping-with-priorities">Traffic shaping with priorities</h2>
<ul>
<li>In OpenBSD, every packet has a priority
<br><br></li>
<li>Possible values are 0 (garbage) through 7 (want!)<ul>
<li>Default for most traffic is 3.
<br><br></li>
</ul>
</li>
<li>So if you want <em>all</em> ssh traffic to move ahead of other traffic you could do a
<br><br><pre><code class="shell hljs pf remark-code"><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> ssh <span class="hljs-built_in">set</span> <span class="hljs-keyword">prio</span> <span class="hljs-number">6</span></div></code></pre>
<br><br></li>
<li>and assign specific, non-default ( != 3 ) values to others.</li>
</ul><div class="remark-slide-number">66</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="beating-the-fifo-with-prio">Beating the FIFO with prio</h2>
<ul>
<li>By default, packets are serviced on a first come, first served basis<ul>
<li>or 'First in, First out' (FIFO).
<br><br></li>
</ul>
</li>
<li>But: TCP wants ACKs for sent packets within a reasonable time<ul>
<li>Otherwise the packet is considered lost, and retransmit will follow (transfer stalls).
<br><br></li>
</ul>
</li>
<li>ACKs are tiny and have their TOS set to lowdelay, and this trick will cheat the FIFO:
<br><br><pre><code class="shell hljs pf remark-code"><div class="remark-code-line"><span class="hljs-built_in">match</span> <span class="hljs-keyword">out</span> <span class="hljs-keyword">on</span> <span class="hljs-variable">$ext_if</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">from</span> <span class="hljs-variable">$ext_if</span> <span class="hljs-built_in">set</span> <span class="hljs-keyword">prio</span> (<span class="hljs-number">3</span>, <span class="hljs-number">7</span>)</div><div class="remark-code-line"><span class="hljs-built_in">match</span> <span class="hljs-keyword">in</span>  <span class="hljs-keyword">on</span> <span class="hljs-variable">$ext_if</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-variable">$ext_if</span> <span class="hljs-built_in">set</span> <span class="hljs-keyword">prio</span> (<span class="hljs-number">3</span>, <span class="hljs-number">7</span>)</div></code></pre>
<br><br></li>
<li>See <a href="http://www.benzedrine.ch/ackpri.html">Prioritizing empty TCP ACKs with pf and ALTQ</a> by Daniel Hartmeier for the ALTQ way</li>
</ul><div class="remark-slide-number">67</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="fq-codel-flows-for-fair-bandwidth-sharing">FQ-CoDel flows for fair bandwidth sharing</h2>
<p>Introduced in <a href="https://www.openbsd.org/62.html">OpenBSD 6.2</a>, the FQ-CoDel algorithm (see <a href="https://tools.ietf.org/html/rfc8290">RFC8290</a>) defines <strong>flows</strong> to set up fair sharing for a specified number of simultaneous connections</p>
<p>Enable for your configuration with something like</p>
<pre><code class="shell hljs lsl remark-code"><div class="remark-code-line">queue outq on bge0 bandwidth <span class="hljs-number">18</span>M max <span class="hljs-number">18</span>M flows <span class="hljs-number">1024</span> qlimit <span class="hljs-number">1024</span> \</div><div class="remark-code-line">               <span class="hljs-section">default</span></div></code></pre>
<p>Estimate your approximate high number of simultaneous clients, put that number in (up to 32767) </p><div class="remark-slide-number">68</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="shaping-with-hfsc-queues-fixed-sizes">Shaping with HFSC queues - fixed sizes</h2>
<ul>
<li>When priorities don't quite cut it, you can slice your bandwidth into queues.
<br><br></li>
<li>For static shaping, give bandwidth values in absolute values:
<br><br></li>
<li>Only leaf queues can be assigned traffic<ul>
<li>make sure allocations sum up to parent queue allocation
<br><br></li>
</ul>
</li>
<li>Unless quotas approach saturation, no actual shaping (dropping) will take place</li>
</ul><div class="remark-slide-number">69</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="shaping-with-hfsc-queues-fixed-sizes">Shaping with HFSC queues - fixed sizes</h2>
<p><br><br><br></p>
<pre><code class="shell hljs lasso remark-code"><div class="remark-code-line">  <span class="hljs-built_in">queue</span> main <span class="hljs-keyword">on</span> $ext_if bandwidth <span class="hljs-number">20</span>M</div><div class="remark-code-line">      <span class="hljs-built_in">queue</span> defq <span class="hljs-keyword">parent</span> main bandwidth <span class="hljs-number">3600</span>K default</div><div class="remark-code-line">      <span class="hljs-built_in">queue</span> ftp <span class="hljs-keyword">parent</span> main bandwidth <span class="hljs-number">2000</span>K</div><div class="remark-code-line">      <span class="hljs-built_in">queue</span> udp <span class="hljs-keyword">parent</span> main bandwidth <span class="hljs-number">6000</span>K</div><div class="remark-code-line">      <span class="hljs-built_in">queue</span> web <span class="hljs-keyword">parent</span> main bandwidth <span class="hljs-number">4000</span>K</div><div class="remark-code-line">      <span class="hljs-built_in">queue</span> ssh <span class="hljs-keyword">parent</span> main bandwidth <span class="hljs-number">4000</span>K</div><div class="remark-code-line">        <span class="hljs-built_in">queue</span> ssh_interactive <span class="hljs-keyword">parent</span> ssh bandwidth <span class="hljs-number">800</span>K</div><div class="remark-code-line">        <span class="hljs-built_in">queue</span> ssh_bulk <span class="hljs-keyword">parent</span> ssh bandwidth <span class="hljs-number">3200</span>K</div><div class="remark-code-line">  <span class="hljs-built_in">queue</span> icmp <span class="hljs-keyword">parent</span> main bandwidth <span class="hljs-number">400</span>K</div></code></pre><div class="remark-slide-number">70</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="shaping-with-hfsc-queues-fixed-assignment">Shaping with HFSC queues - fixed assignment</h2>
<ul>
<li>You can either do queue assignment with match rules:</li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line"><span class="hljs-built_in">match</span> <span class="hljs-keyword">log</span> <span class="hljs-keyword">quick</span> <span class="hljs-keyword">on</span> <span class="hljs-variable">$ext_if</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> ssh \</div><div class="remark-code-line">    queue (ssh_bulk, ssh_interactive)</div><div class="remark-code-line"><span class="hljs-built_in">match</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">quick</span> <span class="hljs-keyword">on</span> <span class="hljs-variable">$ext_if</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> ftp queue ftp</div><div class="remark-code-line"><span class="hljs-built_in">match</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">quick</span> <span class="hljs-keyword">on</span> <span class="hljs-variable">$ext_if</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> www queue http</div><div class="remark-code-line"><span class="hljs-built_in">match</span> <span class="hljs-keyword">out</span> <span class="hljs-keyword">on</span> <span class="hljs-variable">$ext_if</span> <span class="hljs-keyword">proto</span> udp queue udp</div><div class="remark-code-line"><span class="hljs-built_in">match</span> <span class="hljs-keyword">out</span> <span class="hljs-keyword">on</span> <span class="hljs-variable">$ext_if</span> <span class="hljs-keyword">proto</span> icmp queue icmp</div></code></pre>
<ul>
<li><p>treat filtering (block, pass) in separate rules,</p>
</li>
<li><p><em>or</em></p>
<ul>
<li>append 'set queue' to individual pass rules</li>
</ul>
</li>
<li><p>Any traffic not explicitly assigned goes in the default queue</p>
</li>
</ul><div class="remark-slide-number">71</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="shaping-with-hfsc-queues-flexible-allocations-min-max-burst-">Shaping with HFSC queues - flexible allocations (min, max, burst)</h2>
<p>You can build in flexibility:</p>
<pre><code class="shell hljs lasso remark-code"><div class="remark-code-line"><span class="hljs-built_in">queue</span> rootq <span class="hljs-keyword">on</span> $ext_if bandwidth <span class="hljs-number">20</span>M</div><div class="remark-code-line">        <span class="hljs-built_in">queue</span> main <span class="hljs-keyword">parent</span> rootq bandwidth <span class="hljs-number">20479</span>K <span class="hljs-keyword">min</span> <span class="hljs-number">1</span>M <span class="hljs-keyword">max</span> <span class="hljs-number">20479</span>K qlimit <span class="hljs-number">100</span></div><div class="remark-code-line">             <span class="hljs-built_in">queue</span> qdef <span class="hljs-keyword">parent</span> main bandwidth <span class="hljs-number">9600</span>K <span class="hljs-keyword">min</span> <span class="hljs-number">6000</span>K <span class="hljs-keyword">max</span> <span class="hljs-number">18</span>M default</div><div class="remark-code-line">             <span class="hljs-built_in">queue</span> qweb <span class="hljs-keyword">parent</span> main bandwidth <span class="hljs-number">9600</span>K <span class="hljs-keyword">min</span> <span class="hljs-number">6000</span>K <span class="hljs-keyword">max</span> <span class="hljs-number">18</span>M</div><div class="remark-code-line">             <span class="hljs-built_in">queue</span> qpri <span class="hljs-keyword">parent</span> main bandwidth <span class="hljs-number">700</span>K <span class="hljs-keyword">min</span> <span class="hljs-number">100</span>K <span class="hljs-keyword">max</span> <span class="hljs-number">1200</span>K</div><div class="remark-code-line">             <span class="hljs-built_in">queue</span> qdns <span class="hljs-keyword">parent</span> main bandwidth <span class="hljs-number">200</span>K <span class="hljs-keyword">min</span> <span class="hljs-number">12</span>K burst <span class="hljs-number">600</span>K for <span class="hljs-number">3000</span>ms</div><div class="remark-code-line">        <span class="hljs-built_in">queue</span> spamd <span class="hljs-keyword">parent</span> rootq bandwidth <span class="hljs-number">1</span>K <span class="hljs-keyword">min</span> <span class="hljs-number">0</span>K <span class="hljs-keyword">max</span> <span class="hljs-number">1</span>K qlimit <span class="hljs-number">300</span></div></code></pre>
<p>Note here the added <em>min</em> and <em>max</em> values: combinded queue bandwidth can exceed actual sum; this gets you upper and lower bound within physical limits.</p>
<p>  <em>burst N for M</em> - allow bursts of that size and length</p>
<p>  <em>qlimit</em> - size of the queue's holding buffer - larger values <em>may</em> delay (packets are kept longer before sending)</p><div class="remark-slide-number">72</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="systat">Systat</h2>
<ul>
<li><p>Available on all the BSDs</p>
<ul>
<li>OpenBSD version has added functionalities</li>
</ul>
</li>
<li><p>Offers view into your system's traffic</p>
<ul>
<li>Live queues, states, rules</li>
</ul>
</li>
<li><p>Check how your rules are behaving on your system in realtime</p>
</li>
<li><p>More info in the man page <a href="http://man.openbsd.org/systat">systat(1)</a></p>
</li>
</ul><div class="remark-slide-number">73</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="queue-monitoring-systat-queues">queue monitoring - systat queues</h2>
<p><br><br><br></p>
<pre><code class="shell hljs tap remark-code"><div class="remark-code-line">  <span class="hljs-number"> 1 </span>users Load 2.56 2.27 2.28                        skapet.bsdly.net 20:55:50</div><div class="remark-code-line"></div><div class="remark-code-line">QUEUE                BW SCH  PRI    PKTS   BYTES   DROP_P   DROP_B QLEN BOR SUS  P/S   B/S</div><div class="remark-code-line">rootq on bge0       20M               <span class="hljs-number"> 0 </span>     <span class="hljs-number"> 0 </span>      <span class="hljs-number"> 0 </span>      <span class="hljs-number"> 0 </span>  <span class="hljs-number"> 0 </span>          <span class="hljs-number"> 0 </span>    0</div><div class="remark-code-line"> main               20M               <span class="hljs-number"> 0 </span>     <span class="hljs-number"> 0 </span>      <span class="hljs-number"> 0 </span>      <span class="hljs-number"> 0 </span>  <span class="hljs-number"> 0 </span>          <span class="hljs-number"> 0 </span>    0</div><div class="remark-code-line">  qdef               9M         <span class="hljs-number"> 6416363 </span>  2338M     <span class="hljs-number"> 136 </span>  <span class="hljs-number"> 15371 </span>  <span class="hljs-number"> 0 </span>        <span class="hljs-number"> 462 </span>30733</div><div class="remark-code-line">  qweb               9M          <span class="hljs-number"> 431590 </span>144565K       <span class="hljs-number"> 0 </span>      <span class="hljs-number"> 0 </span>  <span class="hljs-number"> 0 </span>         0.6   480</div><div class="remark-code-line">  qpri               2M         <span class="hljs-number"> 2854556 </span>181684K       <span class="hljs-number"> 5 </span>    <span class="hljs-number"> 390 </span>  <span class="hljs-number"> 0 </span>         <span class="hljs-number"> 79 </span> 5243</div><div class="remark-code-line">  qdns             100K          <span class="hljs-number"> 802874 </span> 68379K       <span class="hljs-number"> 0 </span>      <span class="hljs-number"> 0 </span>  <span class="hljs-number"> 0 </span>         0.6    52</div><div class="remark-code-line"> spamd               1K          <span class="hljs-number"> 596022 </span> 36021K <span class="hljs-number"> 1177533 </span>72871514 <span class="hljs-number"> 299 </span>          <span class="hljs-number"> 2 </span>  136</div></code></pre>
<p>or</p><div class="remark-slide-number">74</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="queue-monitoring-pfctl">queue monitoring - pfctl</h2>
<pre><code class="shell hljs vim remark-code"><div class="remark-code-line">$ doas pfctl -vsq</div><div class="remark-code-line">  [ pkt<span class="hljs-variable">s:</span>          <span class="hljs-number">0</span>  byte<span class="hljs-variable">s:</span>          <span class="hljs-number">0</span>  dropped pkt<span class="hljs-variable">s:</span>      <span class="hljs-number">0</span> byte<span class="hljs-variable">s:</span>      <span class="hljs-number">0</span> ]</div><div class="remark-code-line">  [ qlength:   <span class="hljs-number">0</span>/ <span class="hljs-number">50</span> ]</div><div class="remark-code-line">queue rootq <span class="hljs-keyword">on</span> bge0 bandwidth <span class="hljs-number">20</span>M qlimit <span class="hljs-number">50</span></div><div class="remark-code-line">  [ pkt<span class="hljs-variable">s:</span>          <span class="hljs-number">0</span>  byte<span class="hljs-variable">s:</span>          <span class="hljs-number">0</span>  dropped pkt<span class="hljs-variable">s:</span>      <span class="hljs-number">0</span> byte<span class="hljs-variable">s:</span>      <span class="hljs-number">0</span> ]</div><div class="remark-code-line">  [ qlength:   <span class="hljs-number">0</span>/ <span class="hljs-number">50</span> ]</div><div class="remark-code-line">queue main parent rootq bandwidth <span class="hljs-number">20</span>M, <span class="hljs-built_in">min</span> <span class="hljs-number">1</span>M, <span class="hljs-built_in">max</span> <span class="hljs-number">20</span>M qlimit <span class="hljs-number">100</span></div><div class="remark-code-line">  [ pkt<span class="hljs-variable">s:</span>          <span class="hljs-number">0</span>  byte<span class="hljs-variable">s:</span>          <span class="hljs-number">0</span>  dropped pkt<span class="hljs-variable">s:</span>      <span class="hljs-number">0</span> byte<span class="hljs-variable">s:</span>      <span class="hljs-number">0</span> ]</div><div class="remark-code-line">  [ qlength:   <span class="hljs-number">0</span>/<span class="hljs-number">100</span> ]</div><div class="remark-code-line">queue qdef parent main bandwidth <span class="hljs-number">9</span>M, <span class="hljs-built_in">min</span> <span class="hljs-number">8</span>M, <span class="hljs-built_in">max</span> <span class="hljs-number">18</span>M default qlimit <span class="hljs-number">50</span></div><div class="remark-code-line">  [ pkt<span class="hljs-variable">s:</span>    <span class="hljs-number">6517150</span>  byte<span class="hljs-variable">s:</span> <span class="hljs-number">2458545319</span>  dropped pkt<span class="hljs-variable">s:</span>    <span class="hljs-number">136</span> byte<span class="hljs-variable">s:</span>  <span class="hljs-number">15371</span> ]</div><div class="remark-code-line">  [ qlength:   <span class="hljs-number">0</span>/ <span class="hljs-number">50</span> ]</div><div class="remark-code-line">queue qweb parent main bandwidth <span class="hljs-number">9</span>M, <span class="hljs-built_in">min</span> <span class="hljs-number">8</span>M, <span class="hljs-built_in">max</span> <span class="hljs-number">18</span>M qlimit <span class="hljs-number">50</span></div><div class="remark-code-line">  [ pkt<span class="hljs-variable">s:</span>     <span class="hljs-number">431741</span>  byte<span class="hljs-variable">s:</span>  <span class="hljs-number">148072219</span>  dropped pkt<span class="hljs-variable">s:</span>      <span class="hljs-number">0</span> byte<span class="hljs-variable">s:</span>      <span class="hljs-number">0</span> ]</div><div class="remark-code-line">  [ qlength:   <span class="hljs-number">0</span>/ <span class="hljs-number">50</span> ]</div><div class="remark-code-line">queue qpri parent main bandwidth <span class="hljs-number">2</span>M, <span class="hljs-built_in">min</span> <span class="hljs-number">700</span>K, <span class="hljs-built_in">max</span> <span class="hljs-number">2</span>M burst <span class="hljs-number">4</span>M <span class="hljs-keyword">for</span> <span class="hljs-number">3000</span>ms qlimit <span class="hljs-number">50</span></div><div class="remark-code-line">  [ pkt<span class="hljs-variable">s:</span>    <span class="hljs-number">2855418</span>  byte<span class="hljs-variable">s:</span>  <span class="hljs-number">186101241</span>  dropped pkt<span class="hljs-variable">s:</span>      <span class="hljs-number">5</span> byte<span class="hljs-variable">s:</span>    <span class="hljs-number">390</span> ]</div><div class="remark-code-line">  [ qlength:   <span class="hljs-number">0</span>/ <span class="hljs-number">50</span> ]</div><div class="remark-code-line">queue qdns parent main bandwidth <span class="hljs-number">100</span>K, <span class="hljs-built_in">min</span> <span class="hljs-number">12</span>K burst <span class="hljs-number">600</span>K <span class="hljs-keyword">for</span> <span class="hljs-number">3000</span>ms qlimit <span class="hljs-number">50</span></div><div class="remark-code-line">  [ pkt<span class="hljs-variable">s:</span>     <span class="hljs-number">803548</span>  byte<span class="hljs-variable">s:</span>   <span class="hljs-number">70079760</span>  dropped pkt<span class="hljs-variable">s:</span>      <span class="hljs-number">0</span> byte<span class="hljs-variable">s:</span>      <span class="hljs-number">0</span> ]</div><div class="remark-code-line">  [ qlength:   <span class="hljs-number">0</span>/ <span class="hljs-number">50</span> ]</div><div class="remark-code-line">queue spamd parent rootq bandwidth <span class="hljs-number">1</span>K, <span class="hljs-built_in">max</span> <span class="hljs-number">1</span>K qlimit <span class="hljs-number">300</span></div><div class="remark-code-line">  [ pkt<span class="hljs-variable">s:</span>     <span class="hljs-number">596424</span>  byte<span class="hljs-variable">s:</span>   <span class="hljs-number">36910940</span>  dropped pkt<span class="hljs-variable">s:</span> <span class="hljs-number">1178456</span> byte<span class="hljs-variable">s:</span> <span class="hljs-number">72928604</span> ]</div><div class="remark-code-line">  [ qlength: <span class="hljs-number">300</span>/<span class="hljs-number">300</span> ]</div></code></pre>
<p>add another v (<a href="http://man.openbsd.org/pfctl">pfctl</a> -vvsq) for continuously updating display</p><div class="remark-slide-number">75</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="questions-">Questions ?</h1><div class="remark-slide-number">76</div></div></div></div><div class="remark-slide-notes"><p>Let's ask if there are any questions before continuing.  Make sure we have everyone onboard.</p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="exercise-4">Exercise 4</h1>
<h3 id="queueing">Queueing</h3><div class="remark-slide-number">77</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-4-goals">Exercise 4 - Goals</h2>
<ul>
<li>With the configs from exercise 3, now add:
<br><br><br></li>
<li>A set of queues, and
<br><br><br></li>
<li>Statements to add rules to the queues</li>
</ul><div class="remark-slide-number">78</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-4-on-gateway">Exercise 4 - on Gateway</h2>
<ul>
<li>Configure the queues
<br><br></li>
</ul>
<h3 id="-etc-pf-conf">/etc/pf.conf</h3>
<pre><code class="shell hljs lasso remark-code"><div class="remark-code-line"><span class="hljs-built_in">queue</span> rootq <span class="hljs-keyword">on</span> $ext_if bandwidth <span class="hljs-number">20</span>M</div><div class="remark-code-line">    <span class="hljs-built_in">queue</span> main <span class="hljs-keyword">parent</span> rootq bandwidth <span class="hljs-number">20479</span>K <span class="hljs-keyword">min</span> <span class="hljs-number">1</span>M <span class="hljs-keyword">max</span> <span class="hljs-number">20479</span>K qlimit <span class="hljs-number">100</span></div><div class="remark-code-line">        <span class="hljs-built_in">queue</span> default <span class="hljs-keyword">parent</span> main bandwidth <span class="hljs-number">9600</span>K <span class="hljs-keyword">min</span> <span class="hljs-number">6000</span>K <span class="hljs-keyword">max</span> <span class="hljs-number">18</span>M default</div><div class="remark-code-line">        <span class="hljs-built_in">queue</span> http <span class="hljs-keyword">parent</span> main bandwidth <span class="hljs-number">9600</span>K <span class="hljs-keyword">min</span> <span class="hljs-number">6000</span>K <span class="hljs-keyword">max</span> <span class="hljs-number">18</span>M</div><div class="remark-code-line">        <span class="hljs-built_in">queue</span> smtp <span class="hljs-keyword">parent</span> main bandwidth <span class="hljs-number">9600</span>K <span class="hljs-keyword">min</span> <span class="hljs-number">6000</span>K <span class="hljs-keyword">max</span> <span class="hljs-number">18</span>M</div><div class="remark-code-line">    <span class="hljs-built_in">queue</span> spamd <span class="hljs-keyword">parent</span> rootq bandwidth <span class="hljs-number">1</span>K <span class="hljs-keyword">min</span> <span class="hljs-number">0</span>K <span class="hljs-keyword">max</span> <span class="hljs-number">1</span>K qlimit <span class="hljs-number">300</span></div></code></pre><div class="remark-slide-number">79</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-4-on-gateway">Exercise 4 - on Gateway</h2>
<ul>
<li>and then apply them to the match statements</li>
</ul>
<h3 id="-etc-pf-conf">/etc/pf.conf</h3>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line"><span class="hljs-built_in">match</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$webports</span> <span class="hljs-keyword">rdr-to</span> <span class="hljs-variable">$webserver_v4</span> \</div><div class="remark-code-line">      queue http</div><div class="remark-code-line"><span class="hljs-built_in">match</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">on</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-literal">egress</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$email</span> <span class="hljs-keyword">rdr-to</span> <span class="hljs-variable">$emailserver_v4</span> \</div><div class="remark-code-line">      queue smtp</div><div class="remark-code-line"></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-variable">$webserver_v6</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$webports</span> <span class="hljs-built_in">set</span> queue http</div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-variable">$emailserver_v6</span> <span class="hljs-keyword">port</span> <span class="hljs-variable">$email</span> <span class="hljs-built_in">set</span> queue smtp</div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">log</span> <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">from</span> <span class="hljs-variable">$emailserver_v6</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> smtp <span class="hljs-built_in">set</span> queue smtp</div></code></pre><div class="remark-slide-number">80</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-4-check">Exercise 4 - Check</h2>
<ul>
<li>Check the queues have been effectively created</li>
</ul>
<pre><code class="shell hljs cpp remark-code"><div class="remark-code-line"> <span class="hljs-meta"># systat queues</span></div></code></pre>
<p><br><br><br></p>
<ul>
<li>or, alternatively</li>
</ul>
<pre><code class="shell hljs cpp remark-code"><div class="remark-code-line"> <span class="hljs-meta"># pfctl -vsq</span></div></code></pre><div class="remark-slide-number">81</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="tips">Tips</h1>
<h3 id="section-5">Section 5</h3><div class="remark-slide-number">82</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h1 id="choosing-your-isp-a-quick-guide">Choosing your ISP, a quick guide</h1>
<ul>
<li>Are they national or regional IX members?
<br><br></li>
<li>Do they have geographical redundancy ?<ul>
<li>or do you need to arrange that for yourself ?
<br><br></li>
</ul>
</li>
<li>Do they actually understand your questions about peering, routing, multiple paths?<ul>
<li>(avoid consumer oriented SOHO-only shops)
<br><br></li>
</ul>
</li>
<li>Do they <em>suck</em>?</li>
</ul><div class="remark-slide-number">83</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="getting-transit">Getting transit</h2>
<ul>
<li>Find well peered transit providers<ul>
<li>Can improve quality and shorten AS paths</li>
<li>No capacity problems
<br><br><br></li>
</ul>
</li>
<li>Find your top traffic destinations:<ul>
<li>Can improve quality</li>
<li>Peer with them or find closer upstream</li>
<li>Traffic profile from flow collectors can be useful</li>
</ul>
</li>
</ul><div class="remark-slide-number">84</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="common-mistakes">Common mistakes</h2>
<ul>
<li>No diversity<ul>
<li>All reached over same cable</li>
<li>All connect to the same transit</li>
<li>All have poor onward transit and peering arrangements 
<br><br><br></li>
</ul>
</li>
<li>Signing up with too many transit providers<ul>
<li>Lots of small circuits</li>
<li>These cost more per Mbps than larger ones</li>
</ul>
</li>
</ul><div class="remark-slide-number">85</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="basic-openbgpd-configuration-operation-and-interaction-with-pf">Basic OpenBGPd configuration, operation and interaction with PF</h2>
<ul>
<li><p><strong>B</strong>order <strong>G</strong>ateway <strong>P</strong>rotocol</p>
<ul>
<li>Manage and exchange route information with BGP peers</li>
</ul>
</li>
<li><p>Once you have the ASn registered, do the basic config. </p>
<!--
- (You were in [phessler's session](http://www.bsdcan.org/2017/schedule/events/783.en.html), right?)
--></li>
<li><p>In your <em>pf.conf</em>:</p>
<ul>
<li>enable BGP to pass between your routers and your peers' -- <strong>TCP and UDP 179</strong></li>
</ul>
</li>
<li><p><strong>Neat trick</strong>: Define tables in your <a href="http://man.openbsd.org/pf.conf">pf.conf</a></p>
<ul>
<li>bgpd maintains them via <strong>pftable</strong> attributes on <a href="http://man.openbsd.org/bgpd.conf">bgpd.conf</a> objects</li>
</ul>
</li>
</ul><div class="remark-slide-number">86</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="use-cases-for-ospf-bgp-or-ecmp">Use cases for OSPF, BGP or ECMP</h2>
<ul>
<li><p><strong>OSPF:</strong> <strong>O</strong>pen <strong>S</strong>hortest <strong>P</strong>ath <strong>F</strong>irst </p>
<ul>
<li>Each router maintains link state information for links and networks within your AS</li>
<li>Calculates routing cost</li>
<li>Use <a href="http://man.openbsd.org/ospf6d">ospf6d</a> for IPv6</li>
<li>Use <a href="http://man.openbsd.org/ospfd">ospfd</a> for IPv4</li>
<li>Need to <em>pass proto ospf</em> between routers.</li>
</ul>
</li>
<li><p><strong>BGP:</strong> announces and receives routes</p>
<ul>
<li>Use <a href="http://man.openbsd.org/bgpd">bgpd</a></li>
<li>need to <em>pass proto tcp port 179</em> between routers</li>
</ul>
</li>
<li><p><strong>ECMP:</strong> <strong>E</strong>qual <strong>C</strong>ost <strong>M</strong>ulti-<strong>P</strong>ath</p>
<ul>
<li>target reachable via more than one route</li>
<li>load distribution or redundancy over multiple links</li>
<li><strong>Tip</strong> Use <a href="http://man.openbsd.org/ifstated">ifstated</a> to handle link downtime.</li>
</ul>
</li>
</ul><div class="remark-slide-number">87</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="bcp38-manrs-and-internet-peering">BCP38, MANRS and Internet peering</h2>
<ul>
<li><p>"<a href="https://tools.ietf.org/html/bcp38"><strong>BCP38</strong></a>"</p>
<ul>
<li>Discussed also in another effort</li>
</ul>
</li>
<li><p><strong>M</strong>utually <strong>A</strong>greed <strong>N</strong>orms for <strong>R</strong>outing <strong>S</strong>ecurity (MANRS)</p>
</li>
<li><p>Define four concrete actions network operators should implement</p>
<ul>
<li>Coordination</li>
<li>Keep your contacts updated</li>
<li>Validation</li>
<li>Route objects, RPKI, BGPSec</li>
<li>Anti-spoofing</li>
<li>uRPF</li>
<li>Filtering</li>
</ul>
</li>
<li><p>Build a visible community of security-minded operators</p>
</li>
<li><p>Valuable resource: <a href="https://www.routingmanifesto.org/">The Routing Manifesto</a></p>
</li>
</ul><div class="remark-slide-number">88</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="introducing-vxlan-in-your-network">Introducing VXLAN in your network</h2>
<p><a href="http://man.openbsd.org/vxlan">vxlan</a> - the <strong>V</strong>irtual e<strong>X</strong>tensible <strong>L</strong>ocal <strong>A</strong>rea <strong>N</strong>etwork tunnel interface
<br><br></p>
<ul>
<li>Pushes layer 2 network (Ethernet frames) over layer 3 (IP) tunnels<ul>
<li>24-bit <em>vnetid</em> (vs max 4k VLANs)
<br><br></li>
</ul>
</li>
<li>Has <em>no</em> built in security</li>
<li>Intended for '<em>trusted</em>' (Datacenter, inter-hypervisor) environments<ul>
<li>Otherwise, consider transport over IPSEC.
<br><br></li>
</ul>
</li>
<li>Default transport over <strong>UDP 4789</strong> (aka <strong>vxlan</strong>)<ul>
<li>make sure that traffic passes between endpoints</li>
</ul>
</li>
</ul><div class="remark-slide-number">89</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h1 id="introducing-vxlan-in-your-network">Introducing VXLAN in your network</h1>
<pre><code class="shell hljs lsl remark-code"><div class="remark-code-line"> # ifconfig vxlan0 tunnel <span class="hljs-number">192.168</span><span class="hljs-number">.100</span><span class="hljs-number">.101</span> <span class="hljs-number">192.168</span><span class="hljs-number">.200</span><span class="hljs-number">.201</span> vnetid <span class="hljs-number">17</span></div><div class="remark-code-line"> # ifconfig vxlan0 <span class="hljs-number">10.11</span><span class="hljs-number">.12</span><span class="hljs-number">.100</span>/<span class="hljs-number">24</span></div></code></pre>
<p><br><br></p>
<pre><code class="shell hljs lsl remark-code"><div class="remark-code-line"> # ifconfig vxlan0 tunnel <span class="hljs-number">192.168</span><span class="hljs-number">.200</span><span class="hljs-number">.201</span> <span class="hljs-number">192.168</span><span class="hljs-number">.100</span><span class="hljs-number">.101</span>  vnetid <span class="hljs-number">17</span></div><div class="remark-code-line"> # ifconfig vxlan0 <span class="hljs-number">10.11</span><span class="hljs-number">.12</span><span class="hljs-number">.101</span>/<span class="hljs-number">24</span></div></code></pre>
<p><br><br></p>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line"><span class="hljs-built_in">table</span> <span class="hljs-variable">&lt;vxendpoints&gt;</span> { <span class="hljs-number">192.168</span>.<span class="hljs-number">200.201</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">200.204</span> }</div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">from</span> <span class="hljs-variable">&lt;vxendpoints&gt;</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> vxlan</div></code></pre>
<p><br><br>
Buy <a href="http://www.bsdcan.org/2017/schedule/speakers/227.en.html">Reyk</a> a beer.</p><div class="remark-slide-number">90</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="readable-and-maintainable-toolsets">Readable and maintainable toolsets</h2>
<ul>
<li><strong>Macros</strong><ul>
<li>descriptive names, keep uniform</li>
</ul>
</li>
<li><strong>Tables</strong> <ul>
<li>descriptive names</li>
<li>consider daemon/scripting interface</li>
</ul>
</li>
<li><strong>Interface groups</strong><ul>
<li>you know egress already</li>
<li>make your own and filter on them</li>
</ul>
</li>
<li><strong>Anchors</strong><ul>
<li>group rules by common criteria</li>
<li>tagging </li>
<li>interface or group</li>
</ul>
</li>
<li><p>Service names vs port numbers</p>
</li>
<li><p><strong>Comments</strong> - yes, you <strong>will</strong> forget why this was a good idea</p>
</li>
</ul><div class="remark-slide-number">91</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="now-let-s-add-wireless">Now let's add wireless</h2>
<ul>
<li>Wireless used to be hard, (WPA in particular), now it's 'just another interface'
<br><br></li>
<li>802.11* support in OpenBSD has a,b,g,n but no ac yet
<br><br></li>
<li>Not all drivers support hostap<ul>
<li>check man pages before buying kit for access point use
<br><br></li>
</ul>
</li>
<li>Optionally setup with commercial APs for radio part<ul>
<li>do dhcp filtering auth etc from OpenBSD</li>
</ul>
</li>
</ul><div class="remark-slide-number">92</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="questions-">Questions ?</h1><div class="remark-slide-number">93</div></div></div></div><div class="remark-slide-notes"><p>Let's ask if there are any questions before continuing.  Make sure we have everyone onboard.</p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="troubleshooting">Troubleshooting</h1>
<h3 id="section-6">Section 6</h3>
<h4 id="-it-s-all-your-fault-until-you-track-down-and-fix-the-root-cause-">"It's all your fault. Until you track down and fix the root cause."</h4><div class="remark-slide-number">94</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="troubleshooting-101-icmp-v6-">Troubleshooting 101: ICMP(v6)</h2>
<ul>
<li><p>ICMP: <strong>I</strong>nternet <strong>C</strong>ontrol <strong>M</strong>essage <strong>P</strong>rotocol</p>
</li>
<li><p>The <em>ping of death</em> scare is almost over, let's enable <a href="http://man.openbsd.org/ping">ping</a>:
<br><br></p>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">icmp_types = <span class="hljs-string">"{ echoreq, unreach }"</span></div><div class="remark-code-line"></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">proto</span> icmp <span class="hljs-literal">all</span> icmp-type <span class="hljs-variable">$icmp_types</span> <span class="hljs-keyword">keep</span> <span class="hljs-keyword">state</span></div><div class="remark-code-line"></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">proto</span> icmp <span class="hljs-keyword">from</span> <span class="hljs-variable">$localnet</span> icmp-type <span class="hljs-variable">$icmp_types</span></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">proto</span> icmp <span class="hljs-keyword">to</span> <span class="hljs-variable">$ext_if</span> icmp-type <span class="hljs-variable">$icmp_types</span></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">proto</span> icmp6 <span class="hljs-keyword">from</span> <span class="hljs-variable">$localnet</span> icmp6-type <span class="hljs-variable">$icmp6_types</span></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">proto</span> icmp6 <span class="hljs-keyword">to</span> <span class="hljs-variable">$ext_if</span> icmp6-type <span class="hljs-variable">$icmp6_types</span></div></code></pre>
<p><br><br></p>
</li>
<li><p><strong>echoreq</strong>: lets <a href="http://man.openbsd.org/ping">ping</a> do its thing</p>
</li>
<li><p><strong>unreach</strong>: lets you do <em>path MTU discovery</em> (PMTUD)</p>
</li>
</ul><div class="remark-slide-number">95</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="troubleshooting-101-statistics">Troubleshooting 101: Statistics</h2>
<ul>
<li>Statistics can be had with <strong><a href="http://man.openbsd.org/pfctl">pfctl</a> -s info</strong></li>
</ul>
<p>For statistics (bytes/packets passed per rule) attach <em>labels</em> per rule</p>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">log</span> <span class="hljs-keyword">proto</span> { tcp, udp } <span class="hljs-keyword">to</span> <span class="hljs-variable">$emailserver</span> <span class="hljs-keyword">port</span> smtp <span class="hljs-keyword">label</span> <span class="hljs-string">"mail-in"</span></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">log</span> <span class="hljs-keyword">proto</span> { tcp, udp } <span class="hljs-keyword">from</span> <span class="hljs-variable">$emailserver</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> smtp <span class="hljs-keyword">label</span> <span class="hljs-string">"mail-out"</span></div></code></pre>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line">$ doas pfctl -vs rules</div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">from</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">to</span> <span class="hljs-number">192.0</span>.<span class="hljs-number">2.225</span> <span class="hljs-keyword">port</span> = smtp <span class="hljs-keyword">flags</span> S/SA <span class="hljs-keyword">keep</span> <span class="hljs-keyword">state</span> <span class="hljs-keyword">label</span> <span class="hljs-string">"mail-in"</span></div><div class="remark-code-line">[ Evaluations: <span class="hljs-number">1664158</span> Packets: <span class="hljs-number">1601986</span> Bytes: <span class="hljs-number">763762591</span> States: <span class="hljs-number">0</span> ]</div><div class="remark-code-line">[ Inserted: uid <span class="hljs-number">0</span> pid <span class="hljs-number">24490</span> ]</div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">inet</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">from</span> <span class="hljs-number">192.0</span>.<span class="hljs-number">2.225</span> <span class="hljs-keyword">to</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">port</span> = smtp <span class="hljs-keyword">flags</span> S/SA <span class="hljs-keyword">keep</span> <span class="hljs-keyword">state</span> <span class="hljs-keyword">label</span> <span class="hljs-string">"mail-out"</span></div><div class="remark-code-line">[ Evaluations: <span class="hljs-number">2814933</span> Packets: <span class="hljs-number">2711211</span> Bytes: <span class="hljs-number">492510664</span> States: <span class="hljs-number">0</span> ]</div><div class="remark-code-line">[ Inserted: uid <span class="hljs-number">0</span> pid <span class="hljs-number">24490</span> ]</div></code></pre><div class="remark-slide-number">96</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="troubleshooting-101-statistics">Troubleshooting 101: Statistics</h2>
<ul>
<li>If you need to pass the data to a script<ul>
<li>Or a database</li>
<li>A graphing engine</li>
</ul>
</li>
</ul>
<p><br><br><br></p>
<pre><code class="shell hljs lsl remark-code"><div class="remark-code-line">$ doas pfctl -zvsl</div><div class="remark-code-line">mail-in <span class="hljs-number">1664158</span> <span class="hljs-number">1601986</span> <span class="hljs-number">763762591</span> <span class="hljs-number">887895</span> <span class="hljs-number">682427415</span> <span class="hljs-number">714091</span> <span class="hljs-number">81335176</span></div><div class="remark-code-line">mail-out <span class="hljs-number">2814933</span> <span class="hljs-number">2711211</span> <span class="hljs-number">492510664</span> <span class="hljs-number">1407278</span> <span class="hljs-number">239776267</span> <span class="hljs-number">1303933</span> <span class="hljs-number">252734397</span></div></code></pre><div class="remark-slide-number">97</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="troubleshooting-101-log-to-pflog">Troubleshooting 101: log to pflog</h2>
<p>Rules with the <strong>log</strong> keyword log packet data to the <a href="http://man.openbsd.org/pflog">pflog</a> device(s)</p>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line"><span class="hljs-comment"># log blocked packets</span></div><div class="remark-code-line"><span class="hljs-built_in">block</span> <span class="hljs-keyword">log</span>(<span class="hljs-literal">all</span>)</div><div class="remark-code-line"></div><div class="remark-code-line"><span class="hljs-comment"># logs initial packet of matching connections:    </span></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">log</span> <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> ssh</div><div class="remark-code-line"></div><div class="remark-code-line"><span class="hljs-comment"># logs all matching packets:</span></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">log</span>(<span class="hljs-literal">all</span>) <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> ssh <span class="hljs-keyword">log</span>(<span class="hljs-literal">all</span>) </div><div class="remark-code-line"></div><div class="remark-code-line"><span class="hljs-comment"># logs matches on this and all succeeding rules</span></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">log</span>(matches) <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> ssh  </div><div class="remark-code-line"></div><div class="remark-code-line"><span class="hljs-comment"># logs all packets matches on this and all succeeding rules</span></div><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">log</span>(<span class="hljs-literal">all</span>, matches) <span class="hljs-keyword">proto</span> tcp <span class="hljs-keyword">to</span> <span class="hljs-keyword">port</span> ssh</div></code></pre>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line"><span class="hljs-built_in">match</span> <span class="hljs-keyword">log</span>(<span class="hljs-literal">all</span>, matches) <span class="hljs-comment"># log *everything*</span></div></code></pre><div class="remark-slide-number">98</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="troubleshooting-101-tcpdump-read-from-pflog">Troubleshooting 101: tcpdump, read from pflog</h2>
<ul>
<li><p><a href="https://man.openbsd.org/tcpdump">tcpdump</a> is your friend</p>
</li>
<li><p>Let it loose on the pflog device:</p>
</li>
</ul>
<pre><code class="shell hljs python remark-code"><div class="remark-code-line">$ doas tcpdump -n -e -ttt -i pflog0 </div><div class="remark-code-line">tcpdump: WARNING: snaplen raised <span class="hljs-keyword">from</span> <span class="hljs-number">116</span> to <span class="hljs-number">160</span></div><div class="remark-code-line">tcpdump: listening on pflog0, link-type PFLOG</div><div class="remark-code-line">May <span class="hljs-number">29</span> <span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">27.165561</span> rule <span class="hljs-function"><span class="hljs-keyword">def</span>/<span class="hljs-params">(match)</span> <span class="hljs-title">pass</span> <span class="hljs-title">in</span> <span class="hljs-title">on</span> <span class="hljs-title">bge1</span>:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.103</span><span class="hljs-number">.126</span><span class="hljs-number">.15526</span> &gt;</div><div class="remark-code-line"><span class="hljs-number">213.187</span><span class="hljs-number">.179</span><span class="hljs-number">.198</span><span class="hljs-number">.22</span>: . ack <span class="hljs-number">2951513182</span> win <span class="hljs-number">16332</span> (DF) [tos <span class="hljs-number">0x10</span>]</div><div class="remark-code-line">May <span class="hljs-number">29</span> <span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">27.166934</span> rule <span class="hljs-number">16</span>/(match) <span class="hljs-keyword">pass</span> <span class="hljs-keyword">in</span> on bge0: <span class="hljs-number">158.36</span><span class="hljs-number">.191</span><span class="hljs-number">.135</span><span class="hljs-number">.22</span> &gt;</div><div class="remark-code-line"><span class="hljs-number">213.187</span><span class="hljs-number">.179</span><span class="hljs-number">.198</span><span class="hljs-number">.59516</span>: . ack <span class="hljs-number">1734404306</span> win <span class="hljs-number">64800</span> [tos <span class="hljs-number">0x8</span>]</div><div class="remark-code-line">May <span class="hljs-number">29</span> <span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">27.166939</span> rule <span class="hljs-number">2</span>/(match) match <span class="hljs-keyword">in</span> on bge0: <span class="hljs-number">158.36</span><span class="hljs-number">.191</span><span class="hljs-number">.135</span><span class="hljs-number">.22</span> &gt;</div><div class="remark-code-line"><span class="hljs-number">213.187</span><span class="hljs-number">.179</span><span class="hljs-number">.198</span><span class="hljs-number">.59516</span>: . ack <span class="hljs-number">1</span> win <span class="hljs-number">64800</span> [tos <span class="hljs-number">0x8</span>]</div><div class="remark-code-line">May <span class="hljs-number">29</span> <span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">27.168340</span> rule <span class="hljs-function"><span class="hljs-keyword">def</span>/<span class="hljs-params">(match)</span> <span class="hljs-title">pass</span> <span class="hljs-title">out</span> <span class="hljs-title">on</span> <span class="hljs-title">bge1</span>:</span> <span class="hljs-number">213.187</span><span class="hljs-number">.179</span><span class="hljs-number">.198</span><span class="hljs-number">.22</span> &gt;</div><div class="remark-code-line"><span class="hljs-number">192.168</span><span class="hljs-number">.103</span><span class="hljs-number">.126</span><span class="hljs-number">.15526</span>: P <span class="hljs-number">69</span>:<span class="hljs-number">153</span>(<span class="hljs-number">84</span>) ack <span class="hljs-number">0</span> win <span class="hljs-number">17520</span> [tos <span class="hljs-number">0x10</span>]</div><div class="remark-code-line">May <span class="hljs-number">29</span> <span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">27.169150</span> rule <span class="hljs-function"><span class="hljs-keyword">def</span>/<span class="hljs-params">(match)</span> <span class="hljs-title">pass</span> <span class="hljs-title">out</span> <span class="hljs-title">on</span> <span class="hljs-title">bge1</span>:</span> <span class="hljs-number">213.187</span><span class="hljs-number">.179</span><span class="hljs-number">.198</span><span class="hljs-number">.22</span> &gt;</div><div class="remark-code-line"><span class="hljs-number">192.168</span><span class="hljs-number">.103</span><span class="hljs-number">.126</span><span class="hljs-number">.15526</span>: P <span class="hljs-number">153</span>:<span class="hljs-number">333</span>(<span class="hljs-number">180</span>) ack <span class="hljs-number">0</span> win <span class="hljs-number">17520</span> [tos <span class="hljs-number">0x10</span>]</div><div class="remark-code-line">May <span class="hljs-number">29</span> <span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">27.169265</span> rule <span class="hljs-function"><span class="hljs-keyword">def</span>/<span class="hljs-params">(match)</span> <span class="hljs-title">pass</span> <span class="hljs-title">out</span> <span class="hljs-title">on</span> <span class="hljs-title">bge1</span>:</span> <span class="hljs-number">213.187</span><span class="hljs-number">.179</span><span class="hljs-number">.198</span><span class="hljs-number">.22</span> &gt;</div></code></pre>
<ul>
<li><strong>NB</strong> rule number, matches your <em>loaded</em> rule set</li>
</ul><div class="remark-slide-number">99</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="troubleshooting-101-hitting-and-avoiding-limits">Troubleshooting 101: Hitting and avoiding limits</h2>
<ul>
<li><p>On busy systems, you may need to raise limits from default values</p>
</li>
<li><p>Check with:</p>
</li>
</ul>
<pre><code class="shell hljs armasm remark-code"><div class="remark-code-line">$ doas pfctl -s <span class="hljs-meta">info</span></div></code></pre>
<ul>
<li><p>versus the output of <strong>pfctl -s memory</strong> and <strong>pfctl -s timeouts</strong></p>
</li>
<li><p>You may need to bump up from defaults:</p>
</li>
</ul>
<pre><code class="shell hljs bash remark-code"><div class="remark-code-line"><span class="hljs-comment"># increase state limit from 10'000 states on busy systems</span></div><div class="remark-code-line"><span class="hljs-built_in">set</span> <span class="hljs-built_in">limit</span> states 100000</div><div class="remark-code-line"><span class="hljs-comment"># increase no of source nodes </span></div><div class="remark-code-line"><span class="hljs-built_in">set</span> <span class="hljs-built_in">limit</span> src-nodes 100000</div></code></pre><div class="remark-slide-number">100</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="troubleshooting-101-netflow-aka-pflow-ipfix-">Troubleshooting 101: netflow aka pflow (IPFIX)</h2>
<ul>
<li><p>Records TCP/IP <em>flow</em> metadata</p>
<ul>
<li>srcIP</li>
<li>dstIP </li>
<li>(srcPort, dstPort)</li>
<li>startTime</li>
<li>endTime </li>
<li>Packets</li>
<li>Bytes</li>
</ul>
</li>
<li><p>OpenBSD has the <a href="http://man.openbsd.org/plflow">pflow(4)</a> virtual network interface</p>
<ul>
<li>which generates the datagrams from the state table</li>
</ul>
</li>
<li><p>Useful for network monitoring, DDoS protection, etc.</p>
</li>
</ul><div class="remark-slide-number">101</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="troubleshooting-101-netflow-setup">Troubleshooting 101: netflow setup</h2>
<ul>
<li>Set up a <em>sensor</em>:</li>
</ul>
<pre><code class="shell hljs x86asm remark-code"><div class="remark-code-line">$ cat /etc/hostname.pflow0</div><div class="remark-code-line">flowsrc <span class="hljs-number">192.168</span><span class="hljs-meta">.103</span><span class="hljs-meta">.1</span> flowdst <span class="hljs-number">192.168</span><span class="hljs-meta">.103</span><span class="hljs-meta">.252</span>:<span class="hljs-number">9995</span></div><div class="remark-code-line">pflowproto <span class="hljs-number">10</span></div></code></pre>
<ul>
<li>Then configure your <em>collector</em> at the <strong>flowdst</strong> IP address for analysis and network overlordship.</li>
</ul>
<p><br><br><br></p>
<ul>
<li><p>Lots of collector options available in ports: nfsen, flow-tools, others.</p>
</li>
<li><p>More info:</p>
<ul>
<li>Michael W. Lucas:<a href="https://www.nostarch.com/networkflow">Network Flow Analysis</a></li>
<li>and Peter N. M. Hansteen: <a href="http://bsdly.blogspot.ca/2014/02/yes-you-too-can-be-evil-network.html">Yes, You Too Can Be An Evil Network Overlord - On The Cheap With OpenBSD, pflow And nfsen</a>.</li>
</ul>
</li>
</ul><div class="remark-slide-number">102</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="exercise-5">Exercise 5</h1>
<h3 id="nat64">NAT64</h3><div class="remark-slide-number">103</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="nat64">NAT64</h2>
<ul>
<li><p>Single-stack clients will only have IPv6
<br><br></p>
</li>
<li><p>Translator box will strip all headers and replace them with IPv4
<br><br></p>
</li>
<li>Requires some DNS magic<ul>
<li>Capture responses and replace A with AAAA</li>
<li>Response is crafted based on target IPv4 address</li>
</ul>
</li>
</ul>
<p><br><br></p>
<ul>
<li>Usually implies address sharing on IPv4</li>
</ul><div class="remark-slide-number">104</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default" style="background-image: url(&quot;images/nat64.png&quot;);"><div class="remark-slide-number">105</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="464-xlat">464-XLAT</h2>
<ul>
<li><p>Extension to NAT64 to access IPv4-only applications (like Skype or Whatsapp)
<br><br><br></p>
</li>
<li><p>Handset pretends there is an IPv4 address (CLAT) and sends IPv4 packets in UDP over IPv6</p>
</li>
</ul><div class="remark-slide-number">106</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default" style="background-image: url(&quot;images/464-xlat.png&quot;);"><div class="remark-slide-number">107</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-5-goals">Exercise 5 - Goals</h2>
<ul>
<li><p>Define the translating prefix</p>
<ul>
<li>64:ff9b::/96 is reserved by IETF</li>
</ul>
</li>
<li><p>Add NAT64 configuration to PF</p>
</li>
<li><p>Remove IPv4 from the internal network</p>
</li>
<li><p>Configure DNS64 on unbound</p>
</li>
</ul><div class="remark-slide-number">108</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="exercise-5">Exercise 5</h2>
<ul>
<li><em>pf.conf</em></li>
</ul>
<pre><code class="shell hljs pf remark-code"><div class="remark-code-line"><span class="hljs-built_in">pass</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">quick</span> <span class="hljs-keyword">on</span> <span class="hljs-variable">$int_if</span> <span class="hljs-keyword">inet6</span> <span class="hljs-keyword">from</span> <span class="hljs-literal">any</span> <span class="hljs-keyword">to</span> <span class="hljs-number">64</span>:ff9b::/<span class="hljs-number">96</span> \</div><div class="remark-code-line">   af-to <span class="hljs-keyword">inet</span> <span class="hljs-keyword">from</span> (<span class="hljs-literal">egress</span>:<span class="hljs-number">0</span>) <span class="hljs-keyword">keep</span> <span class="hljs-keyword">state</span></div></code></pre>
<ul>
<li><em>unbound.conf</em></li>
</ul>
<pre><code class="shell hljs http remark-code"><div class="remark-code-line"><span class="hljs-attribute">module-config</span>: "dns64 validator iterator"</div><div class="remark-code-line"></div><div class="remark-code-line"><span class="ldif"><span class="hljs-attribute">dns64-prefix</span>: 64:FF9B::/96</span></div></code></pre>
<p>and it's done!</p><div class="remark-slide-number">109</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content center middle hljs-default"><h1 id="questions-">Questions ?</h1>
<h3 id="last-chance-">Last chance...</h3>
<h3 id="or-questions-pftutorial-net">or questions@pftutorial.net</h3><div class="remark-slide-number">110</div></div></div></div><div class="remark-slide-notes"><p>Let's ask if there are any questions before continuing.  Make sure we have everyone onboard.</p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="web-accessible-resources">Web accessible resources</h2>
<p><a href="http://www.openbsd.org/"></a><a href="http://www.openbsd.org/">http://www.openbsd.org/</a>  The official OpenBSD website  to donate: <a href="http://www.openbsd.org/donations.html"></a><a href="http://www.openbsd.org/donations.html">http://www.openbsd.org/donations.html</a> and please do donate, corporates may prefer <a href="https://www.openbsdfoundation.org/"></a><a href="https://www.openbsdfoundation.org/">https://www.openbsdfoundation.org/</a>  - a Canadian non-profit</p>
<p><a href="http://www.openbsd.org/faq/index.html">The PF User Guide on the OpenBSD web site</a></p>
<p><a href="http://man.openbsd.org/">OpenBSD online man pages</a></p>
<p><a href="http://undeadly.org/"></a><a href="http://undeadly.org/">http://undeadly.org/</a>  - The OpenBSD Journal news site</p>
<p><a href="http://bsdly.blogspot.com/"></a><a href="http://bsdly.blogspot.com/">http://bsdly.blogspot.com/</a>  - Peter's rants^H^H^H^H^Hblog posts</p>
<p><a href="http://www.tedunangst.com/flak/"></a><a href="http://www.tedunangst.com/flak/">http://www.tedunangst.com/flak/</a>  tedu@ on developments</p>
<p>Michael W Lucas: <a href="https://www.nostarch.com/openbsd2e">Absolute OpenBSD, 2nd ed.</a></p>
<p>Peter N. M. Hansteen: <a href="https://www.nostarch.com/pf3">The Book of PF, 3rd ed.</a></p><div class="remark-slide-number">111</div></div></div></div><div class="remark-slide-notes"></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default" style="background-image: url(&quot;images/end.png&quot;);"><ul>
<li></li>
</ul><div class="remark-slide-number">112</div></div></div></div><div class="remark-slide-notes"><p>Notes for this slide    </p></div></div><div class="remark-slide-container"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default" style="background-image: url(&quot;images/end2.png&quot;);"><ul>
<li></li>
</ul><div class="remark-slide-number">113</div></div></div></div><div class="remark-slide-notes"><p>Notes for this other slide</p>
<hr></div></div></div>
<div class="remark-preview-area"><div class="remark-slide-container remark-fading"><div class="remark-slide-scaler" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;"><div class="remark-slide"><div class="remark-slide-content hljs-default"><h2 id="whoami-who-am-i-part-peter-">whoami (who am I), part Peter:</h2>
<h3 id="peter-hansteen-peter-bsdly-net-">Peter Hansteen <a href="mailto:peter@bsdly.net">peter@bsdly.net</a></h3>
<ul>
<li><p>Sysadmin, <a href="http://www.openbsd.org/">OpenBSD</a> user since before the millenium </p>
</li>
<li><p>Wrote <a href="https://www.nostarch.com/pf3">The Book of PF</a>, now in its third edition</p>
</li>
<li><p>Blog at <a href="http://bsdly.blogspot.com/">bsdly.blogspot.com</a> about (lack of) sanity in IT</p>
</li>
<li><p>Yes, I'll do another book any decade now</p>
</li>
</ul><div class="remark-slide-number">2</div></div></div></div><div class="remark-slide-notes"></div></div></div>
<div class="remark-backdrop"></div>
<div class="remark-pause" style="transform: scale(1.21145); left: 170px; top: 0px;">
  <div class="remark-pause-lozenge">
    <span>Paused</span>
  </div>
</div>
<div class="remark-help" style="width: 908px; height: 681px; transform: scale(1.21145); left: 170px; top: 0px;">
  <div class="remark-help-content">
    <h1>Help</h1>
    <p><b>Keyboard shortcuts</b></p>
    <table class="light-keys">
      <tbody><tr>
        <td>
          <span class="key"><b></b></span>,
          <span class="key"><b></b></span>,
          <span class="key">Pg Up</span>,
          <span class="key">k</span>
        </td>
        <td>Go to previous slide</td>
      </tr>
      <tr>
        <td>
          <span class="key"><b></b></span>,
          <span class="key"><b></b></span>,
          <span class="key">Pg Dn</span>,
          <span class="key">Space</span>,
          <span class="key">j</span>
        </td>
        <td>Go to next slide</td>
      </tr>
      <tr>
        <td>
          <span class="key">Home</span>
        </td>
        <td>Go to first slide</td>
      </tr>
      <tr>
        <td>
          <span class="key">End</span>
        </td>
        <td>Go to last slide</td>
      </tr>
      <tr>
        <td>
          Number + <span class="key">Return</span>
        </td>
        <td>Go to specific slide</td>
      </tr>
      <tr>
        <td>
          <span class="key">b</span>&nbsp;/
          <span class="key">m</span>&nbsp;/
          <span class="key">f</span>
        </td>
        <td>Toggle blackout / mirrored / fullscreen mode</td>
      </tr>
      <tr>
        <td>
          <span class="key">c</span>
        </td>
        <td>Clone slideshow</td>
      </tr>
      <tr>
        <td>
          <span class="key">p</span>
        </td>
        <td>Toggle presenter mode</td>
      </tr>
      <tr>
        <td>
          <span class="key">t</span>
        </td>
        <td>Restart the presentation timer</td>
      </tr>
      <tr>
        <td>
          <span class="key">?</span>,
          <span class="key">h</span>
        </td>
        <td>Toggle this help</td>
      </tr>
    </tbody></table>
  </div>
  <div class="content dismiss">
    <table class="light-keys">
      <tbody><tr>
        <td>
          <span class="key">Esc</span>
        </td>
        <td>Back to slideshow</td>
      </tr>
    </tbody></table>
  </div>
</div>

  

</body></html>
